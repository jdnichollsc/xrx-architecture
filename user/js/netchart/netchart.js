// DVSL Network Chart library. Version 1.3.3
// (c) 2013 - 2014 Data Visualization Software Lab
//
// http://datavisualizationsoftwarelab.com http://dvsl.co

(function(){var w={Bar:{}};var p={};var g;g=(function(){ac.prototype.scene=null;ac.prototype.events=null;ac.prototype.currentObject=null;function ac(ad){this.chart=ad;this.scene=ad.scene;this.events=ad.events;this.navigator=ad.navigator;this.dragPointers={}}ac.prototype.onPointerMove=function(ad){var ae;if(!this.scene.xyInChart(ad.x,ad.y)){return}ae=this.scene.findLinkOrNodeAt(ad.x,ad.y,this.scene.settings.interaction.selection.tolerance);return this.switchCurrentObject(ae,ad)};ac.prototype.onPointerOut=function(ad){return this.switchCurrentObject(null,ad)};ac.prototype.onPointerDown=function(ad){var ae;if(!this.scene.xyInChart(ad.x,ad.y)){return}ae=this.scene.findLinkOrNodeAt(ad.x,ad.y,this.scene.settings.interaction.selection.tolerance);this.switchCurrentObject(ae,ad);if(ae instanceof Q){this.updateSelection(ad,ae,true);this.setPointerNode(ad,ae);return ad.consumed=true}};ac.prototype.onPointerUp=function(ad){if(this.dragPointers[ad.identifier]){this.setPointerNode(ad,null);return ad.consumed=true}};ac.prototype.onPointerCancel=function(ad){return this.onPointerUp(ad)};ac.prototype.onPointerDrag=function(ad){var ah,ag,af,ae;af=this.dragPointers[ad.identifier];if(!af){return}ae=this.scene.fromDisplay(ad.x,ad.y),ah=ae[0],ag=ae[1];af.mouseX=ad.x;af.mouseY=ad.y;this.dragNodes(af,ah,ag,this.scene.settings.interaction.selection.lockNodesOnMove);return ad.consumed=true};ac.prototype.onClick=function(ad){var ae,af;if(!this.scene.xyInChart(ad.x,ad.y)){return}af=this.scene.findLinkOrNodeAt(ad.x,ad.y,this.scene.settings.interaction.selection.tolerance);this.updateSelection(ad,af,false);if(af instanceof Q){ad.clickNode=af}else{ad.clickLink=af}ae=this.chart.notifyClick(ad);if(ae.defaultPrevented){return ad.consumed=true}};ac.prototype.onRightClick=function(ad){var ae,af;if(!this.scene.xyInChart(ad.x,ad.y)){return}af=this.scene.findLinkOrNodeAt(ad.x,ad.y,this.scene.settings.interaction.selection.tolerance);this.updateSelection(ad,af,false);if(af instanceof Q){ad.clickNode=af}else{ad.clickLink=af}ae=this.chart.notifyRightClick(ad);if(ae.defaultPrevented){return ad.consumed=true}};ac.prototype.onDoubleClick=function(ad){var ae,af;af=this.scene.findLinkOrNodeAt(ad.x,ad.y,this.scene.settings.interaction.selection.tolerance);if(af instanceof Q){ad.clickNode=af}else{ad.clickLink=af}ae=this.chart.notifyDoubleClick(ad);if(ae.defaultPrevented){return ad.consumed=true}};ac.prototype.doAnimations=function(af){var ak,aj,ai,ah,ag,ad,ae;ag=this.dragPointers;ae=[];for(ak in ag){ah=ag[ak];ad=this.scene.fromDisplay(ah.mouseX,ah.mouseY),aj=ad[0],ai=ad[1];this.dragNodes(ah,aj,ai,false);ae.push(af.changes.coordinates=true)}return ae};ac.prototype.updateSelection=function(ad,af,ae){if(!this.scene.settings.interaction.selection.enabled){return}if(!ad.shiftKey&&(!af||(!this.scene.settings.interaction.selection.nodesSelectable&&af.isNode)||(!this.scene.settings.interaction.selection.linksSelectable&&af.isLink))){return this.chart.setSelection([])}else{if(af&&ad.shiftKey||(ae&&T.arrayContains(this.scene.selection,af))){if(!T.arrayContains(this.scene.selection,af)){this.scene.selection.push(af);return this.chart.setSelection(this.scene.selection,true)}}else{if(af){return this.chart.setSelection([af])}}}};ac.prototype.dragNodes=function(ae,ad,al,aj){var am,ak,af,ag,ai,ah;am=ad+ae.x-ae.node.x;ak=al+ae.y-ae.node.y;if(T.countProperties(this.dragPointers)===1&&this.scene.selection.length>0){ah=this.scene.selection;for(ag=0,ai=ah.length;ag<ai;ag++){af=ah[ag];if(af.isNode){af.x+=am;af.y+=ak;if(aj){af.userLock=true}}}}else{ae.node.x+=am;ae.node.y+=ak;if(aj){ae.node.userLock=true}}return this.events.notifySceneChanges({coordinates:true})};ac.prototype.setPointerNode=function(ag,af){var aj,ae,ad,ai,ah;aj=ag.identifier;ae=this.dragPointers[aj];if(ae){ae.node.locks-=1;delete this.dragPointers[aj]}if(af){ah=this.scene.fromDisplay(ag.x,ag.y),ad=ah[0],ai=ah[1];this.dragPointers[ag.identifier]={x:af.x-ad,y:af.y-ai,node:af,mouseX:ag.x,mouseY:ag.y};return af.locks+=1}};ac.prototype.switchCurrentObject=function(ae,ad){if(ae===this.currentSlice){return}ad.changes.current=true;this.scene.setActiveObject(ae);if(this.currentSlice instanceof Q){this.currentSlice.locks-=1}this.currentSlice=ae;if(this.currentSlice instanceof Q){this.currentSlice.locks+=1}if(this.currentSlice){if(this.currentSlice.isNode){ad.hoverNode=this.currentSlice}if(this.currentSlice.isLink){ad.hoverLink=this.currentSlice}}return this.chart.notifyHoverChanged(ad)};return ac})();var l,j=function(ac,ad){return function(){return ac.apply(ad,arguments)}};l=(function(){ac.prototype.settings=null;ac.prototype.removed=false;ac.prototype.nodes={};ac.prototype.links={};ac.prototype.nodeToLinks={};ac.prototype.pendingNodes={};ac.prototype.requestedNodes={};ac.prototype.requests=[];ac.prototype.requestScheduled=false;ac.prototype.cleanupScheduled=false;ac.prototype.dataFunc=null;function ac(ad){var ae;this.chart=ad;this.runRequests=j(this.runRequests,this);this.settings=ad.settings;this.nodes={};this.links={};this.nodeToLinks={};this.pendingNodes={};this.requestedNodes={};this.dataFunc=this.getDataFunction();if(this.settings.data.randomNodes>0){ae=this.genRandomGraph(this.settings.data);this.updateGraph(ae)}else{if(this.settings.data.preloaded){this.dataArrived(null,this.settings.data.preloaded)}}}ac.otherEnd=function(ad,ae){if(ae===ad.from){return ad.to}if(ae===ad.to){return ad.from}return null};ac.multiLinkId=function(ad){if(ad.from<ad.to){return ad.from+"#"+ad.to}else{return ad.to+"#"+ad.from}};ac.prototype.remove=function(){return this.removed=true};ac.prototype.getQueueLength=function(){return T.countProperties(this.pendingNodes)+T.countProperties(this.requestedNodes)};ac.prototype.getNodeData=function(ad){if(this.nodes.hasOwnProperty(ad)){return this.nodes[ad]}else{if(this.dataFunc!=null){this.requestNodeData(ad)}}return null};ac.prototype.nodeRemoved=function(ad){delete this.pendingNodes[ad];return delete this.requestedNodes[ad]};ac.prototype.getLinkData=function(ad){return this.links[ad]};ac.prototype.getNodeLinks=function(ad){if(this.nodes.hasOwnProperty(ad)&&this.nodes[ad].loaded){return this.applyLinkFilter(ad)}else{if(this.dataFunc!=null){this.requestNodeData(ad)}}return null};ac.prototype.getNodeCollectedLinks=function(ad){return this.applyLinkFilter(ad)};ac.prototype.isLoaded=function(ad){return this.nodes.hasOwnProperty(ad)&&this.nodes[ad].loaded};ac.prototype.isFilteredNode=function(af){var ae,ad;ad=this.settings.filters.nodeFilter;ae=this.nodes[af];if(!ad||!ae){return false}return !ad(ae,this.isLoaded(af)?this.nodeToLinks[af]:null)};ac.prototype.getNodes=function(){var ah,af,ae,ad,ag;ae=this.settings.filters.nodeFilter;if(!ae){return this.nodes}ad={};ag=this.nodes;for(ah in ag){af=ag[ah];if(ae(af,this.isLoaded(ah)?this.nodeToLinks[ah]:null)){ad[ah]=af}}return ad};ac.prototype.applyLinkFilter=function(au){var aF,aE,ar,ax,ay,aq,aj,ai,aw,ao,az,at,ad,al,ap,an,am,av,ak,ah,ag,af,ae,aB,aD,aC,aA;ad=this.nodes[au];ai=this.nodeToLinks[au];if(!(ai&&ai.length>0)){return[]}aj=this.settings.filters.linkFilter;al=this.settings.filters.nodeFilter;ap=this.settings.filters.nodeLinksProcessor;az=this.settings.filters.multilinkProcessor;if(al&&!al(ad,ad.loaded?ai:null)){return[]}if(al||aj){ar=[];for(ah=0,aB=ai.length;ah<aB;ah++){aq=ai[ah];am=ac.otherEnd(aq,au);an=this.nodes[am];if(aj){if(aq.from===au){aF=ad;aE=an}else{aF=an;aE=ad}if(!aj(aq,aF,aE)){continue}}if(al&&!al(an,an.loaded?this.nodeToLinks[am]:null)){continue}ar.push(aq)}ai=ar}if(ap){ai=ap(ad,ai)}if(az){av={};for(ag=0,aD=ai.length;ag<aD;ag++){aq=ai[ag];av[ac.otherEnd(aq,au)]=true}if(T.countProperties(av)<ai.length){ar=[];ao={};at={};for(af=0,aC=ai.length;af<aC;af++){ay=ai[af];aw=ac.multiLinkId(ay);if(ao.hasOwnProperty(aw)){if(!at.hasOwnProperty(aw)){at[aw]=[ao[aw],ay]}else{at[aw].push(ay)}}else{ao[aw]=ay}}for(ae=0,aA=ai.length;ae<aA;ae++){ay=ai[ae];aw=ac.multiLinkId(ay);if(!at.hasOwnProperty(aw)){ar.push(ay)}}for(ax in at){ai=at[ax];ay=ai[0];ak=az(ai,this.nodes[ay.from],this.nodes[ay.to]);if(T.isArray(ak)){ar.concat(ak)}else{if(ak){ar.push(ak)}}}ai=ar}}return ai};ac.prototype.getAllNodes=function(ai){var ah,ag,ad,ae,af=this;if(!this.dataFunc){ad=(function(){var ak,aj;ak=this.nodes;aj=[];for(ah in ak){ag=ak[ah];aj.push(ah)}return aj}).call(this);return ai(ad)}else{ae=function(aj){af.dataArrived(null,aj);ad=(function(){var al,ak;al=this.nodes;ak=[];for(ah in al){ag=al[ah];ak.push(ah)}return ak}).call(af);return ai(ad)};return this.dataFunc(null,ae,this.dataError)}};ac.prototype.requestNodeData=function(ad){if(this.pendingNodes.hasOwnProperty(ad)||this.requestedNodes.hasOwnProperty(ad)){return}this.pendingNodes[ad]=true;if((this.dataFunc!=null)&&!this.requestScheduled){this.requestScheduled=true;return setTimeout(this.runRequests,0)}};ac.prototype.runRequests=function(){var af,ad,am,ag,an,aj,ai,ao,ae,ak,ah,al=this;if(this.removed){return}this.requestScheduled=false;ag=new Date().getTime();an=this.settings.data.requestTimeout;if(this.cleanupScheduled){this.cleanupScheduled=false;am=[];ak=this.requests;for(aj=0,ao=ak.length;aj<ao;aj++){ad=ak[aj];if(ad.time+an>ag){am.push(ad)}else{ah=ad.nodes;for(ai=0,ae=ah.length;ai<ae;ai++){af=ah[ai];if(this.requestedNodes[af]){delete this.requestedNodes[af];this.pendingNodes[af]=true}}if(ad.time!==0){this.chart.error("Data request timed out, timeout "+an+" ms")}}}this.requests=am}while(T.hasProperties(this.pendingNodes)&&this.requests.length<this.settings.data.numberOfParralelRequests){(function(){var ar,ap,au,at,aq,av;ap=[];av=al.pendingNodes;for(af in av){aq=av[af];ap.push(af);delete al.pendingNodes[af];al.requestedNodes[af]=true;if(ap.length>al.settings.data.requestMaxUnits){break}}al.chart.log("Requesting data on "+ap);at={time:ag,nodes:ap};au=function(aw){return al.dataArrived(at,aw)};ar=function(){return al.dataError(at)};al.dataFunc(ap,au,ar);return al.requests.push(at)})()}if(this.requests.length>0&&!this.cleanupScheduled){this.cleanupScheduled=true;return setTimeout(this.runRequests,an)}};ac.prototype.dataError=function(ad){if(this.removed){return}this.chart.error("Data request failed for nodes: "+ad.nodes);ad.time=0;this.cleanupScheduled=true;return this.runRequests()};ac.prototype.dataArrived=function(ae,aB){var ax,aQ,az,aC,aD,aR,av,aA,aK,aE,ad,au,ay,aG,aP,aO,aN,aM,aw,al,ak,aj,ai,ah,ag,af,aL,aJ,aI,aH,aF,at,ar,aq,ap,ao,an,am;if(this.removed){return}ax=false;if(aB){aQ=T.parseData(aB,this.settings.data.format,this.chart);if(aQ.error!=null){this.chart.error(aQ.error)}ax=true;aF=["links","nodes"];for(aP=0,aw=aF.length;aP<aw;aP++){au=aF[aP];if(!aQ.hasOwnProperty(au)){ax=false;this.chart.error("Field "+au+" not set in data")}}if(ax){if(!T.isArray(aQ.nodes)){ad=aQ.nodes;aQ.nodes=[];for(av in ad){aG=ad[av];aG.id=av;aQ.nodes.push(aG)}}if(!T.isArray(aQ.links)){ad=aQ.links;aQ.links=[];for(av in ad){aG=ad[av];aG.id=av;aQ.links.push(aG)}}if(ae){this.chart.log("Got "+aQ.nodes.length+" data on  "+ae.nodes)}else{this.chart.log("Got "+aQ.nodes.length+" data on all nodes")}aC=!(ae&&aQ.nodes.length>0);az=!(ae&&aQ.nodes.length>0);aR={};at=aQ.nodes;for(aO=0,al=at.length;aO<al;aO++){aK=at[aO];if(aR.hasOwnProperty(aK.id)){this.chart.error("Data response: Multiple nodes with the same ID: "+aK.id)}aR[aK.id]=true;if(ae&&T.arrayContains(ae.nodes,aK.id)){aC=true;az||(az=aK.loaded)}aR={}}ar=aQ.links;for(aN=0,ak=ar.length;aN<ak;aN++){aK=ar[aN];if(aR.hasOwnProperty(aK.id)){this.chart.error("Data response: Multiple links with the same ID: "+aK.id)}aR[aK.id]=true}if(!aC){this.chart.error("Data response: Results set did not contain requested nodes")}else{if(!az){this.chart.error("Data response: loaded field was not set on any of the requested nodes, adding manually");aq=aQ.nodes;for(aM=0,aj=aq.length;aM<aj;aM++){aK=aq[aM];if(T.arrayContains(ae.nodes,aK.id)){aK.loaded=true}}}}}}else{this.chart.error("Got empty response")}aA={};if(!ax){aE=[];ap=ae.nodes;for(aL=0,ai=ap.length;aL<ai;aL++){aD=ap[aL];aE.push({id:aD,error:"Bad response",loaded:true})}aQ={nodes:aE,links:[]}}this.updateGraph(aQ);ao=aQ.nodes;for(aJ=0,ah=ao.length;aJ<ah;aJ++){aK=ao[aJ];if(aK.loaded){aA[aK.id]=true;delete this.pendingNodes[aK.id]}if(aK.error){delete this.pendingNodes[aK.id];aA[aK.id]=true}}ay={};an=aQ.nodes;for(aI=0,ag=an.length;aI<ag;aI++){aK=an[aI];ay[aK.id]=true}this.chart.events.notifySceneChanges({dataArrived:true,dataLoadedNodesIds:aA,dataNodesIds:ay});if(ae){T.removeFromArray(this.requests,ae);am=ae.nodes;for(aH=0,af=am.length;aH<af;aH++){aK=am[aH];delete this.requestedNodes[aK]}return this.runRequests()}};ac.prototype.updateGraph=function(aj){var ae,am,ai,ah,al,ad,ak,ag,af;ak=aj.nodes;for(ai=0,al=ak.length;ai<al;ai++){ae=ak[ai];if(this.nodes.hasOwnProperty(ae.id)){if(!ae.error&&ae.loaded){delete this.nodes[ae.id]["_noData"];T.extend(this.nodes[ae.id],ae)}}else{this.nodes[ae.id]=ae;this.nodeToLinks[ae.id]=[]}}ag=aj.links;af=[];for(ah=0,ad=ag.length;ah<ad;ah++){ae=ag[ah];if(this.links.hasOwnProperty(ae.id)){am=this.links[ae.id];if(am.from!==ae.from||am.to!==ae.to){af.push(this.chart.error("Changing link from,to not supported"))}else{af.push(T.extend(this.links[ae.id],ae))}}else{if(!this.nodes.hasOwnProperty(ae.from)){this.nodes[ae.from]={id:ae.from,_noData:true};this.nodeToLinks[ae.from]=[]}if(!this.nodes.hasOwnProperty(ae.to)){this.nodes[ae.to]={id:ae.to,_noData:true};this.nodeToLinks[ae.to]=[]}this.links[ae.id]=ae;this.nodeToLinks[ae.from].push(ae);af.push(this.nodeToLinks[ae.to].push(ae))}}return af};ac.prototype.genRandomGraph=function(ag){var al,am,af,ao,ae,aj,ai,an,ad,ak,ah;ae=ag.randomNodes;ao=ag.randomLinks;if(ag.random==="grid"){al=this.genRandomGrid(ae,ag.randomGridLinkProbability)}else{al=this.genRandomUniform(ae,ao)}ak=al.nodes;for(aj=0,an=ak.length;aj<an;aj++){af=ak[aj];af.name="Node "+af.id;af.value=10+Math.random()*40}ah=al.links;for(ai=0,ad=ah.length;ai<ad;ai++){am=ah[ai];am.name="Link "+am.id;am.value=1+Math.random()*5}return al};ac.prototype.genRandomGrid=function(aq,ap){var ao,av,ak,au,ag,ar,at,an,al,ah,af,ae,ad,aw,am,aj,ai;at=[];ag=[];for(av=ah=0,am=aq-1;0<=am?ah<=am:ah>=am;av=0<=am?++ah:--ah){ar={id:"n"+av,loaded:true};at.push(ar)}ao=Math.ceil(Math.sqrt(aq));for(al=af=0,aj=ao-1;af<=aj;al=af+=1){for(an=ae=0,ai=ao-1;ae<=ai;an=ae+=1){ak=an+al*ao;if(ak>=aq){continue}if(an>0&&Math.random()<=ap){ag.push({from:"n"+ak,to:"n"+(ak-1)})}if(al>0&&Math.random()<=ap){ag.push({from:"n"+ak,to:"n"+(ak-ao)})}}}for(ak=ad=0,aw=ag.length;ad<aw;ak=++ad){au=ag[ak];au.id=""+ak}return{nodes:at,links:ag}};ac.prototype.genRandomUniform=function(ae,ao){var am,ah,an,af,ad,ak,aj,al,ai,ag;ad=[];an=[];for(am=ak=0,al=ae-1;0<=al?ak<=al:ak>=al;am=0<=al?++ak:--ak){af={id:"n"+am,loaded:true};if(ad.length>0){ah={id:"l"+am,from:af.id,to:ad[Math.random()*ad.length|0].id};an.push(ah)}ad.push(af)}for(am=aj=ai=an.length,ag=ao-1;aj<=ag;am=aj+=1){ah={id:"l"+(am+1),from:ad[Math.random()*ad.length|0].id,to:ad[Math.random()*ad.length|0].id};an.push(ah)}return{nodes:ad,links:an}};ac.prototype.getDataFunction=function(){var ad;ad=this.settings.data;if(ad.dataFunction){return ad.dataFunction}else{if(ad.url){return function(af,ah,ae){var ag;ag=[];if(af!=null){ag.push(["nodes",af.toString()])}return T.doRequest(ad.url,ag,ah,ae)}}else{return null}}};ac.prototype.isFilteredLink=function(af){var ad,ae;ae=this.settings.filters.linkFilter;ad=this.links[af];if(!ae||!ad){return false}return !ae(ad,this.nodes[ad.from],this.nodes[ad.to])};ac.prototype.dumpData=function(af){var ad,aj,ap,am,ae,ag,ai,ao,aq,ah,an,ar,al,ak;an={};am={};ao=0;ai=0;aq={};ae=[];aj=[];al=this.nodes;for(ad in al){ah=al[ad];if(!this.isFilteredNode(ad)){ae.push(ah);if(af){ag=""+ao;ao+=1;an[ag]=ad;ah.id=ag}aq[ad]=true}}ak=this.links;for(ad in ak){ap=ak[ad];if(!this.isFilteredLink(ad)&&aq[ap.from]&&aq[ap.to]){aj.push(ap);if(af){ag=""+ai;ai+=1;am[ag]=ad;ap.id=ag;ap.from=this.nodes[ap.from].id;ap.to=this.nodes[ap.to].id}}}ar=JSON.stringify({nodes:ae,links:aj},["nodes","links","id","from","to","type","state","loaded","Employees","position_title","start","end","shares_perc","terminated","status","finanses","Turnover_prev","Employees_prev"],"  ");for(ag in an){ad=an[ag];this.nodes[ad].id=ad}for(ag in am){ad=am[ag];aj=this.links[ad];aj.id=ad;aj.from=an[aj.from];aj.to=an[aj.to]}return ar};return ac})();var e;e=(function(){function ac(ad){this.chart=ad;this.settings=this.chart.settings;this.scene=this.chart.scene;this.idToNode={};this.idToLink={};this.linksQueue={};this.nodeQueue={};this.state={}}ac.prototype.save=function(){var ag,ad,af,ae;af={};ae=this.idToNode;for(ag in ae){ad=ae[ag];af[ad.id]={x:ad.x,y:ad.y,r:ad.currentRadius}}return af};ac.prototype.restore=function(af){var ah,ag,ae,ad;this.state={};ad=[];for(ah in af){ae=af[ah];if(this.idToNode.hasOwnProperty(ah)){ag=this.idToNode[ah];ag.x=ae.x;ag.y=ae.y;ad.push(ag.currentRadius=ae.r)}else{ad.push(this.state[ah]=ae)}}return ad};ac.prototype.removeAll=function(){var aj,af,ah,ag,ai,ad,ae;ai=this.idToLink;for(aj in ai){ah=ai[aj];this.removeLink(aj)}ad=this.idToNode;ae=[];for(af in ad){ag=ad[af];ae.push(this.removeNode(af))}return ae};ac.prototype.lockNode=function(ae,ad,ag){var af;if(!this.idToNode.hasOwnProperty(ae)){return this.chart.error("Locking nonexistant node: "+ae)}else{af=this.idToNode[ae];af.userLock=true;if(ad!==void 0&&ag!==void 0){af.x=ad;af.y=ag}return this.scene.touchNode(af)}};ac.prototype.unlockNode=function(ad){var ae;if(!this.idToNode.hasOwnProperty(ad)){return this.chart.error("Locking nonexistant node: "+ad)}else{ae=this.idToNode[ad];ae.userLock=false;return this.scene.touchNode(ae)}};ac.prototype.addNode=function(af){var ae,ag,ad;if(this.idToNode.hasOwnProperty(af)){return this.idToNode[af]}ag=this.scene.addNode(af);ag.dataLinks=[];this.idToNode[af]=ag;if(this.state.hasOwnProperty(af)){ad=this.state[af];delete this.state[af];ag.x=ad.x;ag.y=ad.y;ag.currentRadius=ad.r}ae=this.scene.data.getNodeData(af);if(ae!=null){this.addNodeImpl(af,ae)}else{this.nodeQueue[af]=true;ag.loading=true;this.toggleLoading()}return ag};ac.prototype.addNodeWithLinks=function(ad){var ae;ae=this.addNode(ad);if(!ae.data||!ae.data.loaded){this.scene.data.getNodeLinks(ad);this.linksQueue[ad]=true;ae.loading=true;this.toggleLoading()}return ae};ac.prototype.addNodeImpl=function(ag,af){var ae,ad,ah;ae=this.linksQueue.hasOwnProperty(ag);ah=this.idToNode[ag];ah.data=af;ah.loading=false;this.scene.touchNode(ah);if(this.scene.settings.data.preloadNodeLinks||ae){ad=this.scene.data.getNodeLinks(ag)}else{ad=this.scene.data.getNodeCollectedLinks(ag)}if(ad!=null){delete this.linksQueue[ag];this.updateNodeLinks(ah,ad)}else{ah.loading=true;this.linksQueue[ag]=true;this.updateNodeLinks(ah,this.scene.data.getNodeCollectedLinks(ag));this.toggleLoading()}return ah};ac.prototype.expandNode=function(ad){var ae;ae=this.addNodeWithLinks(ad);if(!ae.expanded){ae.expanded=true;this.expandImpl(ae);return this.scene.touchNode(ae)}};ac.prototype.expandImpl=function(ah){var ag,af,aj,ae,ai,ad;if(!ah.dataLinks){return}ai=ah.dataLinks;ad=[];for(aj=0,ae=ai.length;aj<ae;aj++){ag=ai[aj];af=l.otherEnd(ag,ah.id);ad.push(this.addNode(af))}return ad};ac.prototype.collapseNode=function(af){var aj,an,ao,aq,ae,am,al,ai,ah,ap,ad,ak,ag;ae=this.idToNode[af];if(!ae){return}ae.expanded=false;this.scene.touchNode(ae);aq=ae.links.slice(0);ag=[];for(ai=0,ap=aq.length;ai<ap;ai++){an=aq[ai];am=an.otherEnd(ae);if(am===ae){continue}aj=true;ak=am.links;for(ah=0,ad=ak.length;ah<ad;ah++){ao=ak[ah];al=ao.otherEnd(am);if(al!==am&&al!==ae){aj=false;break}}if(aj){ag.push(this.removeNode(am.id))}else{ag.push(void 0)}}return ag};ac.prototype.updateNodeLinks=function(ae,al){var ai,aj,ah,ad,ag,ak,af;ae.dataLinks=al;ad={};for(ag=0,ak=al.length;ag<ak;ag++){aj=al[ag];ai=this.tryAddLink(aj);if(ai){ad[aj.id]=true}}ah=0;af=[];while(ah<ae.links.length){ai=ae.links[ah];if(!ad.hasOwnProperty(ai.id)&&this.idToLink.hasOwnProperty(ai.id)){af.push(this.removeLink(ai.id))}else{af.push(ah++)}}return af};ac.prototype.tryAddLink=function(ad){var ae;if(this.idToLink.hasOwnProperty(ad.id)){return this.idToLink[ad.id]}if(this.idToNode.hasOwnProperty(ad.from)&&this.idToNode.hasOwnProperty(ad.to)){ae=this.scene.addLink(ad.id,ad.from,ad.to);ae.data=ad;this.idToLink[ad.id]=ae;ae.from=this.idToNode[ad.from];ae.from.links.push(ae);this.scene.touchNode(ae.from);ae.to=this.idToNode[ad.to];ae.to.links.push(ae);this.scene.touchNode(ae.to);return ae}else{return null}};ac.prototype.removeNode=function(aj){var ag,af,ad,ai,ae,ah;if(!this.idToNode.hasOwnProperty(aj)){return}af=this.idToNode[aj];ah=af.links;for(ai=0,ae=ah.length;ai<ae;ai++){ag=ah[ai];delete this.idToLink[ag.id];ad=ag.otherEnd(af);if(ad!==af){T.removeFromArray(ad.links,ag);this.scene.touchNode(ad)}this.scene.removeLink(ag)}af.links=[];delete this.idToNode[aj];delete this.nodeQueue[aj];delete this.linksQueue[aj];this.scene.removeNode(af);this.scene.data.nodeRemoved(aj);return this.toggleLoading()};ac.prototype.removeLink=function(ae){var ad;if(this.idToLink.hasOwnProperty(ae)){ad=this.idToLink[ae];delete this.idToLink[ae];T.removeFromArray(ad.from.links,ad);T.removeFromArray(ad.to.links,ad);this.scene.touchNode(ad.from);this.scene.touchNode(ad.to);return this.scene.removeLink(ad)}};ac.prototype.onSceneChange=function(ad){var ak,am,af,ap,ag,ao,aj,ai,an,ae,al,ah;if(!ad.changes.dataArrived){return}am=false;ak=[];al=ad.changes.dataNodesIds;for(af in al){ao=al[af];ak.push(af)}ak.sort();for(aj=0,an=ak.length;aj<an;aj++){af=ak[aj];if(this.nodeQueue.hasOwnProperty(af)){delete this.nodeQueue[af];this.addNodeImpl(af,this.scene.data.getNodeData(af));am=true}else{if(this.idToNode.hasOwnProperty(af)){this.scene.touchNode(this.idToNode[af])}}}ak=[];ah=ad.changes.dataLoadedNodesIds;for(af in ah){ao=ah[af];ak.push(af)}ak.sort();for(ai=0,ae=ak.length;ai<ae;ai++){af=ak[ai];delete this.linksQueue[af];if(this.idToNode.hasOwnProperty(af)){ap=this.scene.data.getNodeLinks(af);if(ap===null){this.chart.error("Internal error - no links for exapnded node");continue}ag=this.idToNode[af];ag.loading=false;this.updateNodeLinks(ag,ap);if(ag.expanded){this.expandImpl(ag)}am=true}}return this.toggleLoading()};ac.prototype.updateFilter=function(){var am,ae,ad,ao,aq,af,aj,an,ak,ap,al,ai,ag,ah;aj=this.settings.filters.nodeFilter;ae={};am=this.scene.data;al=this.idToNode;for(ad in al){af=al[ad];an=am.nodeToLinks[ad];if(aj&&af.data&&!aj(af.data,an)){this.removeNode(af.id)}else{af.dataLinks=am.getNodeCollectedLinks(ad);ai=af.dataLinks;for(ak=0,ap=ai.length;ak<ap;ak++){aq=ai[ak];ae[aq.id]=true;this.tryAddLink(aq)}}}ag=this.idToLink;ah=[];for(ad in ag){ao=ag[ad];if(!ae.hasOwnProperty(ad)){ah.push(this.removeLink(ad))}else{ah.push(void 0)}}return ah};ac.prototype.toggleLoading=function(){if(T.hasProperties(this.nodeQueue)||T.hasProperties(this.linksQueue)){if(!this.scene.loading){return this.scene.loading=true}}else{if(this.scene.loading){return this.scene.loading=false}}};return ac})();var B;B=(function(){ac.prototype.FocusNode=(function(){function ad(){}ad.prototype.id=null;ad.prototype.relevance=-1;ad.prototype.initial=false;ad.prototype.stopped=false;ad.prototype.hidden=false;ad.prototype.expanded=false;ad.prototype.collapsed=false;ad.prototype.actionId=0;return ad})();ac.prototype.lastExpandTime=0;ac.prototype.nextId=0;ac.prototype.animationPriority=1005;ac.prototype.otherEnd=l.otherEnd;function ac(ad){this.chart=ad;this.graph=this.chart.graph;this.scene=this.chart.scene;this.nodes={}}ac.prototype.clear=function(){this.chart.events.notifySceneChanges({navigation:true});return this.nodes={}};ac.prototype.addAction=function(af,ae){var ad;this.chart.events.notifySceneChanges({navigation:true});ad=new this.FocusNode();ad.id=af;ad.actionId=this.nextId;this.nextId+=1;T.extend(ad,ae);this.nodes[af]=ad;return ad};ac.prototype.updateAction=function(af,ae){var ad;this.chart.events.notifySceneChanges({navigation:true});ad=this.nodes[af];ad.actionId=this.nextId;this.nextId+=1;T.extend(ad,ae);return ad};ac.prototype.hideNode=function(ad){return this.addAction(ad,{hidden:true})};ac.prototype.collapseNode=function(ad){return this.addAction(ad,{collapsed:true})};ac.prototype.addFocusNode=function(ad,ae){if(ae==null){ae=-1}return this.addAction(ad,{relevance:ae,initial:true})};ac.prototype.expandNode=function(ad){if(this.nodes[ad]&&this.nodes[ad].initial){return this.updateAction(ad,{expanded:true})}else{return this.addAction(ad,{expanded:true})}};ac.prototype.unexpandNode=function(ad){if(this.nodes[ad]){return this.updateAction(ad,{initial:false})}};ac.prototype.save=function(){return this.nodes};ac.prototype.restore=function(af){var ad,ag,ae;this.nodes=af;this.nextId=0;ae=this.nodes;for(ag in ae){ad=ae[ag];this.nextId=Math.max(ad.actionId,this.nextId)}this.nextId++;return this.chart.events.notifySceneChanges({navigation:true})};ac.prototype.showInitialNodes=function(){var al,ad,af,ak,aj,ao,ae,am,ai,ah,ag,an=this;this.clear();this.graph.removeAll();af=this.scene.settings.navigation;if(af.mode==="focusnodes"){if(af.initialNodes&&af.initialNodes.length){am=af.initialNodes;ah=[];for(ak=0,ao=am.length;ak<ao;ak++){ad=am[ak];this.scene.userNodeIds[ad]=true;ah.push(this.addFocusNode(ad,-1))}return ah}}else{if(af.mode==="manual"){if(af.initialNodes&&af.initialNodes.length){ai=af.initialNodes;ag=[];for(aj=0,ae=ai.length;aj<ae;aj++){ad=ai[aj];this.scene.userNodeIds[ad]=true;ag.push(this.addFocusNode(ad,1))}return ag}}else{if(af.mode==="showall"||true){al=function(aq){var at,ap,ar;ar=[];for(at=0,ap=aq.length;at<ap;at++){ad=aq[at];ar.push(an.graph.expandNode(ad))}return ar};return this.scene.data.getAllNodes(al)}}}};ac.prototype.doAnimations=function(ad){if(!(ad.changes.navigation||ad.changes.dataArrived||this.scene.hasTopologyChanges()||ad.changes.settings||ad.changes.data)){return}return this.updateGraph()};ac.prototype.updateGraph=function(){var ag,ad,af,ae;af=new Date().getTime();if(this.scene.settings.navigation.expandDelay&&this.lastExpandTime>af-this.scene.settings.navigation.expandDelay){this.chart.events.notifySceneChanges({navigation:true});return}this.lastExpandTime=af;this.resolveConflicts();ae=this.computeRelevances(),ad=ae[0],ag=ae[1];return this.applyRelevances(ad,ag)};ac.prototype.resolveConflicts=function(){var aq,ap,ak,ad,am,ar,af,ae,al,ao,ai,an,aj,ah,ag;aj=this.nodes;ag=[];for(ae in aj){aq=aj[ae];if(this.scene.settings.navigation.mode!=="focusnodes"&&this.scene.data.isFilteredNode(ae)){delete this.nodes[ae];continue}if(!aq.initial&&!aq.hidden&&!this.graph.idToNode.hasOwnProperty(ae)){delete this.nodes[ae];continue}if(aq.expanded){ar=this.scene.data.getNodeCollectedLinks(ae);for(ai=0,an=ar.length;ai<an;ai++){am=ar[ai];ao=this.otherEnd(am,ae);al=this.nodes[ao];if(al&&al.actionId<aq.actionId&&al.hidden){delete this.nodes[ao]}}}if(this.scene.settings.navigation.mode==="focusnodes"){af=this.scene.settings.navigation.numberOfFocusNodes;ap=[];ah=this.nodes;for(ad in ah){aq=ah[ad];if(aq.initial){ap.push(aq)}}ap.sort(function(au,at){return au.actionId-at.actionId});ak=0;ag.push((function(){var at;at=[];while(ap.length-ak>af){ap[ak].initial=false;at.push(ak++)}return at})())}else{ag.push(void 0)}}return ag};ac.prototype.computeRelevances=function(){var aC,aG,az,au,aF,ae,an,ad,ah,aA,af,ax,ap,aj,av,aq,ao,at,ay,aw,am,aE,ai,ag,aB,aD,ar,al,ak;this.changes=false;aA={};ah={};ay={};an=!!this.scene.settings.navigation.expandDelay;ad=false;aG=this.scene.settings.navigation.nodeAutoExpandFilter;av=this.scene.settings.navigation.mode;if(av==="focusnodes"){af=[];ar=this.nodes;for(ax in ar){aC=ar[ax];if(aC.initial){af.push(aC)}}af.sort(function(aI,aH){return aH.actionId-aI.actionId});au=this.scene.settings.navigation.focusHistoryRelevanceCooldown;az=0;for(ai=0,aB=af.length;ai<aB;ai++){aC=af[ai];ax=aC.id;aw=aC.relevance;if(aw<0){aw=1+parseFloat(this.scene.settings.navigation.focusNodeExpansionRadius)}aw=Math.max(0,aw-az);az+=au;aA[ax]=aw;ay[ax]=true}}else{if(av==="manual"){al=this.nodes;for(ax in al){aC=al[ax];ay[ax]=true;aA[ax]=1}}else{ak=this.scene.data.getNodes();for(ax in ak){aF=ak[ax];ay[ax]=true;aA[ax]=1.01}}}while(T.hasProperties(ay)){at={};for(ax in ay){aE=ay[ax];am=aA[ax];aC=this.nodes[ax];if(aC){if(aC.hidden){delete aA[ax];continue}if(aC.expanded){am=2}ae=aC.expanded||(am>1&&!aC.collapsed)&&!ah.hasOwnProperty(ax)}else{ae=am>1}if(!ae&&aG){1}if(ae&&an&&!this.graph.idToNode.hasOwnProperty(ax)){ad=true;ae=false}if(ae&&!ah.hasOwnProperty(ax)){ah[ax]=true;aj=this.scene.data.getNodeLinks(ax);if(aj==null){aj=this.scene.data.getNodeCollectedLinks(ax)}ao=am-1;for(ag=0,aD=aj.length;ag<aD;ag++){ap=aj[ag];aq=this.otherEnd(ap,ax);if(!aA.hasOwnProperty(aq)||ao>aA[aq]){aA[aq]=ao;at[aq]=true}}}}ay=at}if(ad){this.chart.events.notifySceneChanges({navigation:true})}return[aA,ah]};ac.prototype.applyRelevances=function(ah,am){var an,al,ao,ap,aj,aq,ae,ad,ak,ar,ai,ag,af;aq=1;for(ad in ah){ar=ah[ad];aq=Math.max(aq,ar);an=am.hasOwnProperty(ad);ae=this.graph.addNode(ad);if(an){this.graph.addNodeWithLinks(ad)}al=this.nodes[ad]&&this.nodes[ad].initial;if(an!==ae.expanded||al!==ae.focused||ae.relevance!==ar){ae.expanded=an;ae.focused=al;ae.relevance=ar;this.scene.touchNode(ae)}}ai=this.graph.idToNode;for(ak in ai){ae=ai[ak];if(!ah.hasOwnProperty(ak)){ae.relevance=0;this.graph.removeNode(ak)}}ag=this.graph.idToLink;af=[];for(ap in ag){ao=ag[ap];af.push(ao.relevance=aj=Math.min(ao.from.relevance,ao.to.relevance))}return af};return ac})();var F;F=(function(){function ac(){}ac["export"]=function(aj,ag){var ar,ap,aw,ad,ah,ao,ae,au,am,an,al,aq,at,ak,ai,av,af;if(ag.type===void 0){ag.type="png"}if(ag.transparent===void 0){ag.transparent=ag.type==="png"}if(ag.dimensions===void 0){ag.dimensions={}}if(ag.type==="png"||ag.type==="jpeg"){au={png:"image/png",jpeg:"image/jpeg"};ae=au[ag.type];an=aj.saveAsImage(ag.type,ag.dimensions,ag.transparent);return this.proxyExport(aj,ae,an,"base64",ag.dimensions)}else{if(ag.type==="pdf"){ai=[aj._impl.scene.chartWidth,aj._impl.scene.chartHeight];al=[10,10,10,10];ar=[];ak=at=0;ah=ap=0;ad=72;av=1;af=ao=0;if(ai[0]>=ai[1]){ar=[297,210];am="l"}else{ar=[210,297];am="p"}ak=ar[0]/25.4*ad;at=ar[1]/25.4*ad;av=Math.min(at/ai[1],ak/ai[0]);if(am==="l"){af=ai[0]*av/ak*ar[0]-al[1]-al[3];ah=(ar[0]-af-al[1]-al[3])/2;ao=ai[1]/ai[0]*af;ap=(ar[1]-al[0]-al[2]-ao)/2}else{ao=ai[1]*av/at*ar[1]-al[0]-al[2];ap=(ar[1]-ao-al[0]-al[2])/2;af=ai[0]/ai[1]*ao;ah=(ar[0]-al[1]-al[3]-af)/2}an=aj.saveAsImage("jpeg",{scaling:av*3},ag.transparent);an=an.slice("data:image/jpeg;base64,".length);an=atob(an);aw=new jsPDF(am,"mm","a4");aw.addImage(an,"JPEG",al[3]+ah,al[0]+ap,af,ao);aq=aw.output("datauristring");return this.proxyExport(aj,"application/pdf",aq,"base64",{})}else{return aj._impl.error("Unrecognized export type: "+ag.type)}}};ac.proxyExport=function(al,am,aj,ae,ad){var an,ak,ai,ah,ag,af;ak=T.createDom("form");ak.setAttribute("action",al._impl.settings.advanced.exportProxyURL);ak.setAttribute("method","POST");ak.setAttribute("style","display:none");ai=T.createDom("input",null,null,ak);ai.setAttribute("type","hidden");ai.setAttribute("name","type");ai.setAttribute("value",am);ah=T.createDom("input",null,null,ak);ah.setAttribute("type","hidden");ah.setAttribute("name","encoding");ah.setAttribute("value",ae);ag=T.createDom("input",null,null,ak);ag.setAttribute("type","hidden");ag.setAttribute("name","data");ag.setAttribute("value",aj);if(ad.dpi!=null){af=T.createDom("input",null,null,ak);af.setAttribute("type","hidden");af.setAttribute("name","setdpi");af.setAttribute("value",parseInt(ad.dpi))}an=document.getElementsByTagName("body")[0];an.appendChild(ak);ak.submit();return an.removeChild(ak)};return ac})();var N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAAA0CAYAAAC5HgcyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAACMBJREFUeNrsXGtsFFUUPrOzfdPC8rQkQFwiJKhEUxKIr/CjVRMTX0kJJBqUaIH6gOCPbTD6C0MbTAyS1LQhFDUqodEIGsBsxVp5CoWgxQJNl6UNbcFC6XvZ7e547uyZ9nY6uzuzXUp3nJOczs6dM2fu3O+ec8+5c3sFqRj0UxBZ0ryShuxAvjEsEQI4OsMBmxcuhBRJAmFEdjnybuSnkLtZgYDCQUiHRtgKPpiPJQFe99vIXmT3mKfaRICUVDBC0tolYFayH7+uT1BENFbMwR8p6raW6Wnkz5GXIQ8oYD7g94M4VtUV5C3I/SNFIVQ5FYFcgMgG1R3m4bA2dYXsAIOooumcwVc2L5iCEeGVcwFKHgN4bt4YC81GRiTgonwFm74pKwOKFy2CmykpsmXGsBesiATXpDXwr/gC1moIvYA/cvXs2KNutgLsfA+g46oxy4xZl+QlmxHh2jaA5w8BnOxgDTrqUi9yg4wKtlUgzQZblzwEralpkDrSeMx/voGco9WnhBQbzGqpAPh0HUBPJ1peSpQuiNUe7DMMpNnJFs9N/mAUm0a/+ssNO9Se6oNpmQhS6vAjXkSuQn6UztHOYRYPkCQggJdPAxzZC5CRNcoWST78VAEPaZkWeokAs21gFJgvI+9CDrcu4jF4yw+dVR5oLm+GgZYBEDNExErYh1efRT6LvAb5b+QLyAVyRRD0QPdQWOMtNP3QqGFyNfI15CfAZguPl3XfW+glAswNfwBcvzPsap9BXkfjpkz7vOFj5/FOaNzWCJ7dHvlUsAssIr2LXII8HTkXeZOYKUL3xW7wVtGNF2oBLiHmmTnK4PyPbNU2W6tskd+Vofl/aaGXCDB7MJrdUIeoBGW3+iH+dcppCSYo5ecBDni5ODUQgs66TmiubCZvKpt07bBXThd/723shaadTTDUT5Y5hA8ox4D3KhpvRjaLWs7hjUWQltUC+3YAHK4aFdCYOai5Z9EsjXFTkduxAfujKhYElpU8yIZY5BZWNvPJmeAsckLQF2R56Wpbim3Q1+GrbvykUUIgZ1NwZET3XZRtpbL/fTSr6+W53n+d/N4xvlyLkcpJdiCWLMm3k3ydDtlKku03apl66pKsbBRMZjEbw8UxFbPZnR0Oh0PSWRGW3hTr1I15CWxnRwvMERaMuCV0ZTfxfDYeWYMLMVzhHZSZlpubK7W3t8d8Dsoz95qrU3cvymQr91huNr4AyMgYKxlsPMO64w3gLDAtssC0yALTIgtMC0yLLDDv+2yURRMNpt78D7TWL1hkiOwT9aAV367wDvUNLVDbIgP7zFtnGOJ+C44kcbNSSOqJcKnHcrNWAGSRScC0rDhJwAzpkAla0GkHQGz5BlspUA+RljhPLMnrboWqi0EI+EZfyZgC0uuLRW6c1Uts7S37fOc1u2X+iHwGeROdq/m+RL/Yr2w66mNT/dbildRRT0F4dYKpLXMe/f4M+aMoeSJbLnJyktV/D/v+icfbUWSm05Gtx88yNZiSJCVtb8W6u/DgskZLKzUxn2UamG5TrMFqtUk8ZiYt8R3R6mSWm7UsM4ktuQgPbO1nmZZ1J4hYzl5I6VDNBASBE2KZk3HKjTVy6T1+hpOekZcsbnZIh4zPcnzJ4WbDH5KLMWFXz5KyLQZ2yYuYB63mTQ4whQTJ3Osx0sG5O08CVefTsYvGxkQQq6eDfkcaa9Xv4zF9NMtARGb/C8qm+dzEzRwIihz7x19JXc5RM11XGrlIpfMsyRSOs2M0ky5FL3umSwViqcb7uPEdnKaNZska3dSD2X+LVXM938UBA3S9gsCo0bAUJ8l0cQ3KaBWVKZGrZxzW6CZdJZyV56l0KnWspvooncBFgC7DqLbLjKlJETVGCZ+CMLDwpfN5K8TrlVhWSveUUKPyeoBrPMUNlnAdhL8eDymdo0DlrmtUlqsAuUol00U6WF3LzOhm8wmoMp3yZSrwFLem5Ir13PiopDeOBNTTQXWtiTHu5kfpNLyVglnBNJKsV2uAqQDGN6ACbB6NV6XkZscT8ICOukaT66Jy04JplDwEmpMLZIqoodTWUEBlDhqvmidgEuKeTxqYYz5orHUWEqh5nPtVW8J6CH/wXk/nk+abqm2iAArdDQkR5COUxl21+iipRqSxThm3Crl7q6M8Q7HaZapxzWg9QUdaUxNDLl/RFW+LiToSm1F7IPpv+W8L4ljcsKxXJR/WmpamW7dWI9GkOp+y5EH0+dJKLsKs1pludBkMePJU9ypjcL4O0Is0rrn4jhcvmOGN7YJwfowGcXi3SrYVDHR0dFTaRNuFwbbBg2L6aAzYrlz+2/6f6VQBNYxiIPCXvBMXb8D21D46maUHFATQxdIRAnZ/jKiRzye1Ikcn5YQuLl2o0LBiPurlU6GzxDwoJXTcz+nNpw5VyllmNZW7Ob0uklHG/LjBbMIGOre3AbYEBTghN3+aDHHLMS+sm54uVA4DDvCrFJKWth1o6/a1+z62Z9p72PZr9ix7IDgQ/KbtYNsPqIstr6xVZl3w/E/4bf9mdLWnISsHIDMb9ad74fzRN4WsnD3RLBNTknouHyulBqjg8zSy0khpiidC5OiEkS8ibgKgkO6JFPUqszXRXKi6rm4NK1xPz8mn57pJnt1fwCYM4gpL5C1KBOE1/Pk18qHls2H7/ByYAhKIfQHoOtwCr2L5B8hfoGwxyrI99dgyx8Vome/mPJJzBWWz0b36+jx96f5OP9svaAZ7eZS/hPJr8fde5J9g4dIymDE3G0IhEXx9XdBwgjXeZgjv1fe+ul4as0GKVdQrL6who3aFjhgu1smlJPVRXK0yyVDPWbwzindQ5KPN946Zmx3XCgvu5m00h8j4BFlWD50z15nNybJFyE10zUs9q4HO2deVV1S6t3O6j5PuXjo/ABpLJs28v0/CNnWKAiajl5h1IrNtEQfIAt9RghiV7BxyDZch/O97bLevr5Afj/AoBvARCG8OxXSzNbsbI4VdFpgS/CfAAOjmUutlIPngAAAAAElFTkSuQmCC";var a;a=(function(){function ac(){}ac.closestPointToLine=function(ae,aj,ad,ah,ai,ag){var am,al,af,ak;am=ad-ae;al=ah-aj;af=am*am+al*al;if(af>0){ak=(((ai-ae)*am)+(ag-aj)*al)/af;ak=Math.min(Math.max(ak,0),1)}else{ak=0}return[ae+am*ak,aj+al*ak]};ac.rayIntersectsLine=function(af,ae,ap,ao,ah,ag,al,ai){var an,ad,ak,aj,aq,am;an=Infinity;ak=al-ah;aj=ai-ag;ad=ap*aj-ao*ak;if(ad!==0){am=(ae*ak-af*aj+ah*aj-ag*ak)/ad;if(Math.abs(ak)>Math.abs(aj)){aq=(af+ap*am-ah)/ak}else{aq=(ae+ao*am-ag)/aj}if(aq>=0&&aq<=1&&am>=0){an=am}}return an};ac.rayIntersectsCircle=function(af,ae,an,al,ad){var ao,am,aj,ak,ai,ah,ag;ao=an*an+al*al;am=af*an+ae*al;aj=af*af+ae*ae-ad*ad;ai=am*am-ao*aj;ak=Infinity;if(ai>0){ai=Math.sqrt(ai);ah=(-am-ai)/ao;ag=(-am+ai)/ao;if(ah>=0){ak=ah}if(ag>=0){ak=Math.min(ak,ag)}}return ak};ac.rayIntersectsCircleOuter=function(af,ae,ak,ai,ad){var al,aj,ah,ag;al=ak*ak+ai*ai;aj=af*ak+ae*ai;ah=af*af+ae*ae-ad*ad;ag=aj*aj-al*ah;ag=Math.sqrt(ag);return Math.max((-aj+ag)/al,(-aj-ag)/al)};ac.lineTouchingCircle=function(ag,af,ah,am,ae){var al,ai,ak,ao,an,aj,ad;al=Math.sqrt(ag*ag+af*af);if(!(al>ae)){return null}ak=Math.sqrt(al*al-ae*ae);aj=ae*ak/al;ad=ae*ae/al;ao=ag/al;an=af/al;ai=ag*am-af*ah;if(ai<0){aj=-aj}return[ao*ad-an*aj,an*ad+ao*aj]};return ac})();var f;f=(function(){function ac(ad){this.seed=ad;this.A=48271;this.M=2147483647;this.Q=this.M/this.A;this.R=this.M%this.A;this.oneOverM=1/this.M}ac.prototype.get=function(){var ad,ae,af;ad=this.seed/this.Q;ae=this.seed%this.Q;af=this.A*ae-this.R*ad;if(af>0){this.seed=af}else{this.seed=af+this.M}return this.seed*this.oneOverM};return ac})();var k;k=(function(){function ac(){}ac.clamp_css_byte=function(ad){ad=Math.round(ad);if(ad<0){return 0}else{if(ad>255){return 255}else{return ad}}};ac.clamp_css_float=function(ad){if(ad<0){return 0}else{if(ad>1){return 1}else{return ad}}};ac.parse_css_int=function(ad){if(ad[ad.length-1]==="%"){return ac.clamp_css_byte(parseFloat(ad)/100*255)}return ac.clamp_css_byte(parseInt(ad))};ac.parse_css_float=function(ad){if(ad[ad.length-1]==="%"){return ac.clamp_css_float(parseFloat(ad)/100)}return ac.clamp_css_float(parseFloat(ad))};ac.css_hue_to_rgb=function(ae,ad,af){if(af<0){af+=1}else{if(af>1){af-=1}}if(af*6<1){return ae+(ad-ae)*af*6}if(af*2<1){return ad}if(af*3<2){return ae+(ad-ae)*(2/3-af)*6}return ae};ac.parseCSSColor=function(am){var ag,ap,ad,ai,ah,ae,an,al,aj,af,ao,ak;ak=am.replace(RegExp(" ","g"),"").toLowerCase();if(ak in ac.kCSSColorTable){return ac.kCSSColorTable[ak].slice()}if(ak[0]==="#"){if(ak.length===4){ah=parseInt(ak.substr(1),16);if(!(ah>=0&&ah<=4095)){return null}return[((ah&3840)>>4)|((ah&3840)>>8),(ah&240)|((ah&240)>>4),(ah&15)|((ah&15)<<4),1]}else{if(ak.length===7){ah=parseInt(ak.substr(1),16);if(!(ah>=0&&ah<16777215)){return null}return[(ah&16711680)>>16,(ah&65280)>>8,ah&255,1]}}return null}aj=ak.indexOf("(");ap=ak.indexOf(")");if(aj!==-1&&ap+1===ak.length){ad=ak.substr(0,aj);af=ak.substr(aj+1,ap-(aj+1)).split(",");ag=1;if(ad==="rgba"){if(af.length!==4){return null}ag=ac.parse_css_float(af.pop())}if(ad==="rgba"||ad==="rgb"){if(af.length!==3){return null}return[ac.parse_css_int(af[0]),ac.parse_css_int(af[1]),ac.parse_css_int(af[2]),ag]}if(ad==="hsla"){if(af.length!==4){return null}ag=ac.parse_css_float(af.pop())}if(ad==="hsla"||ad==="hsl"){if(af.length!==3){return null}ai=(((parseFloat(af[0])%360)+360)%360)/360;ao=parse_css_float(af[1]);ae=parse_css_float(af[2]);al=(ae<=0.5?ae*(ao+1):ae+ao-ae*ao);an=ae*2-al;return[ac.clamp_css_byte(ac.css_hue_to_rgb(an,al,ai+1/3)*255),ac.clamp_css_byte(ac.css_hue_to_rgb(an,al,ai)*255),ac.clamp_css_byte(ac.css_hue_to_rgb(an,al,ai-1/3)*255),ag]}}return null};ac.kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};return ac})();var S;S=(function(){var ae,ad;ae=(function(){function af(){}af.prototype.forceLinkList=null;af.prototype.x=0;af.prototype.y=0;af.prototype.r=0;af.prototype.fx=0;af.prototype.fy=0;af.prototype.sizeEstimate=0;af.prototype.left=null;af.prototype.right=null;af.prototype.nodes=null;return af})();ac.prototype.maxLeafCount=5;ac.test=function(){var ah,af,ag;ag=new ac();ag.maxLeafCount=2;ag.temperature=1;af=[];ah={z:0,dx:0,dy:0,dz:0,repulsiveForceX:0,repulsiveForceY:0,repulsiveForceZ:0,fsum:0};af.push(T.extend({r:5,x:10,y:10},ah));af.push(T.extend({r:5,x:0,y:0},ah));af.push(T.extend({r:5,x:0,y:10},ah));af.push(T.extend({r:5,x:10,y:0},ah));af.push(T.extend({r:5,x:10,y:10},ah));af.push(T.extend({r:5,x:20,y:0},ah));af.push(T.extend({r:5,x:25,y:0},ah));return ag.buildTree(af,af.length)};function ac(){this.root=null;this.freeNodeRoot=null;this.temperature=0;this.nodeCount=0}ac.prototype.buildTree=function(ah){var ag,af,aj,ai;this.iters=0;ag=ah.length;if(this.root!=null){this.freeNode(this.root)}this.root=this.newNode();if(ag>0){this.buildTreeRecursive(ah,0,ag,this.root)}for(af=aj=0,ai=ag-1;aj<=ai;af=aj+=1){ah[af].repulsiveForceX=0;ah[af].repulsiveForceY=0;ah[af].repulsiveForceZ=0}return this.calculateForces()};ac.prototype.freeNode=function(af){if(af.left!=null){this.freeNode(af.left)}if(af.right!=null){this.freeNode(af.right)}af.left=this.freeNodeRoot;return this.freeNodeRoot=af};ac.prototype.newNode=function(){var af;if(this.freeNodeRoot!=null){af=this.freeNodeRoot;this.freeNodeRoot=af.left;af.left=null;af.right=null;af.leafCount=0;af.sizeEstimate=0;af.forceLinkList.length=0}else{af=new ae();af.forceLinkList=[];af.leaves=new Array(this.maxLeafCount)}af.repulsiveForceX=0;af.repulsiveForceY=0;af.repulsiveForceZ=0;return af};ad=function(ag,ah,af){var ai;ai=ag[ah];ag[ah]=ag[af];return ag[af]=ai};ac.prototype.addForceLink=function(af,ag){return af.forceLinkList.push(ag)};ac.prototype.getMedianX=function(ag,af,al){var aj,am,ak,ah,ai;al-=1;ak=((af+al)/2)|0;while(true){if(al<=af){return ak}if(al===af+1){if(ag[af].x>ag[al].x){ad(ag,af,al);return ak}}ah=((af+al)/2)|0;if(ag[ah].x>ag[al].x){ad(ag,ah,al)}if(ag[af].x>ag[al].x){ad(ag,af,al)}if(ag[ah].x>ag[af].x){ad(ag,ah,af)}ad(ag,ah,af+1);am=af+1;aj=al;while(true){while(true){am+=1;if(!(ag[af].x>ag[am].x)){break}}while(true){aj-=1;if(!(ag[aj].x>ag[af].x)){break}}if(aj<am){break}ai=ag[am];ag[am]=ag[aj];ag[aj]=ai}ad(ag,af,aj);if(aj<=ak){af=am}if(aj>=ak){al=aj-1}}};ac.prototype.getMedianY=function(ag,af,al){var aj,am,ak,ah,ai;al-=1;ak=((af+al)/2)|0;while(true){if(al<=af){return ak}if(al===af+1){if(ag[af].y>ag[al].y){ad(ag,af,al)}return ak}ah=((af+al)/2)|0;if(ag[ah].y>ag[al].y){ad(ag,ah,al)}if(ag[af].y>ag[al].y){ad(ag,af,al)}if(ag[ah].y>ag[af].y){ad(ag,ah,af)}ad(ag,ah,af+1);am=af+1;aj=al;while(true){while(true){am+=1;if(!(ag[af].y>ag[am].y)){break}}while(true){aj-=1;if(!(ag[aj].y>ag[af].y)){break}}if(aj<am){break}ai=ag[am];ag[am]=ag[aj];ag[aj]=ai}ad(ag,af,aj);if(aj<=ak){af=am}if(aj>=ak){al=aj-1}}};ac.prototype.buildTreeRecursive=function(aB,an,am,aD){var ao,ap,az,af,aq,ay,ax,aw,av,aC,aA,au,al,aj,ar,ah,ag,at,ak,ai;aC=aA=aB[an].x;al=aj=aB[an].y;for(az=ah=at=an+1,ak=am-1;ah<=ak;az=ah+=1){ax=aB[az];av=ax.x;au=ax.y;if(av<aC){aC=av}if(av>aA){aA=av}if(au<al){al=au}if(au>aj){aj=au}}aD.sizeEstimate=Math.max(aA-aC,aj-al);aD.sizeEstimate=aD.sizeEstimate*aD.sizeEstimate+0.1;aD.sizeEstimate*=2;ap=am-an;if(ap<=this.maxLeafCount){aD.leafCount=ap;av=0;au=0;ar=0;aw=0;for(az=ag=0,ai=ap-1;ag<=ai;az=ag+=1){ay=aB[az+an];av+=ay.x;au+=ay.y;ar+=ay.z;aw+=ay.r;aD.leaves[az]=ay}af=1/ap;aD.r=aw;aD.x=av*af;aD.y=au*af;aD.z=ar*af;return}if(aA-aC>aj-al){aq=this.getMedianX(aB,an,am)}else{aq=this.getMedianY(aB,an,am)}aq++;ao=this.newNode();aD.left=ao;this.buildTreeRecursive(aB,an,aq,ao);ao=this.newNode();aD.right=ao;this.buildTreeRecursive(aB,aq,am,ao);af=1/ap;aD.r=aD.right.r+aD.left.r;aD.x=(aD.left.x*(aq-an)+aD.right.x*(am-aq))*af;aD.y=(aD.left.y*(aq-an)+aD.right.y*(am-aq))*af;return aD.z=(aD.left.z*(aq-an)+aD.right.z*(am-aq))*af};ac.prototype.calculateForces=function(){var ar,an,am,ax,ao,av,at,ag,af,au,aq,aw,aj,ah,ap,al,ak,ai;au=new Array(this.nodeCount);aw=0;aq=0;if(this.root.left!==null){au[aq]=this.root.left;aq++;au[aq]=this.root.right;aq++;this.addForceLink(this.root.left,this.root.right)}else{au[aq]=this.root;aq++}ai=[];while(aw<aq){at=au[aw];aw++;ao=1/at.r;if(at.left!==null){this.processTreeNode(at,at.left);this.processTreeNode(at,at.right);au[aq]=at.left;aq++;au[aq]=at.right;aq++;ar=at.left.r*ao;an=at.repulsiveForceX*ar;am=at.repulsiveForceY*ar;at.left.repulsiveForceX+=an;at.left.repulsiveForceY+=am;at.right.repulsiveForceX+=at.repulsiveForceX-an;at.right.repulsiveForceY+=at.repulsiveForceY-am;this.addForceLink(at.left,at.right)}else{for(ax=aj=0,ap=at.leafCount-1;aj<=ap;ax=aj+=1){ag=at.leaves[ax];this.processLeafNode(at,ag);ar=ag.r*ao;ag.repulsiveForceX+=at.repulsiveForceX*ar;ag.repulsiveForceY+=at.repulsiveForceY*ar;for(av=ah=al=ax+1,ak=at.leafCount-1;ah<=ak;av=ah+=1){af=at.leaves[av];this.forceBetweenParticles(ag,af)}}}ai.push(at.forceLinkList.length=0)}return ai};ac.prototype.processTreeNode=function(ag,au){var ai,ah,an,ap,af,al,ao,ar,aq,at,ak,am,aj;af=ag.forceLinkList.length;aj=[];for(an=ak=0,am=af-1;ak<=am;an=ak+=1){al=ag.forceLinkList[an];ar=au.x-al.x;aq=au.y-al.y;ap=ar*ar+aq*aq;ao=au.sizeEstimate;if(al instanceof ae){ao+=al.sizeEstimate}if(ao<ap){at=au.r*al.r/(ap*Math.sqrt(ap));ai=ar*at;au.repulsiveForceX+=ai;al.repulsiveForceX-=ai;ah=aq*at;au.repulsiveForceY+=ah;aj.push(al.repulsiveForceY-=ah)}else{if(al instanceof ae){aj.push(this.addForceLink(al,au))}else{aj.push(this.addForceLink(au,al))}}}return aj};ac.prototype.processLeafNode=function(af,at){var ah,ag,an,ak,am,ap,ao,ar,aj,aq,al,ai;al=af.forceLinkList;ai=[];for(aj=0,aq=al.length;aj<aq;aj++){ak=al[aj];if(!(ak instanceof ae)){ai.push(this.forceBetweenParticles(at,ak))}else{ap=at.x-ak.x;ao=at.y-ak.y;an=ap*ap+ao*ao;am=ak.sizeEstimate;if(am<an){ar=at.r*ak.r/(an*Math.sqrt(an));ah=ap*ar;at.repulsiveForceX+=ah;ak.repulsiveForceX-=ah;ag=ao*ar;at.repulsiveForceY+=ag;ai.push(ak.repulsiveForceY-=ag)}else{ai.push(this.addForceLink(ak,at))}}}return ai};ac.prototype.forceBetweenParticles=function(ah,ag){var ai,al,aj,ak,am,af;aj=ah.x-ag.x;ak=ah.y-ag.y;am=ah.z-ag.z;ai=aj*aj+ak*ak+am*am;al=ah.r+ag.r;if(ai*this.temperature<al){af=0.25*this.temperature*Math.sqrt(this.temperature*al)}else{af=0.25*al*al/(ai*Math.sqrt(ai))}ah.repulsiveForceX+=aj*af;ag.repulsiveForceX-=aj*af;ah.repulsiveForceY+=ak*af;ag.repulsiveForceY-=ak*af;ah.repulsiveForceZ+=am*af;return ag.repulsiveForceZ-=am*af};return ac})();var o;o=(function(){function ac(ae,ad){var af,ah,ag;this.edgecnt=0;this.nodecnt=ae;this.maxedges=ad;this.increment=ad+1;this.nodestart=new Array(ae);this.enodes=new Array(ad);this.next=new Array(ad);for(af=ah=0,ag=this.nodecnt-1;ah<=ag;af=ah+=1){this.nodestart[af]=-1}}ac.prototype.addEdge=function(ad,ae){if(this.edgecnt>=this.maxedges){this.maxedges+=this.increment;this.increment*=2;this.next.length=this.maxedges;this.enodes.length=this.maxedges}this.enodes[this.edgecnt]=ae;this.next[this.edgecnt]=this.nodestart[ad];this.nodestart[ad]=this.edgecnt;return this.edgecnt++};ac.prototype.addUndirectEdge=function(ad,ae){this.addEdge(ad,ae);return this.addEdge(ae,ad)};return ac})();var X;X=(function(){function ac(){}ac.themes={};ac.prototype.customize=function(ad){if(!this.themes.hasOwnProperty(ad)){throw"No customization named "+ad}return this.updateSettings(this.themes[ad])};ac.prototype.saveState=function(){return this._impl.save()};ac.prototype.restoreState=function(ae,ad){if(ad==null){ad=false}return this._impl.restore(ae,ad)};ac.prototype.updateSettings=function(ad){if(ad==null){ad={}}this._impl.updateSettings(ad,"api");return this};ac.prototype.on=function(ad,ae){return this._impl.on(ad,ae)};ac.prototype.off=function(ad,ae){return this._impl.off(ad,ae)};ac.prototype.updateSize=function(){this._impl.updateSize(true);return this};ac.prototype.reloadData=function(){return this._impl.reloadData()};ac.prototype.remove=function(){return this._impl.remove()};ac.prototype.saveAsImage=function(ad,ae,af){return this._impl.events.exportToImage(ad,ae,af)};ac.prototype["export"]=function(ad,ae,af){return F["export"](this,{type:ad,dimensions:ae,transparent:af})};ac.prototype.exportGetDimensions=function(ad){return this._impl.events.exportGetDimensions(ad)};return ac})();var y;y=(function(){function ac(){}ac.stroke=function(ae,ad){if(ad.lineWidth){ae.lineWidth=ad.lineWidth}ae.strokeStyle=ad.lineColor;ae.stroke();if(ad.lineWidth){return ae.lineWidth=1}};ac.fill=function(ae,ad){if(!ad.fillColor){return}ae.fillStyle=ad.fillColor;if(ad.shadowColor){ae.shadowOffsetX=ad.shadowOffsetX;ae.shadowOffsetY=ad.shadowOffsetY;ae.shadowBlur=ad.shadowBlur;ae.shadowColor=ad.shadowColor}ae.fill();if(ad.shadowColor){ae.shadowBlur=0;return ae.shadowColor=null}};ac.paint=function(ae,ad){if(ad.shadowColor){ae.shadowOffsetX=ad.shadowOffsetX;ae.shadowOffsetY=ad.shadowOffsetY;ae.shadowBlur=ad.shadowBlur;ae.shadowColor=ad.shadowColor}if(ad.lineColor){ae.lineWidth=ad.lineWidth?ad.lineWidth:1;ae.strokeStyle=ad.lineColor;ae.stroke()}if(ad.fillColor){ae.fillStyle=ad.fillColor;ae.fill()}if(ad.shadowColor){ae.shadowOffsetX=0;ae.shadowOffsetY=0;ae.shadowBlur=0;return ae.shadowColor=null}};ac.textStyle=function(ae,ad){if(ad.fillColor){ae.fillStyle=ad.fillColor}if(ad.font){ae.font=ad.font}if(ad.shadowColor){ae.shadowOffsetX=ad.shadowOffsetX;ae.shadowOffsetY=ad.shadowOffsetY;ae.shadowBlur=ad.shadowBlur;return ae.shadowColor=ad.shadowColor}};ac.rectStyle=function(ae,ad){if(ad.hasOwnProperty("lineColor")){ae.strokeStyle=ad.lineColor}if(ad.hasOwnProperty("fillColor")){return ae.fillStyle=ad.fillColor}};ac.pushClip=function(ag,ad,ah,ae,af){ag.save();ag.beginPath();ag.rect(ad,ah,ae,af);return ag.clip()};ac.popClip=function(ad){return ad.restore()};ac.arcBetweenTwoPoints=function(au,aj,ai,ao,aw,ag,av,af){var az,ay,ap,ax,aB,aA,at,ah,am,ak,an,al,ar,aq,ae,ad;am=(aw+av)/2;ak=(ag+af)/2;an=af-ag;al=aw-av;ah=an*an+al*al;if(ah===0){return}at=Math.sqrt(ah);ao=Math.min(Math.max(ao,at/2),at*3);ax=Math.sqrt(ao*ao/ah-0.25);ar=am+an*ax;ae=ak+al*ax;aq=am-an*ax;ad=ak-al*ax;aB=(ar-aj)*(ar-aj)+(ae-ai)*(ae-ai);aA=(aq-aj)*(aq-aj)+(ad-ai)*(ad-ai);if(aB>aA){aj=aq;ai=ad}else{aj=ar;ai=ae}az=Math.atan2(ag-ai,aw-aj);ay=Math.atan2(af-ai,av-aj);if(ay<az){ay+=Math.PI*2}ap=Math.abs(az-ay)>Math.PI;return au.arc(aj,ai,ao,az,ay,ap)};ac.strokeMarker=function(ah,ae,ad,ai,ag){var af;af=ag*1.41421356237;if(ae==="rect"){ah.moveTo(ad-ag,ai-ag);ah.lineTo(ad+ag,ai-ag);ah.lineTo(ad+ag,ai+ag);ah.lineTo(ad-ag,ai+ag);return ah.closePath()}else{if(ae==="romb"){ah.moveTo(ad-af,ai);ah.lineTo(ad,ai-af);ah.lineTo(ad+af,ai);ah.lineTo(ad,ai+af);ah.closePath();return ah.fill()}else{if(ae==="triangle"){ah.beginPath();ah.moveTo(ad-af,ai+af);ah.lineTo(ad+af,ai+af);ah.lineTo(ad,ai-af);ah.closePath();return ah.fill()}else{if(ae==="triangle2"){ah.beginPath();ah.moveTo(ad-af,ai-af);ah.lineTo(ad+af,ai-af);ah.lineTo(ad,ai+af);ah.closePath();return ah.fill()}else{if(ae==="circle"){ah.beginPath();ah.arc(ad,ai,ag,0,Math.PI*2,true);return ah.closePath()}else{throw"unknown marker shape "+ae}}}}}};ac.strokeBalloon=function(ah,ae,ak,al,ag){var af,ad,am,aj,ai;al=Math.max(al,ag*2);af=5;am=4;ad=(ag+am*2)/2;aj=ae;ai=ak;ah.moveTo(aj,ai);aj+=af;ai+=af;ah.lineTo(aj,ai);aj+=al/2-am-af;ah.lineTo(aj,ai);ah.arc(aj,ai+ad,ad,-Math.PI/2,Math.PI/2);ai+=ad*2;aj-=al-2*am;ah.lineTo(aj,ai);ah.arc(aj,ai-ad,ad,Math.PI*0.5,Math.PI*1.5);ai-=ad*2;aj+=al/2-am-af;ah.lineTo(aj,ai);aj+=af;ai-=af;ah.closePath();return ak+af+ad};ac.strokeBalloon2=function(ag,ae,aj,ak,af){var ad,al,ai,ah;al=4;ad=(af+al*2)/2;ak=Math.max(ak,af*2)/2-al;ai=ae+ak;ah=aj-ad;ag.moveTo(ai,ah);ag.arc(ai,ah+ad,ad,-Math.PI/2,Math.PI/2,false);ah+=ad*2;ai-=ak*2;ag.lineTo(ai,ah);ag.arc(ai,ah-ad,ad,Math.PI*0.5,Math.PI*1.5,false);return ag.closePath()};ac.applyColorToImage=function(an,ap,ad){var aw,av,au,ai,ax,at,ao,ar,aq,am,ak,al,af,ae,aj,ah,ag;if(ad==null){ad=true}aj=ac.parseColor(ap),am=aj[0],at=aj[1],av=aj[2],aw=aj[3];au=document.createElement("canvas");al=au.width=an.width;ar=au.height=an.height;ao=au.getContext("2d");ao.drawImage(an,0,0);ai=ao.getImageData(0,0,al,ar);ax=ai.data;if(ad){for(aq=af=0,ah=ax.length;af<=ah;aq=af+=4){if(ax[aq+3]!==255){continue}ax[aq]=(ax[aq]*am)>>8;ax[aq+1]=(ax[aq+1]*at)>>8;ax[aq+2]=(ax[aq+2]*av)>>8}}else{for(aq=ae=0,ag=ax.length;ae<=ag;aq=ae+=4){ax[aq]=(ax[aq]*am)>>8;ax[aq+1]=(ax[aq+1]*at)>>8;ax[aq+2]=(ax[aq+2]*av)>>8}}ao.putImageData(ai,0,0);ak=new Image();ak.src=au.toDataURL("image/png");return ak};ac.parseColor=function(ad){return k.parseCSSColor(ad)};ac.normalizeColor=function(af){var ae,ad,ah,ag,ai;ai=k.parseCSSColor(af),ag=ai[0],ah=ai[1],ad=ai[2],ae=ai[3];return"rgba("+ag+","+ah+","+ad+","+(ae.toFixed(3))+")"};ac.deriveColor=function(af,ah,ag){var ae,ad,aj,ai,ak;ak=ac.parseColor(af),ai=ak[0],aj=ak[1],ad=ak[2],ae=ak[3];return this.deriveColorRGBA(ai,aj,ad,ae,ah,ag)};ac.deriveColorRGBA=function(aj,ai,ad,af,ah,ag){var ae;ae=(ah-1)*255;aj=Math.round(Math.min(255,Math.max(0,aj+ae)));ai=Math.round(Math.min(255,Math.max(0,ai+ae)));ad=Math.round(Math.min(255,Math.max(0,ad+ae)));af=Math.min(1,af*ag);return"rgba("+aj+","+ai+","+ad+","+(af.toFixed(3))+")"};ac.blendColors=function(ao,an,am){var at,ah,ag,aq,au,ar,ap,af,ae,ad,aj,ai,al,ak;al=ac.parseColor(ao),aj=al[0],af=al[1],au=al[2],ah=al[3];ak=ac.parseColor(an),ai=ak[0],ae=ak[1],ar=ak[2],ag=ak[3];ad=Math.round(ai*am+aj*(1-am));ap=Math.round(ae*am+af*(1-am));aq=Math.round(ar*am+au*(1-am));at=ag*am+ah*(1-am);return"rgba("+ad+","+ap+","+aq+","+(at.toFixed(3))+")"};ac.copyHue=function(ag,aq){var ap,av,at,ao,ai,ah,au,ar,an,ae,ad,ak,am,al,aj,af;aj=ac.parseColor(ag),am=aj[0],ae=aj[1],ai=aj[2],av=aj[3];af=ac.parseColor(aq),al=af[0],ad=af[1],ah=af[2],at=af[3];au=(am+ae+ai)/765;ar=(al+ad+ah)/765;ak=Math.round(am/au*ar);an=Math.round(ae/au*ar);ao=Math.round(ai/au*ar);ap=at;return"rgba("+ak+","+an+","+ao+","+(ap.toFixed(3))+")"};ac.inverseColor=function(ah){var ae,ad,ag,af,ai;ai=ac.parseColor(ah),af=ai[0],ag=ai[1],ad=ai[2],ae=ai[3];af=255-af;ag=255-ag;ad=255-ad;return"rgba("+af+","+ag+","+ad+","+(ae.toFixed(3))+")"};ac.applyShadow=function(ae,ad){if(ad.shadowColor){ae.shadowOffsetX=ad.shadowOffsetX;ae.shadowOffsetY=ad.shadowOffsetY;ae.shadowBlur=ad.shadowBlur;return ae.shadowColor=ad.shadowColor}};ac.clearShadow=function(ad){ad.shadowOffsetX=0;ad.shadowOffsetY=0;ad.shadowBlur=0;return ad.shadowColor=""};return ac})();var J;J=(function(){var ae,ad;ae=(function(){function af(){}af.prototype.to=null;af.prototype.K=0;af.prototype.len=0;af.prototype.strength=0;return af})();ad=(function(){function af(){}af.prototype.x=0;af.prototype.y=0;af.prototype.z=0;af.prototype.r=1;af.prototype.zattr=1;af.prototype.repulsiveForceX=0;af.prototype.repulsiveForceY=0;af.prototype.repulsiveForceZ=0;af.prototype.fsum=0;af.prototype.edges=[];return af})();ac.prototype.temperature=0;ac.prototype.unitTemperature=0;ac.prototype.randomLayoutRadius=0;ac.prototype.repulsiveForceTree=null;ac.prototype.randomGenerator=null;ac.prototype.nodePermutation=null;ac.prototype.nodeRepulsionFactor=15;ac.prototype.componentCenterFactor=0.005;ac.prototype.linkForceFactor=0.2;ac.prototype.zAxisAttraction=1;ac.prototype.nodeDegreeModifier=1.2;ac.prototype.forceReductionFactor=1;ac.prototype.globalForceX=0;ac.prototype.globalForceY=0;ac.prototype.centerX=0;ac.prototype.centerY=0;ac.prototype.aspectRatio=null;function ac(af){this.random=af;this.nodeCount=0;this.nodes=[];this.forceX=[];this.forceY=[];this.forceZ=[];this.forceSum=[];this.oldForceX=[];this.oldForceY=[];this.oldForceZ=[];this.componentX=[];this.componentY=[];this.componentSum=[];this.componentNodeCount=[];this.nodePermutation=[];this.idToIndex={};this.repulsiveForceTree=new S()}ac.prototype.updateParams=function(ah,af,ag){this.spacing=ah;this.nodeDegreeModifier=af;this.aspectRatio=ag};ac.prototype.updateGraph=function(aL,aK,ai){var aE,aI,aZ,az,ar,aJ,a0,aA,aD,a2,aj,aR,a1,aH,aG,aF,ah,af,aw,au,at,aY,ag,aN,aB,a3,am,aU,aM,aX,aW,aV,aT,aC,aq,ap,ao,an,al,ak,aS,aQ,aP,aO,ay,ax,av;ai|=aL.length!==this.nodeCount;if(ai){af=this.nodes;aw=this.oldForceX;au=this.oldForceY;at=this.oldForceZ;aG=this.idToIndex;this.nodeCount=aL.length;this.oldForceX=new Array(this.nodeCount);this.oldForceY=new Array(this.nodeCount);this.oldForceZ=new Array(this.nodeCount);this.forceX=new Array(this.nodeCount);this.forceY=new Array(this.nodeCount);this.forceZ=new Array(this.nodeCount);this.forceSum=new Array(this.nodeCount);this.nodes=new Array(this.nodeCount);this.idToIndex={};for(a0=aX=0,aC=aL.length;aX<aC;a0=++aX){aR=aL[a0];aJ=aR.id;aH=new ad();aH.edges=[];this.idToIndex[aJ]=a0;this.nodes[a0]=aH;if(aG.hasOwnProperty(aJ)){aF=aG[aJ];ah=af[aF];aH.z=ah.z;this.oldForceX[a0]=aw[aF];this.oldForceY[a0]=au[aF];this.oldForceZ[a0]=at[aF]}else{this.oldForceX[a0]=0;this.oldForceY[a0]=0;this.oldForceZ[a0]=0}}this.nodePermutation=this.nodes.slice(0)}for(a0=aW=0,aq=aL.length;aW<aq;a0=++aW){aR=aL[a0];a1=this.nodes[a0];a1.x=aR.x;a1.y=aR.y;a1.r=Math.max(1,aR.currentRadius);a1.zattr=aR.visibility;a1.edges.length=0;a1.locked=aR.locked;this.forceX[a0]=0;this.forceY[a0]=0;this.forceZ[a0]=0;this.forceSum[a0]=0}for(aV=0,ap=aK.length;aV<ap;aV++){aj=aK[aV];aN=aj.strength;aD=aj.length;aU=aj.visibility;az=this.nodes[this.idToIndex[aj.from.id]];a3=this.nodes[this.idToIndex[aj.to.id]];if(!az||!a3){console.log("Layout: missing node for link: "+aj.from.id+" "+aj.to.id+", topology = "+ai);continue}if(az===a3){continue}az.edges.push({to:a3,strength:aN,len:aD,vis:aU});a3.edges.push({to:az,strength:aN,len:aD,vis:aU})}if(ai){this.computeComponents()}ag=this.spacing/2;aO=this.nodes;for(aT=0,ao=aO.length;aT<ao;aT++){aR=aO[aT];aB=0;ay=aR.edges;for(aS=0,an=ay.length;aS<an;aS++){aZ=ay[aS];aB+=aZ.to.edges.length*aZ.vis}aM=Math.sqrt(aB);aR.r+=ag;if(aM>4){aR.r+=(aM-4)*aR.r/4*this.nodeDegreeModifier}}aA=0;aY=0;ax=this.nodes;for(aQ=0,al=ax.length;aQ<al;aQ++){aR=ax[aQ];ar=0;av=aR.edges;for(aP=0,ak=av.length;aP<ak;aP++){aZ=av[aP];am=aZ.to;if(aR.locked&&am.locked||(aR===am)){continue}aY++;aE=aR.r+am.r;a2=aZ.len;aI=Math.min(20,aZ.strength);aZ.len=Math.max(1,aE*a2);aZ.K=aI*30/aZ.len;ar+=aZ.K;aA+=aZ.len}aR.fsum=ar}this.randomLayoutRadius=Math.max(1,aA/10);return this.unitTemperature=aA/aY/50};ac.prototype.computeComponents=function(){var au,aw,at,an,ar,ai,aq,ah,ao,am,ak,av,ag,af,ap,al,aj;this.componentX=[];this.componentY=[];this.componentSum=[];this.componentNodeCount=[];aq=new Array(this.nodeCount);ap=this.nodes;for(ao=0,av=ap.length;ao<av;ao++){ai=ap[ao];ai.component=-1}au=0;al=this.nodes;for(am=0,ag=al.length;am<ag;am++){ai=al[am];if(ai.component>=0){continue}ai.component=au;aw=0;ah=0;an=0;aq[an]=ai;an+=1;while(ah<an){ai=aq[ah];ah+=1;aw+=1;aj=ai.edges;for(ak=0,af=aj.length;ak<af;ak++){at=aj[ak];ar=at.to;if(ar.component===-1){ar.component=au;aq[an]=ar;an+=1}}}this.componentNodeCount.push(aw);this.componentX.push(0);this.componentY.push(0);this.componentSum.push(0);au+=1}};ac.prototype.updateComponents=function(){var an,af,al,aj,ah,ao,am,ak,ag,ai;for(an=al=0,am=this.componentNodeCount.length-1;al<=am;an=al+=1){this.componentX[an]=0;this.componentY[an]=0;this.componentSum[an]=0}ak=this.nodes;for(aj=0,ao=ak.length;aj<ao;aj++){af=ak[aj];an=af.component;this.componentX[an]+=af.x*af.r;this.componentY[an]+=af.y*af.r;this.componentSum[an]+=af.r}ai=[];for(an=ah=0,ag=this.componentNodeCount.length-1;ah<=ag;an=ah+=1){this.componentX[an]/=this.componentSum[an];ai.push(this.componentY[an]/=this.componentSum[an])}return ai};ac.prototype.globalLayout=function(af,an,al){var ai,ao,ah,aq,ag,am,aj,ap,ak;if(this.nodeCount<=0){return}if(al){if(this.nodeCount===1){af[0].x=af[0].y=0;return}else{this.initialRandomLayout()}}aq=0;ak=this.nodes;for(aj=0,ap=ak.length;aj<ap;aj++){ah=ak[aj];if(!ah.locked){aq++}}ag=Math.floor(Math.sqrt(aq)+10);ao=ag*2;this.forceReductionFactor=1;this.temperature=(Math.sqrt(aq)*2+20)*this.unitTemperature;this.zAxisAttraction=0.1;am=new Date().getTime();ai=3;while(this.temperature>this.unitTemperature){if((ao--)<=0){ao=ag*3/(ai++);this.temperature=this.temperature/1.5-0.5;if(this.temperature<20*this.unitTemperature){this.zAxisAttraction=this.zAxisAttraction*1.5+0.1}}this.randomNodePermutation();this.repulsiveForceTree.temperature=this.zAxisAttraction/4;this.repulsiveForceTree.buildTree(this.nodePermutation);this.moveNodesGlobal();if(this.aspectRatio){this.updateAspectRatio(this.forceReductionFactor*0.001)}if(new Date().getTime()>am+an){break}}if(al){this.centerNodes()}return this.storeNodes(af)};ac.prototype.initialRandomLayout=function(){var ap,at,aq,al,ag,am,af,ar,an,ak,ah,au,ao,aj,ai;ag=this.nodeCount;am=new Array(ag);for(aq=an=0,ao=ag-1;an<=ao;aq=an+=1){am[aq]=aq}for(aq=ak=0;ak<=ag;aq=ak+=1){al=Math.floor(this.random.get()*(ag-aq))+aq;ar=am[aq];am[aq]=am[al];am[al]=ar}ap=this.randomLayoutRadius;at=2*Math.PI/this.nodeCount;aj=this.nodes;ai=[];for(aq=ah=0,au=aj.length;ah<au;aq=++ah){ag=aj[aq];this.oldForceX[aq]=0;this.oldForceY[aq]=0;this.oldForceZ[aq]=0;ag.z=this.random.get()-0.5;if(!ag.locked){af=ap+ag.r;ag.x=af*Math.cos(am[aq]*at);ai.push(ag.y=af*Math.sin(am[aq]*at))}else{ai.push(void 0)}}return ai};ac.prototype.timedLayout=function(ah,ak){var ag,af,aj,ai;if(this.nodeCount<=0){return}if(this.nodeCount===1){ah[0].x=0;ah[0].y=0;this.temperature=0;this.unitTemperature=0;return}ag=0;if(ak<0.1){ag=2;this.forceReductionFactor=Math.min(this.forceReductionFactor,ak*10)}else{ag=Math.min(6,Math.round(2+ak*10))}this.zAxisAttraction=this.nodeRepulsionFactor/10;this.temperature=this.unitTemperature;for(af=aj=0,ai=ag-1;0<=ai?aj<=ai:aj>=ai;af=0<=ai?++aj:--aj){this.randomNodePermutation();this.repulsiveForceTree.temperature=this.zAxisAttraction/4;this.repulsiveForceTree.buildTree(this.nodePermutation);this.moveNodesIncremental();if(this.aspectRatio){this.updateAspectRatio(this.forceReductionFactor)}}return this.storeNodes(ah)};ac.prototype.moveNodesGlobal=function(){var af,aq,aj,ai,ag,an,ao,ap,ah,al,am,ak;this.initIteration();ah=this.temperature*0.5;af=this.forceReductionFactor;ak=[];for(an=al=0,am=this.nodeCount-1;al<=am;an=al+=1){ap=this.nodes[an];if(ap.locked){continue}this.calculateForce(an,0.5);this.oldForceX[an]=aj=this.forceX[an];this.oldForceY[an]=ai=this.forceY[an];this.oldForceZ[an]=ag=this.forceZ[an];aq=this.forceSum[an];aj*=aq;ai*=aq;ag*=aq;ao=aj*aj+ai*ai+ag*ag;if(ao<this.temperature*this.temperature&&ao>0.001){ao=this.temperature/Math.sqrt(ao);aj*=ao;ai*=ao;ag*=ao}ap.x+=aj*af+(this.random.get()-0.5)*ah;ap.y+=ai*af+(this.random.get()-0.5)*ah;ak.push(ap.z+=ag*af+(this.random.get()-0.5)*ah)}return ak};ac.prototype.moveNodesIncremental=function(){var az,ay,ao,au,at,ar,an,am,aw,ax,ap,av,aj,ah,ag,af,aq,al,ak,ai;this.initIteration();for(aw=aj=0,aq=this.nodeCount-1;aj<=aq;aw=aj+=1){if(!this.nodes[aw].locked){this.calculateForce(aw,0)}}av=0;ax=0;an=new Array(this.nodeCount);for(aw=ah=0,al=this.nodeCount-1;ah<=al;aw=ah+=1){if(this.nodes[aw].locked){continue}au=this.forceX[aw];at=this.forceY[aw];ar=this.forceZ[aw];am=this.forceSum[aw];ao=au*au+at*at+au*au;if(ao*am*am>this.unitTemperature*this.unitTemperature*0.05*0.05){ax+=ao;av+=this.oldForceX[aw]*au+this.oldForceY[aw]*at+this.oldForceZ[aw]*ar}else{an[aw]=true}}if(av>1e-7){this.forceReductionFactor*=1+0.4/1.618033989}else{if(av<-1e-7){this.forceReductionFactor/=1.4}}az=this.globalForceX/this.nodeCount;ay=this.globalForceY/this.nodeCount;for(aw=ag=0,ak=this.nodeCount-1;ag<=ak;aw=ag+=1){this.forceX[aw]+=az;this.forceY[aw]+=ay}this.forceReductionFactor=Math.min(1,this.forceReductionFactor);this.forceReductionFactor=Math.max(0.002,this.forceReductionFactor);for(aw=af=0,ai=this.nodeCount-1;af<=ai;aw=af+=1){ap=this.nodes[aw];if(!ap.locked&&!an[aw]){am=this.forceSum[aw]*this.forceReductionFactor;ap.x+=this.forceX[aw]*am;ap.y+=this.forceY[aw]*am;ap.z+=this.forceZ[aw]*am}this.oldForceX[aw]=this.forceX[aw];this.oldForceY[aw]=this.forceY[aw];this.oldForceZ[aw]=this.forceZ[aw]}};ac.prototype.initIteration=function(){var af,al,ai,ah,ak,ag,aj;af=0;al=0;ah=0;aj=this.nodes;for(ak=0,ag=aj.length;ak<ag;ak++){ai=aj[ak];ah+=ai.r;af+=ai.x*ai.r;al+=ai.y*ai.r}this.centerX=af/ah;this.centerY=al/ah;this.updateComponents();this.globalForceX=0;return this.globalForceY=0};ac.prototype.calculateForce=function(av,ag){var ai,ah,aC,aA,ao,au,ap,an,am,az,ax,ay,aw,ak,aj,at,ar,aq,af,aB,al;ak=this.nodes[av];ap=this.oldForceX[av]*ag;an=this.oldForceY[av]*ag;am=this.oldForceZ[av]*ag;al=ak.edges;for(af=0,aB=al.length;af<aB;af++){az=al[af];aj=az.to;at=ak.x-aj.x;ar=ak.y-aj.y;aq=ak.z-aj.z;aw=Math.sqrt(at*at+ar*ar+aq*aq);if(aw<0.01){aw=0.01}ax=(az.len-aw)*az.K/aw*this.linkForceFactor;ap+=ax*at;an+=ax*ar;am+=ax*aq}ap+=ak.repulsiveForceX*this.nodeRepulsionFactor;an+=ak.repulsiveForceY*this.nodeRepulsionFactor;am+=ak.repulsiveForceZ*this.nodeRepulsionFactor;ay=ak.zattr*this.zAxisAttraction/7;am-=ak.z*ay;ao=ak.component;ai=this.componentX[ao]-this.centerX;ah=this.componentY[ao]-this.centerY;au=Math.min(10,Math.sqrt(this.componentNodeCount[ao]));aC=ai*au*this.componentCenterFactor;aA=ah*au*this.componentCenterFactor;ap-=aC;an-=aA;this.globalForceX+=aC;this.globalForceY+=aA;if(isNaN(ap)){throw"Nan in layout"}this.forceX[av]=ap;this.forceY[av]=an;this.forceZ[av]=am;return this.forceSum[av]=1/(ak.fsum+ay)};ac.prototype.storeNodes=function(af){var ag,ai,ah;for(ag=ai=0,ah=this.nodeCount-1;ai<=ah;ag=ai+=1){if(!this.nodes[ag].locked){af[ag].x=this.nodes[ag].x;af[ag].y=this.nodes[ag].y}}};ac.prototype.updateAspectRatio=function(ap){var av,au,am,aj,aB,ar,aq,ao,az,aG,aE,aA,at,aH,aF,ai,ay,ax,aD,aC,an,al,ah,af,aw,ak,ag;az=this.nodes;aD=aC=az[0].x;an=al=az[0].y;for(aB=ah=1,aw=this.nodeCount-1;ah<=aw;aB=ah+=1){aD=Math.min(aD,az[aB].x);aC=Math.max(aC,az[aB].x);an=Math.min(an,az[aB].y);al=Math.max(al,az[aB].y)}am=(aD+aC)/2;aj=(an+al)/2;ay=aC-aD;ax=al-an;at=Math.sqrt(this.aspectRatio);ai=Math.sqrt(ay*ax);aH=ai*at/ay;aF=ai/at/ax;aH=ap*aH+(1-ap);aF=ap*aF+(1-ap);ar=am-am*aH;aq=aj-aj*aF;ao=1/this.forceReductionFactor;ag=[];for(aB=af=0,ak=this.nodeCount-1;af<=ak;aB=af+=1){aA=az[aB];av=aA.x;au=aA.y;aA.x=aG=av*aH+ar;aA.y=aE=au*aF+aq;this.forceX[aB]+=(aG-av)*ao;ag.push(this.forceY[aB]+=(aE-au)*ao)}return ag};ac.prototype.centerNodes=function(){var am,ai,ap,ah,ag,af,ar,aq,an,al,ao,ak,aj;ah=this.nodes;ag=af=ah[0].x;ar=aq=ah[0].y;for(ap=an=1,ao=this.nodeCount-1;an<=ao;ap=an+=1){ag=Math.min(ag,ah[ap].x);af=Math.max(af,ah[ap].x);ar=Math.min(ar,ah[ap].y);aq=Math.max(aq,ah[ap].y)}am=(ag+af)/2;ai=(ar+aq)/2;aj=[];for(ap=al=0,ak=this.nodeCount-1;al<=ak;ap=al+=1){ah[ap].x-=am;aj.push(ah[ap].y-=ai)}return aj};ac.prototype.randomNodePermutation=function(){var ag,ah,af,aj,ai;for(ag=aj=0,ai=this.nodeCount-1;aj<=ai;ag=aj+=1){ah=Math.floor(this.random.get()*(this.nodeCount-ag))+ag;af=this.nodePermutation[ag];this.nodePermutation[ag]=this.nodePermutation[ah];this.nodePermutation[ah]=af}};return ac})();var U;U=(function(){ac.prototype.formula=null;ac.prototype.startTime=null;ac.prototype.from=0;ac.prototype.to=0;ac.prototype.fromColor=null;ac.prototype.toColor=null;ac.prototype.t=0;ac.prototype.startSpeed=0;ac.prototype.easing_formulas={"=":function(ad){return ad},"<>":function(ad){if(ad<0.5){return 2*ad*ad}else{return -0.5*((ad*2-1)*(ad*2-3)-1)}},scroll:function(ad){return 1-(1-ad)*(1-ad)}};function ac(ah,ag,ae,af,ad){this.from=ah;this.to=ag;this.duration=ae;if(af==null){af="<>"}if(this.from===void 0||this.from===null){this.from=this.to}this.startTime=ad===void 0?new Date().getTime():ad;this.x=this.from;this.t=this.startTime;if(!this.easing_formulas[af]){throw"Easing formula not defined: "+af}else{this.formula=this.easing_formulas[af]}}ac.prototype.jump=function(ad){this.to=ad;this.from=ad;this.x=ad;return this.t=this.startTime=0};ac.prototype.retarget=function(ad,ae){ae=ae===void 0?new Date().getTime():ae;if(this.finished(this.t)){this.startSpeed=0}else{this.startSpeed=this._getSpeed()}this.from=this.get(ae);this.to=ad;this.startTime=ae;return this};ac.prototype.retargetColor=function(ad,ae){if(ae===void 0){ae=this.t?this.t:new Date().getTime()}this.startSpeed=0;this.from=this.x;this.to=ad;this.fromColor=null;this.toColor=null;this.startTime=ae;return this};ac.prototype.switchCoordinates=function(ae,ad){this.from=this.from*ad+ae;this.x=this.x*ad+ae;this.to=this.to*ad+ae;return this.startSpeed=this.startSpeed*ad};ac.prototype.updateAndGet=function(ae,af){var ad;ad=this.x!==ae;if(ae!==this.to){this.retarget(ae,af)}return[this.get(af),ad]};ac.prototype.updateAndGetFixed=function(ae,af){var ad;ad=this.x!==ae;if(ae!==this.to){this.startSpeed=0;this.startTime=af;this.from=this.x;this.to=ae;this.fromColor=null;this.toColor=null}return[this.get(af),ad]};ac.prototype.updateColorAndGet=function(ae,af){var ad;ad=this.x!==ae;if(ae!==this.to){this.retargetColor(ae,af)}return[this.getColor(af),ad]};ac.prototype.get=function(ag){var ad,ae,af,ah;if(this.duration<=0){this.t=ag;this.x=this.to;return this.to}ae=Math.min(1,Math.max(ag-this.startTime,0)/this.duration);if(ae>=1){this.t=ag;this.x=this.to;return this.to}ad=this.formula(ae);ah=ad*(this.to-this.from);if(this.startSpeed&&ae<1){af=this.startSpeed*ae*this.duration;ah=ah*ad+af*(1-ad)}ah=this.from+ah;this.t=ag;this.x=ah;return ah};ac.prototype.getColor=function(ag){var ai,ah,ae,an,aq,ap,ar,am,ak,af,ao,ad,al,aj;this.t=ag;if(this.duration<=0||this.from===this.to){return this.to}if(this.fromColor==null){this.fromColor=k.parseCSSColor(this.from)}if(this.toColor==null){this.toColor=k.parseCSSColor(this.to)}ar=Math.min(1,Math.max(ag-this.startTime,0)/this.duration);ap=this.formula(ar);aq=1-ap;al=this.fromColor,an=al[0],ae=al[1],ah=al[2],ai=al[3];aj=this.toColor,ao=aj[0],af=aj[1],ak=aj[2],am=aj[3];ad="rgba("+(Math.round(an*aq+ao*ap))+","+(Math.round(ae*aq+af*ap))+","+(Math.round(ah*aq+ak*ap))+","+((ai*aq+am*ap).toFixed(3))+")";this.t=ag;this.x=ad;return ad};ac.prototype.finished=function(ad){return ad>=this.startTime+this.duration};ac.prototype._getSpeed=function(){var af,ag,ae,ad;ad=this.t;af=this.duration/1000;ag=this.get(ad-af/2);ae=this.get(ad+af/2);this.t=ad;return(ae-ag)/af};return ac})();var M;M=(function(){function ac(ad){this.chart=ad;this.scene=ad.scene;this.events=ad.events;this.pointer1=null;this.pointer2=null;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.centerX=0;this.centerY=0;this.centerDistance=1;this.resetZoom=false;this.animatorX=new U(0,0,this.scene.settings.interaction.zooming.autoZoomDuration,"=");this.animatorY=new U(0,0,this.scene.settings.interaction.zooming.autoZoomDuration,"=");this.animatorZ=new U(0,0,this.scene.settings.interaction.zooming.autoZoomDuration,"=")}ac.prototype.onWheel=function(ae){var ad;if(!(this.scene.xyInChart(ae.x,ae.y)&&this.scene.settings.interaction.zooming.wheel)){return}ad=Math.pow(1+this.scene.settings.interaction.zooming.sensitivity,ae.wheely*0.004);this.zoom(ad,ae.x,ae.y);ae.consumed=true;return ae.changes.position=true};ac.prototype.onPointerDown=function(ah){var ag,af,ae,ai,ad,aj;if(this.pointer1===null){this.pointer1=ah.identifier;ai=[ah.x,ah.y],this.x1=ai[0],this.y1=ai[1];return ah.consumed=true}else{if(this.pointer2===null){this.pointer2=ah.identifier;ad=[ah.x,ah.y],this.x2=ad[0],this.y2=ad[1];aj=this.scene.fromDisplay((this.x1+this.x2)/2,(this.y1+this.y2)/2),this.centerX=aj[0],this.centerY=aj[1];ag=this.x1-this.x2;af=this.y1-this.y2;ae=Math.sqrt(ag*ag+af*af);this.centerDistance=ae/this.scene.zoom;return ah.consumed=true}}};ac.prototype.onPointerDrag=function(ad){if(ad.identifier===this.pointer1&&this.pointer2===null){this.scene.centerX-=ad.dx/this.scene.zoom;this.scene.centerY-=ad.dy/this.scene.zoom;this.scene.settings.interaction.zooming.autoZoom=false;ad.changes.position=true;return ad.consumed=true}else{if(ad.identifier===this.pointer1&&this.scene.settings.interaction.zooming.fingers){this.twoFingerDrag(ad.x,ad.y,this.x2,this.y2);ad.changes.position=true;return ad.consumed=true}else{if(ad.identifier===this.pointer2&&this.scene.settings.interaction.zooming.fingers){this.twoFingerDrag(this.x1,this.y1,ad.x,ad.y);ad.changes.position=true;return ad.consumed=true}}}};ac.prototype.onPointerUp=function(ad){if(this.pointer2===ad.identifier){this.pointer2=null}else{if(this.pointer1===ad.identifier){if(this.pointer2!==null){this.pointer1=this.pointer2;this.pointer2=null;this.x1=this.x2;this.y1=this.y2}else{this.pointer1=null}}}return{onPointerCancel:function(ae){return this.onPointerUp(ae)}}};ac.prototype.onDoubleClick=function(ad){var ae;ae=this.scene.settings.interaction.zooming.doubleClickZoom;if(ae){this.zoom(ae,ad.x,ad.y);ad.changes.position=true;return ad.consumed=true}};ac.prototype.twoFingerDrag=function(af,ao,ad,am){var aj,ai,ap,al,ah,ag,ae,an,ak;ae=ad-af;an=am-ao;al=Math.sqrt(ae*ae+an*an)/this.scene.zoom;aj=(ad+af)/2;ai=(am+ao)/2;ak=this.scene.fromDisplay(aj,ai),ah=ak[0],ag=ak[1];this.scene.centerX+=this.centerX-ah;this.scene.centerY+=this.centerY-ag;ap=al/this.centerDistance;this.zoom(ap,aj,ai);this.x1=af;this.y1=ao;this.x2=ad;return this.y2=am};ac.prototype.zoom=function(ak,aJ,aH){var ay,aw,aC,aB,ax,aA,aE,aD,ae,ad,ar,aq,aj,ag,av,au,aG,aF,ap,ao,an,az,ai,aI,at,am,al,ah,af;at=this.scene.getVisibleBounds(),ae=at[0],ar=at[1],ad=at[2],aq=at[3];aC=this.scene.settings.interaction.zooming.zoomExtent;ax=Math.max(aC[0],Math.min(aC[1],this.scene.zoom*ak));ak=ax/this.scene.zoom;if(aJ!==void 0&&aH!==void 0){am=this.scene.fromDisplay(aJ,aH),aE=am[0],aD=am[1]}else{if(this.scene.selection.length>0){ap=0;az=0;aB=0;al=this.scene.selection;for(ai=0,aI=al.length;ai<aI;ai++){aA=al[ai];if(aA.isNode){ap+=aA.x;az+=aA.y;aB+=1}}if(aB>0){aE=ap/aB;aD=az/aB}}}if(aE&&aD){this.scene.centerX=(this.scene.centerX-aE)/ak+aE;this.scene.centerY=(this.scene.centerY-aD)/ak+aD}else{aE=this.scene.centerX;aD=this.scene.centerY}this.scene.zoom*=ak;ah=this.scene.getGraphBounds(),aG=ah[0],ao=ah[1],aF=ah[2],an=ah[3];af=this.scene.getVisibleBounds(),aj=af[0],av=af[1],ag=af[2],au=af[3];if(aE<aG||aE>aF){if(aj>aG&&ag>aF){ay=Math.max(aF-ag,aG-aj)}else{if(ag<aF&&aj<aG){ay=Math.min(aF-ag,aG-aj)}else{ay=0}}this.scene.centerX+=ay}if(aD<ao||aD>an){if(av>ao&&au>an){aw=Math.max(an-au,ao-av)}else{if(au<an&&av<aG){aw=Math.min(an-au,ao-av)}else{aw=0}}this.scene.centerY+=aw}this.animatorX.jump(this.scene.centerX);this.animatorY.jump(this.scene.centerY);this.animatorZ.jump(this.scene.zoom);return this.scene.settings.interaction.zooming.autoZoom=false};ac.prototype.doAnimations=function(ae){var ag,aj,ap,ak,ai,aq,ah,af,ao,am,an,ad,al;if(this.resetZoom){this.resetZoom=false;return this.zoomToFit()}else{if(this.scene.settings.interaction.zooming.autoZoom){ah=ae.time;al=this.computeFitParams(),ak=al[0],ai=al[1],an=al[2];aj=0.01;ap=1+aj;ag=1-aj;ad=this.animatorZ.to/an;if(ad>ap||ad<ag){this.animatorZ.retargetColor(an)}af=this.scene.width;ao=(this.animatorX.to-ak)*an/af;if(ao>aj||ao<-aj){this.animatorX.retargetColor(ak)}aq=this.scene.height;am=(this.animatorY.to-ai)*an/aq;if(am>aj||am<-aj){this.animatorY.retargetColor(ai)}this.scene.centerX=this.animatorX.get(ah);this.scene.centerY=this.animatorY.get(ah);this.scene.zoom=this.animatorZ.get(ah);if(!(this.animatorX.finished(ah))||!(this.animatorY.finished(ah))||!(this.animatorZ.finished(ah))){return ae.animating=true}}}};ac.prototype.zoomToFit=function(){var ad;ad=this.computeFitParams(),this.scene.centerX=ad[0],this.scene.centerY=ad[1],this.scene.zoom=ad[2];this.animatorX.jump(this.scene.centerX);this.animatorY.jump(this.scene.centerY);this.animatorZ.jump(this.scene.zoom);return false};ac.prototype.computeFitParams=function(){var ag,af,ak,ai,am,ae,ad,al,aj,an,ah;ah=this.scene.getGraphBounds(),ae=ah[0],al=ah[1],ad=ah[2],aj=ah[3];if(ae===ad&&al===aj){return[0,0,1]}else{am=this.scene.width;ai=this.scene.height;ag=(ae+ad)/2;af=(al+aj)/2;an=Math.min(am/(ad-ae),ai/(aj-al))*0.9;ak=this.scene.settings.interaction.zooming.zoomExtent;an=Math.max(ak[0],Math.min(ak[1],an));return[ag,af,an]}};return ac})();var T,aa,r,ab={}.hasOwnProperty,G=[].slice;if(typeof String.prototype.trim==="undefined"){String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}r=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;if(!r){aa=0;r=function(af){var ac,ae,ad;ac=new Date().getTime();ad=Math.max(0,16-(ac-aa));ae=window.setTimeout(function(){return af(ac+ad)},ad);aa=ac+ad;return ae}}window.requestAnimationFrame=r;T=(function(){function ac(){}ac.prototype.baseCSSClass="DWSL";ac.extend=function(ae,ad){var af,ag;if(ae==null){return{}}for(af in ad){if(!ab.call(ad,af)){continue}ag=ad[af];ae[af]=ag}return ae};ac.extendDeep=function(ae,ad){var af,ah,ag;if(ae==null){return ad}for(af in ad){if(!ab.call(ad,af)){continue}ah=ad[af];ag=ae[af];if(ac.isObject(ag)&&ac.isObject(ah)){this.extendDeep(ag,ah)}else{ae[af]=ah}}return ae};ac.configure=function(ae,af){var ad;for(ad in af){if(typeof ae[ad]==="undefined"&&af[ad]){ae[ad]=af[ad]}}return ae};ac.clone=function(af){var ad,ae,ag;ae={};for(ad in af){if(!ab.call(af,ad)){continue}ag=af[ad];ae[ad]=ag}return ae};ac.isArray=function(ad){return ad instanceof Array};ac.isObject=function(ad){return ad!==null&&typeof ad==="object"};ac.isFunction=function(ad){return typeof ad==="function"};ac.isNumber=function(ad){return !isNaN(parseFloat(ad))&&isFinite(ad)};ac.isString=function(ad){return Object.prototype.toString.call(ad)==="[object String]"};ac.hasProperties=function(af){var ae,ad;if(!af){return false}for(ae in af){if(!ab.call(af,ae)){continue}ad=af[ae];return true}return false};ac.removeProperty=function(af){var ae,ad;for(ae in af){if(!ab.call(af,ae)){continue}ad=af[ae];delete af[ae];return ae}return null};ac.removePropertyValue=function(af){var ae,ad;for(ae in af){if(!ab.call(af,ae)){continue}ad=af[ae];delete af[ae];return[ae,ad]}return null};ac.countProperties=function(af){var ag,ae,ad;ag=0;for(ae in af){if(!ab.call(af,ae)){continue}ad=af[ae];ag+=1}return ag};ac.realClone=function(ai){var ae,ak,ag,aj,af,ah,ad;aj=this.isObject(ai);ae=this.isArray(ai);if(ae){ak=[];for(ag=ah=0,ad=ai.length;ah<ad;ag=++ah){af=ai[ag];if(typeof af!=="function"){ak[ag]=this.realClone(af)}else{ak[ag]=af}}}else{if(aj){ak={};for(ag in ai){af=ai[ag];if(typeof af!=="function"){ak[ag]=this.realClone(af)}else{ak[ag]=af}}}else{ak=ai}}return ak};ac.arrayContains=function(ad,ag){var af,ah,ae;for(ah=0,ae=ad.length;ah<ae;ah++){af=ad[ah];if(af===ag){return true}}return false};ac.removeFromArray=function(ad,ag){var af,ah,ae;ah=false;for(af in ad){ae=ad[af];if(ae===ag){ad.splice(af,1);ah=true}}return ah};ac.arraysEqual=function(ae,ad){var af,ah,ag;if(!((ae!=null)&&(ad!=null))){return false}if(ae.length!==ad.length){return false}for(af=ah=0,ag=ae.length-1;ah<=ag;af=ah+=1){if(ae[af]!==ad[af]){return false}}return true};ac.log=function(ae,ad){if(typeof console!=="undefined"&&console!==null){if(ad!=null){return console.info(ae,ad)}else{return console.info(ae)}}};ac.error=function(ae,ad){if(typeof console!=="undefined"&&console!==null){if(ad!=null){return console.error(ae,ad)}else{return console.error(ae)}}};ac.getExtension=function(ad){var ae;ae=/(?:\.([^.]+))?$/;return ae.exec(ad)[1]};ac.createDom=function(ag,ae,af,ad){var ah;ah=document.createElement(ag);if(ae!=null){ah.className=ae}if(af!=null){ah.innerHTML=af}if(ad!=null){ad.appendChild(ah)}return ah};ac.createStyledDom=function(ah,aj,ag,ad){var ai,af,ae;ai=document.createElement(ah);if(aj!=null){for(af in aj){if(!ab.call(aj,af)){continue}ae=aj[af];ai.style[af]=ae}}if(ag!=null){ai.innerHTML=ag}if(ad!=null){ad.appendChild(ai)}return ai};ac.hasClass=function(ae,ad){return(ae.className.length>0)&&new RegExp("(^|\\s)"+ad+"(\\s|$)").test(ae.className)};ac.addClass=function(ae,ad){if(!ac.hasClass(ae,ad)){if(ae.className.length===0){return ae.className=ad}else{return ae.className=ae.className+" "+ad}}};ac.removeClass=function(af,ad){var ae;ae=function(ag,ah){if(ah===ad){return""}else{return ag}};return af.className=af.className.replace(/(\S+)\s*/g,ae).replace(/(^\s+|\s+$)/,"")};ac.setClass=function(ae,ad){return ae.className=ad};ac.listen=function(af,ae,ad){if(af.addEventListener){return af.addEventListener(ae,ad)}else{return af.attachEvent("on"+ae,ad)}};ac.unlisten=function(af,ae,ad){if(af.removeEventListener){return af.removeEventListener(ae,ad)}else{return af.detachEvent("on"+ae,ad)}};ac.createEvent=function(ad){var ae;if(document.createEvent){ae=document.createEvent("Event");ae.initEvent(ad,true,true)}else{ae=document.createEventObject()}return ae};ac.canvasScaling=function(){var ad;ad=1;if(window.devicePixelRatio){ad=window.devicePixelRatio}else{if(window.screen.systemXDPI){ad=window.screen.systemXDPI/window.screen.logicalXDPI}}return[ad,ad]};ac.elementPos=function(af){var ae,ad;ae=0;ad=0;while(af.offsetParent!=null){ae+=af.offsetLeft;ad+=af.offsetTop;af=af.offsetParent}return[ae,ad]};ac.isParentOf=function(ad,ae){while(ae!=null){if(ae===ad){return true}ae=ae.parentElement}return false};ac.fadeIn=function(ad){return ad.style.display="block"};ac.fadeOut=function(ad){return ad.style.display="none"};ac.hide=function(ad){return ad.style.display="none"};ac.show=function(ad){return ad.style.display="block"};ac.wrapClass=function(ag,aj){var ah,ad,ai,af,ae;if(!this.baseCSSClass){this.baseCSSClass="DVSL"}if(!ag){ag=this.baseCSSClass}if(typeof ag==="object"){if(ag.objClass){ag=ag.objClass}else{ag=this.baseCSSClass}}ad=aj.split(",");ah="";for(af=0,ae=ad.length;af<ae;af++){ai=ad[af];if(ah){ah+=" "}ah+=ag+"-"+ai}return ah};ac.getProp=function(ai,ae){var af,ah,ad,ag;ag=ae.split("/");for(ah=0,ad=ag.length;ah<ad;ah++){af=ag[ah];if(ai.hasOwnProperty(af)){ai=ai[af]}else{return void 0}}return ai};ac.hasProp=function(ai,ae){var af,ah,ad,ag;ag=ae.split("/");for(ah=0,ad=ag.length;ah<ad;ah++){af=ag[ah];if(ai.hasOwnProperty(af)){ai=ai[af]}else{return false}}return ai!==void 0};ac.getScroll=function(){var ad,ag,af,ae;ag=document.documentElement;ad=document.body;af=ag&&ag.scrollLeft||ad&&ad.scrollLeft||0;ae=ag&&ag.scrollTop||ad&&ad.scrollTop||0;return[af,ae]};ac.isWithIn=function(ad,ae){if(ad[0]<ae[0]||ad[0]>ae[2]||ad[1]<ae[1]||ad[1]>ae[3]){return true}else{return false}};ac.mixIn=function(ah,ai){var af,ae,ag,ad;ag=ai.prototype;ad=[];for(af in ag){ae=ag[af];ad.push(ah[af]=ae)}return ad};ac.sign=function(ad){if(!ad){return 0}if(ad<0){return -1}return 1};ac.each=function(){var aj,af,al,ad,ai,am,ag,ak,ah,ae;al=arguments[0],ad=arguments[1],aj=3<=arguments.length?G.call(arguments,2):[];ai=[];if(ac.isArray(this[al])){ah=this[al];for(ag=0,ak=ah.length;ag<ak;ag++){am=ah[ag];if(am[ad]!=null){ai.push(am[ad].apply(am,aj))}else{console.error(am);throw"Object "+am+"does not have method: "+ad}}}else{if(ac.isObject(this[al])){ae=this[al];for(af in ae){am=ae[af];if(am[ad]!=null){ai.push(am[ad].apply(am,aj))}else{console.error(am);throw"Object "+am+"does not have method "+ad}}}else{console.error(al,ad,aj);throw"Called iterator each on non-object/non-array"}}return ai};ac.detectBrowser=function(){var ad,ag,ae,af;ag=navigator.appName;af=navigator.userAgent;ad=af.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(ad&&(ae=af.match(/version\/([\.\d]+)/i))!==null){ad[2]=ae[1]}if(ad){ad=[ad[1],ad[2]]}else{ad=[ag,navigator.appVersion,"-?"]}return ad[0].toLowerCase()};ac.nextIdentifier=0;ac.getIdentifier=function(){return ac.nextIdentifier++};ac.doRequest=function(ad,ah,am,ag){var af,ae,ak,ai,al,aj=this;af=[];for(ai=0,al=ah.length;ai<al;ai++){ae=ah[ai];af.push(""+(encodeURIComponent(ae[0]))+"="+(encodeURIComponent(ae[1])))}af=af.join("&");if(ad.indexOf("?")!==-1){ad+="&"+af}else{ad+="?"+af}if(window.XMLHttpRequest){ak=new XMLHttpRequest()}else{if(window.ActiveXObject){ak=new ActiveXObject("Microsoft.XMLHTTP")}}if(ak){ak.onreadystatechange=function(){if(ak.readyState===4){if(ak.status===200){return am(ak.responseText)}else{return ag()}}};ak.open("GET",ad,true);return ak.send("")}};ac.openUrl=function(ad){if(ac.isString(ad)){return window.open(ad)}else{return window.open(ad.url,ad.name,ad.specs,ad.replace)}};ac.parseData=function(ai,ag,ae){var af,ad;af=null;if(ag==="JSON"){if(typeof ai==="string"||ai instanceof String){try{af=JSON.parse(ai)}catch(ah){ad=ah;ae.error("Error: failed to parse JSON response: "+ad+": "+ai);af={error:"Error: failed to parse JSON response"}}}else{af=ai}}else{ae.error("Unsupported data format: "+ag)}return af};ac.numberFormat=function(aj,ah,ae,ai){var ag,af,ad;aj=parseFloat(aj);ah=isNaN(ah=Math.abs(ah))?2:ah;ae=ae===void 0?".":ae;ai=ai===void 0?" ":ai;ad=aj<0?"-":"";ag=parseInt(aj=Math.abs(+aj||0).toFixed(ah))+"";af=(af=ag.length)>3?af%3:0;return ad+(af?ag.substr(0,af)+ai:"")+ag.substr(af).replace(/(\d{3})(?=\d)/g,"$1"+ai)+(ah?ae+Math.abs(aj-ag).toFixed(ah).slice(2):"")};return ac})();var E;E=(function(){ac.prototype.chartWidth=1;ac.prototype.chartHeight=1;ac.prototype.toolbarHeight=0;ac.prototype.x0=0;ac.prototype.y0=0;ac.prototype.height=100;ac.prototype.width=100;ac.prototype.leftMargin=0;ac.prototype.rightMargin=0;ac.prototype.topMargin=0;ac.prototype.bottomMargin=0;ac.prototype.canvasScaleX=1;ac.prototype.canvasScaleY=1;ac.prototype.settings=null;ac.prototype.loading=true;function ac(){this.messages={};this.backStack=[]}ac.prototype.getChartBounds=function(){return{left:this.x0-this.leftMargin,top:this.y0-this.topMargin,right:this.x0+this.width+this.rightMargin,bottom:this.y0+this.height+this.bottomMargin}};ac.prototype.setMessage=function(ad,ag,ae){var af;if(ag!=null){af=(this.messages[ad]==null)||this.messages[ad].msg!==ag||this.messages[ad].pri!==ae;this.messages[ad]={msg:ag,pri:ae}}else{af=this.messages[ad]!=null;delete this.messages[ad]}return af};ac.prototype.getMessage=function(){var ae,ad,ah,af,ag;ad=null;af=0;ag=this.messages;for(ae in ag){ah=ag[ae];if(ah.pri>af){ad=ah.msg;af=ah.pri}}return ad};ac.prototype.pushBack=function(ad){this.backStack.push(ad);if(this.backStack.length>1000){return this.backStack=this.backStack.slice(200)}};return ac})();var m,t,q,j=function(ac,ad){return function(){return ac.apply(ad,arguments)}},ab={}.hasOwnProperty;m=(function(){ac.prototype.time=0;ac.prototype.changes={};ac.prototype.consumed=false;ac.prototype.defaultPrevented=false;ac.prototype.preventDefault=function(){return this.defaultPrevented=true};ac.prototype.x=0;ac.prototype.y=0;ac.prototype.dx=0;ac.prototype.dy=0;ac.prototype.vx=0;ac.prototype.vy=0;ac.prototype.wheely=0;ac.prototype.wheelx=0;ac.prototype.identifier=0;ac.prototype.pressed=false;ac.prototype.consumed=false;ac.prototype.touch=false;ac.prototype.swipeUp=false;ac.prototype.swipeDown=false;ac.prototype.swipeLeft=false;ac.prototype.swipeRight=false;function ac(ad,ag,af,ae){this.x=ad;this.y=ag;this.time=af;this.identifier=ae;1}ac.prototype.distance=function(ad){return Math.sqrt((ad.x-this.x)*(ad.x-this.x)+(ad.y-this.y)*(ad.y-this.y))};return ac})();q=(function(){function ac(ae,ad){this.settings=ad;this.identifier=ae.identifier;this.x=ae.x;this.y=ae.y;this.pageX=ae.pageX;this.pageY=ae.pageY;this.time=ae.time;this.pts=[[this.x,this.y,this.time]]}ac.prototype.moveTo=function(ad){if(ad.time===this.time){this.pts.pop()}this.time=ad.time;if(ad.x||ad.y){this.x=ad.x;this.y=ad.y}this.pts.push([this.x,this.y,this.time]);if(this.pts.length>6){return this.pts.unshift()}};ac.prototype.getPosAndSpeed=function(al,ad){var ae,ap,ak,aj,ao,ai,an,am,ah,ag,af;al.x=this.x;al.y=this.y;ao=this.pts.length-2;if(ao>=0){al.dx=this.pts[ao+1][0]-this.pts[ao][0];al.dy=this.pts[ao+1][1]-this.pts[ao][1]}else{al.dx=0;al.dy=0}ai=Infinity;for(aj=ah=0;ah<=ao;aj=ah+=1){ae=this.pts[aj+1][2]-this.pts[aj][2];ai=Math.min(ai,this.pts[aj+1][2]-this.pts[aj][2])}ai=Math.max(ai,20);ak=-1;for(aj=ag=ao;ag>=0;aj=ag+=-1){ae=this.pts[aj+1][2]-this.pts[aj][2];if(ae>ai*2){break}ak=aj}if(ak===-1){al.vx=0;al.vy=0;return}an=0;am=0;ap=1;for(aj=af=ak;af<=ao;aj=af+=1){ae=this.pts[aj+1][2]-this.pts[aj][2];an=an*(1-ap)+(this.pts[aj+1][0]-this.pts[aj][0])/ae*ap;am=an*(1-ap)+(this.pts[aj+1][1]-this.pts[aj][1])/ae*ap;ap=0.6}al.vx=an*1000;return al.vy=am*1000};return ac})();t=(function(){ac.prototype.ID_MOUSE="mouse";ac.prototype.EVENT_MOVE="move";ac.prototype.EVENT_DOWN="down";ac.prototype.EVENT_DRAG="drag";ac.prototype.EVENT_CANCEL="cancel";ac.prototype.EVENT_UP="up";ac.prototype.EVENT_LEAVE="leave";ac.prototype.EVENT_CLICK="click";ac.prototype.EVENT_RCLICK="rclick";ac.prototype.EVENT_DBLCLICK="dblclick";ac.prototype.EVENT_WHEEL="mwheel";ac.prototype.scaleX=1;ac.prototype.scaleY=1;ac.prototype.hasTouch=false;ac.prototype.mm=1;ac.prototype.clickEvent=null;ac.prototype.longPressTimeout=null;ac.prototype.cachedContainerPosition=null;function ac(ad,ae){this.container=ad;this.settings=ae;this.handleTouchMove=j(this.handleTouchMove,this);this.handleTouchCancel=j(this.handleTouchCancel,this);this.handleTouchEnd=j(this.handleTouchEnd,this);this.handleTouchStart=j(this.handleTouchStart,this);this.handleMouseMove=j(this.handleMouseMove,this);this.handleMouseUp=j(this.handleMouseUp,this);this.handleMouseWheel=j(this.handleMouseWheel,this);this.handleCMenu=j(this.handleCMenu,this);this.handleMouseDown=j(this.handleMouseDown,this);this.updateContainerPosition=j(this.updateContainerPosition,this);this.listeners={};this.downPointers={};this.inPointers={};this.whiteList=[this.container];T.listen(this.container,"mousedown",this.handleMouseDown);T.listen(this.container,"contextmenu",this.handleCMenu);T.listen(this.container,"mousewheel",this.handleMouseWheel);T.listen(this.container,"DOMMouseScroll",this.handleMouseWheel);T.listen(this.container,"touchstart",this.handleTouchStart);T.listen(window,"mouseup",this.handleMouseUp);T.listen(window,"mousemove",this.handleMouseMove);T.listen(window,"touchend",this.handleTouchEnd);T.listen(window,"touchcancel",this.handleTouchCancel);T.listen(window,"touchmove",this.handleTouchMove);T.listen(window,"resize",this.updateContainerPosition)}ac.prototype.addWhiteList=function(ad){this.whiteList.push(ad);T.listen(ad,"mousedown",this.handleMouseDown);T.listen(ad,"mousewheel",this.handleMouseWheel);T.listen(ad,"DOMMouseScroll",this.handleMouseWheel);return T.listen(ad,"touchstart",this.handleTouchStart)};ac.prototype.remove=function(){var af,ae,ah,ad,ag;T.unlisten(this.container,"mousedown",this.handleMouseDown);T.unlisten(this.container,"contextmenu",this.handleCMenu);T.unlisten(this.container,"mousewheel",this.handleMouseWheel);T.unlisten(this.container,"DOMMouseScroll",this.handleMouseWheel);T.unlisten(this.container,"touchstart",this.handleTouchStart);if(this.whiteList!=null){ag=this.whiteList;for(af=ah=0,ad=ag.length;ah<ad;af=++ah){ae=ag[af];T.unlisten(ae,"mousedown",this.handleMouseDown);T.unlisten(ae,"mousewheel",this.handleMouseWheel);T.unlisten(ae,"DOMMouseScroll",this.handleMouseWheel);T.unlisten(ae,"touchstart",this.handleTouchStart)}}T.unlisten(window,"mouseup",this.handleMouseUp);T.unlisten(window,"mousemove",this.handleMouseMove);T.unlisten(window,"touchend",this.handleTouchEnd);T.unlisten(window,"touchcancel",this.handleTouchCancel);return T.unlisten(window,"touchmove",this.handleTouchMove)};ac.prototype.listen=function(ad,ae){return this.listeners[ad]=ae};ac.prototype.getContainerPosition=function(){if(this.cachedContainerPosition!=null){return this.cachedContainerPosition}else{return this.updateContainerPosition()}};ac.prototype.updateContainerPosition=function(){this.cachedContainerPosition=T.elementPos(this.container);return this.cachedContainerPosition};ac.prototype.handleMouseDown=function(ad){var ae;if(this.hasTouch){return}ae=this.buildEvent(ad,this.ID_MOUSE,ad.timeStamp,true);this.downHappened(ae,false);if(ae.consumed){return ad.preventDefault()}};ac.prototype.handleCMenu=function(ae){var ah,ai,ad,ag,af;if(ae.which){ai=ae.which===3}else{ai=ae.button===2}if(ai){ah=this.buildEvent(ae,this.ID_MOUSE,ae.timeStamp,true);af=this.downPointers;for(ad in af){if(!ab.call(af,ad)){continue}ag=af[ad];ah=this.rebuildEvent(ae,ag,false);this.cancelHappened(ah)}this.rclickHappened(ah);if(ah.consumed){return ae.preventDefault()}}};ac.prototype.handleMouseWheel=function(ad){var ae;ae=this.buildEvent(ad,this.ID_MOUSE,ad.timeStamp,true);ae.wheely=ad.wheelDelta|(ad.detail*-40);this.wheelHappened(ae);if(ae.consumed){return ad.preventDefault()}};ac.prototype.handleMouseUp=function(ae){var af,ad;if(this.hasTouch){return}if(ae.shiftKey&&ae.ctrlKey){this.ID_MOUSE="mouse"+this.mm;this.mm+=1;return}else{ad=true}af=this.buildEvent(ae,this.ID_MOUSE,ae.timeStamp,false);af.isRightMB=ae.witch?ae.which===3:ae.button===2;this.upHappened(af);if(af.consumed){ae.preventDefault()}if(ad){return this.removeLostTouches(ae,[],[])}};ac.prototype.handleMouseMove=function(ad){var ae;if(this.hasTouch){return}ae=this.buildEvent(ad,this.ID_MOUSE,ad.timeStamp,false);this.moveHappened(ae);if(ae.consumed){return ad.preventDefault()}};ac.prototype.handleTouchStart=function(af){var ai,aj,ah,ae,ag,ad;if(!this.isTargetOkay(af.target)){return}this.hasTouch=true;this.removeLostTouches(af,af.touches,af.changedTouches);ai=false;ah=af.changedTouches||af.touches;for(ag=0,ad=ah.length;ag<ad;ag++){ae=ah[ag];aj=this.buildEvent(ae,ae.identifier,af.timeStamp,true);this.downHappened(aj,true);ai||(ai=aj.consumed)}if(ai){return af.preventDefault()}};ac.prototype.handleTouchEnd=function(af){var ai,aj,ah,ae,ag,ad;ah=af.changedTouches||af.touches;ai=false;for(ag=0,ad=ah.length;ag<ad;ag++){ae=ah[ag];aj=this.buildEvent(ae,ae.identifier,af.timeStamp,false);this.upHappened(aj);this.pointerLeave(aj);ai||(ai=aj.consumed);this.removeLostTouches(af,af.touches)}if(ai){return af.preventDefault()}};ac.prototype.handleTouchCancel=function(af){var ai,ah,ae,ag,ad;ah=af.changedTouches||af.touches;for(ag=0,ad=ah.length;ag<ad;ag++){ae=ah[ag];ai=this.buildEvent(ae,ae.identifier,af.timeStamp,false);this.cancelHappened(ai)}return this.removeLostTouches(af,af.touches)};ac.prototype.handleTouchMove=function(af){var ai,aj,ah,ae,ag,ad;ai=false;this.removeLostTouches(af,af.touches);ah=af.changedTouches||af.touches;for(ag=0,ad=ah.length;ag<ad;ag++){ae=ah[ag];aj=this.buildEvent(ae,ae.identifier,af.timeStamp,true);this.moveHappened(aj);ai||(ai=aj.consumed)}if(ai){return af.preventDefault()}};ac.prototype.removeLostTouches=function(ad,am,ag){var an,aj,af,ap,aq,ak,ai,ao,ae,al,ah;ap=[];for(ak=0,ao=am.length;ak<ao;ak++){aq=am[ak];ap[aq.identifier]=true}al=this.downPointers;for(aj in al){if(!ab.call(al,aj)){continue}af=al[aj];if(!ap[aj]){an=this.rebuildEvent(ad,af,false);this.upHappened(an)}}if(ag!=null){ah=[];for(ai=0,ae=ag.length;ai<ae;ai++){aq=ag[ai];af=this.downPointers[aq.identifier];if(af!=null){console.log("Removing fresh touch "+aq.identifier);an=this.rebuildEvent(ad,af,false);ah.push(this.upHappened(an))}else{ah.push(void 0)}}return ah}};ac.prototype.rebuildEvent=function(ad,ag,ae){var af;af=new m(ag.x,ag.y,ad.timeStamp,ag.identifier);af.pageX=ag.pageX;af.pageY=ag.pageY;af.pressed=ae;af.shiftKey=ad.shiftKey;af.altKey=ad.altKey;af.ctrlKey=ad.ctrlKey;af.touch=this.hasTouch;return af};ac.prototype.buildEvent=function(ad,ae,ai,af){var am,al,ah,ak,aj,ag;ag=this.getContainerPosition(),am=ag[0],al=ag[1];ak=ad.pageX-am;aj=ad.pageY-al;ah=new m(Math.round(ak*this.scaleX),Math.round(aj*this.scaleY),ai,ae);ah.target=ad.target;ah.touch=this.hasTouch;ah.pageX=ad.pageX;ah.pageY=ad.pageY;ah.shiftKey=ad.shiftKey;ah.altKey=ad.altKey;ah.ctrlKey=ad.ctrlKey;ah.pressed=af;return ah};ac.prototype.downHappened=function(af,ad){var ae;if(!this.isTargetOkay(af.target)){return}af.pressed=true;if(this.downPointers[af.identifier]!=null){console.log("Unexpected down on already down pointer");return}this.downPointers[af.identifier]=ae=new q(af,this.settings);ae.touch=ad;this.inPointers[af.identifier]=true;this.fireEvent(this.EVENT_DOWN,af);if(ad){return this.startLongPress(af)}};ac.prototype.upHappened=function(af){var ad,ae,ag=this;this.cachedContainerPosition=null;if(this.downPointers[af.identifier]==null){return false}ae=this.downPointers[af.identifier];this.cancelLongPress(af);ae.moveTo(af);ae.getPosAndSpeed(af,true);delete this.downPointers[af.identifier];if(Math.abs(af.vx)>Math.abs(af.vy)*2){af.swipeSpeed=Math.abs(af.vx);if(af.vx>0){af.swipeLeft=true}if(af.vx<0){af.swipeRight=true}}else{if(Math.abs(af.vy)>Math.abs(af.vx)*2){af.swipeSpeed=Math.abs(af.vy);if(af.vy<0){af.swipeUp=true}if(af.vy>0){af.swipeDown=true}}}this.fireEvent(this.EVENT_UP,af);if(!(ae.scrolling||af.isRightMB||ae.rightClicked)){if((this.clickEvent!=null)&&this.clickEvent.time+this.settings.doubleClickTimeout>=af.time&&this.clickEvent.distance(af)<this.settings.doubleClickSensitivity){this.clickEvent=null;return this.fireEvent(this.EVENT_DBLCLICK,af)}else{if(this.settings.noClickOnDoubleClick){this.clickEvent=af;ad=function(){if(ag.clickEvent===af){ag.fireEvent(ag.EVENT_CLICK,ag.clickEvent);return ag.clickEvent=null}};return setTimeout(ad,this.settings.doubleClickTimeout)}else{this.fireEvent(this.EVENT_CLICK,af);return this.clickEvent=af}}}};ac.prototype.cancelHappened=function(ae){var ad;this.cachedContainerPosition=null;if(this.downPointers[ae.identifier]==null){return}this.cancelLongPress(ae);ad=this.downPointers[ae.identifier];delete this.downPointers[ae.identifier];return this.fireEvent(this.EVENT_CANCEL,ae)};ac.prototype.moveHappened=function(ae){var ad;ad=this.downPointers[ae.identifier];ae.pressed=ad!=null;if(ad!=null){if(ae.distance(ad)>=this.settings.dragSensitivity||ad.scrolling){this.cancelLongPress(ae);ad.scrolling=true;ad.moveTo(ae);ad.getPosAndSpeed(ae,false);return this.fireEvent(this.EVENT_DRAG,ae)}}else{if(this.clickEvent&&this.settings.noClickOnDoubleClick){if(this.clickEvent.distance(ae)>this.settings.doubleClickSensitivity){this.fireEvent(this.EVENT_CLICK,this.clickEvent);return this.clickEvent=null}}else{if(this.isTargetOkay(ae.target)){this.inPointers[ae.identifier]=true;return this.fireEvent(this.EVENT_MOVE,ae)}else{return this.pointerLeave(ae)}}}};ac.prototype.pointerLeave=function(ad){if(this.inPointers.hasOwnProperty(ad.identifier)){delete this.inPointers[ad.identifier];return this.fireEvent(this.EVENT_LEAVE,ad)}};ac.prototype.startLongPress=function(ae){var ad,af=this;ad=function(){ae.consumed=false;af.fireEvent(af.EVENT_RCLICK,ae);if(ae.consumed){return af.downPointers[ae.identifier].rightClicked=true}};this.cancelLongPress();return this.longPressTimeout=setTimeout(ad,this.settings.longPressTimeout)};ac.prototype.cancelLongPress=function(){if(this.longPressTimeout!==null){clearTimeout(this.longPressTimeout);return this.longPressTimeout=null}};ac.prototype.wheelHappened=function(ad){return this.fireEvent(this.EVENT_WHEEL,ad)};ac.prototype.rclickHappened=function(ad){return this.fireEvent(this.EVENT_RCLICK,ad)};ac.prototype.fireEvent=function(ad,ae){if(this.listeners[ad]){return this.listeners[ad].call(this,ae)}};ac.prototype.isTargetOkay=function(ai){var af,ae,ah,ad,ag;ag=this.whiteList;for(af=ah=0,ad=ag.length;ah<ad;af=++ah){ae=ag[af];if((ae===ai)||T.isParentOf(ae,ai)){return true}}return false};return ac})();var I;I=(function(){ac.defaults={container:null,width:null,height:null,minHeight:165,maxHeight:2000,minWidth:100,maxWidth:4000,theme:null,assetsUrlBase:"",area:{style:{fillColor:"transparent"}},advanced:{highDpi:{"default":true,safari:false,firefox:true,msie:true,chrome:false},pointer:{noClickOnDoubleClick:true,dragSensitivity:10,doubleClickSensitivity:40,doubleClickTimeout:300,longPressTimeout:500,speedAveragingPeriod:200},trackTouches:false,logging:false,style:{messageTextStyle:{fillColor:"#000",font:"15px Arial"},loadingArcStyle:{r:35,lineColor:"#444",lineWidth:2}},maxCanvasWidth:2047,maxCanvasHeight:2047,themeCSSClass:"DVSL-round",assets_applyMethod:"merge",assets:["base.css"],builtinAssets:{"builtin-logo":N},exportProxyURL:"http://developers.dvsl.co/export"},interaction:{resizing:{enabled:true,advanced:{resizerHandleVisibilityTolerance:45,resizerHandleEnableTolerance:10}}},events:{onError:null,onSettingsChange:null,onClick:null,onDoubleClick:null,onRightClick:null,onHoverChanged:null,onSelectionChange:null,onChartUpdate:null,onAnimationDone:null,chartUpdateDelay:0},title:{enabled:true,enabledOnExport:true,align:"center",margin:25,style:{font:"20px Arial",fillColor:"#000"},text:""},credits:{enabled:false,enabledOnExport:true,href:"http://dvsl.co",image:"builtin-logo"}};function ac(aj){var af,ak,ai,ag,ad,ae,ah;this._imageCache={};this.apply(ac.defaults);ag=new RegExp("((file:///|https?://)[^/]+/.*?)/?"+aj+"(-dev|.min|).js");ad=new RegExp("((file:///|https?://)[^/]+/.*/src)/?"+aj);ah=document.getElementsByTagName("script");for(af in ah){ae=ah[af];if(ae.src&&(ak=ae.src.match(ag))){if(ak[1][ak[1].length-1]==="/"){ai=""}else{ai="/"}this.assetsUrlBase=ak[1]+ai+"assets/"}if(ae.src&&(ak=ae.src.match(ad))){if(ak[1][ak[1].length-1]==="/"){ai=""}else{ai="/"}this.assetsUrlBase=ak[1]+ai+"assets/"}}}ac.prototype.apply=function(ae){var ad,af;if(ae==null){return}ad={};af=null;if(ae.theme!=null){af=ae.theme;delete ae.theme}if(af){this.applyRec(this,af,ad,0);ae.theme=af}this.applyRec(this,ae,ad,0);return ad};ac.prototype.applyRec=function(at,ar,ao,au){var aq,an,av,ag,ai,am,ae,ah,ak,af,al,aj,ad,ap;if(au>10){throw"Stack depth greater than 10, seems like recursive settings"}if(at===void 0){console.error(au,at,ar);throw"Tried to applyRec on undefined"}for(av in ar){al=ar[av];ah=at[av];if(ah!==void 0&&al===ah){continue}aq=T.isArray(al);ai=T.isObject(al);am=T.isArray(ah);ae=T.isObject(ah);an=T.isFunction(al);ak=false;if(am&&!aq){console.error("Applying settings: Setting expected to be array but got something else: "+av+" = "+al);ak=true}if(al!==null&&ae&&!ai&&!an){console.error("Applying settings: Setting expected to be object but got something else: "+av+" = "+al);ak=true}if(ak){continue}if(ai){if(!(ah!=null)){if(aq){at[av]=[];ao[av]=[];ae=true}else{at[av]={};ao[av]={};ae=true}}if(al===null||al===void 0){at[av]=al;ao[av]=al}if(ai&&!ae){at[av]={};ao[av]={}}if(av==="container"){at[av]=al;ao[av]=al}else{if(aq){ag=av+"_applyMethod";if(ar[ag]==="merge"||at[ag]==="merge"){af=at[av];for(ad=0,ap=al.length;ad<ap;ad++){aj=al[ad];if(!T.arrayContains(af,aj)){af.push(aj)}}}else{at[av]=al}ao[av]=al}else{if(!ao.hasOwnProperty(av)){ao[av]={}}this.applyRec(at[av],al,ao[av],au+1)}}}else{if(al===void 0){delete at[av];ao[av]=al}else{at[av]=al;ao[av]=al}}}return 1};ac.prototype.applyById=function(ak,an,ai){var al,ad,ao,af,aj,ah,am,ae,ag;ag=[];for(aj=0,am=an.length;aj<am;aj++){al=an[aj];ao=false;if(al.id){for(ah=0,ae=ak.length;ah<ae;ah++){af=ak[ah];if(af.id===al.id){ad={};this.applyRec(af,al,ad,0);ai.push(ad);ao=true;break}}}if(!ao){ak.push(al);ag.push(ai.push(al))}else{ag.push(void 0)}}return ag};ac.prototype.getAssetUrl=function(ad){if(this.advanced.builtinAssets.hasOwnProperty(ad)){return this.advanced.builtinAssets[ad]}if(!((this.assetsUrlBase!=null)&&this.assetsUrlBase.length>0)){return ad}if(ad.indexOf("://")!==-1){return ad}if(ad[0]==="/"||ad.indexOf("./")===0){return ad}if(this.assetsUrlBase[this.assetsUrlBase.length-1]!=="/"){return this.assetsUrlBase+"/"+ad}else{return this.assetsUrlBase+ad}};ac.prototype.getAssetImage=function(ae){var af,ad;if(this._imageCache.hasOwnProperty(ae)){return this._imageCache[ae]}ad=this.getAssetUrl(ae);if(!ad){return null}af=this._imageCache[ae]=new Image();af.src=ad;if(af.width>0){return af}else{return null}};return ac})();var z,v,Q,R,ab={}.hasOwnProperty,n=function(af,ad){for(var ac in ad){if(ab.call(ad,ac)){af[ac]=ad[ac]}}function ae(){this.constructor=af}ae.prototype=ad.prototype;af.prototype=new ae();af.__super__=ad.prototype;return af};z=(function(){function ac(){}ac.prototype.image=null;ac.prototype.title=null;ac.prototype.onclick=null;return ac})();Q=(function(){ac.prototype.id="";ac.prototype.x=0;ac.prototype.y=0;ac.prototype.isNode=true;ac.prototype.isLink=false;ac.prototype.removed=false;ac.prototype.added=false;ac.prototype.data=null;ac.prototype.loading=false;ac.prototype.links=null;ac.prototype.dataLinks=null;ac.prototype.userLock=false;ac.prototype.expanded=false;ac.prototype.focused=false;ac.prototype.fillColor=null;ac.prototype.lineColor=null;ac.prototype.lineWidth=1;ac.prototype.image=null;ac.prototype.imageSlicing=null;ac.prototype.tintImage=false;ac.prototype.radius=10;ac.prototype.hwidth=null;ac.prototype.label=null;ac.prototype.labelStyle=null;ac.prototype.labelBackground=null;ac.prototype.labelLocation=null;ac.prototype.icons=null;ac.prototype.hilight=null;ac.prototype.locks=0;ac.prototype.currentRadius=0;ac.prototype.currentHwidth=0;function ac(ad){this.id=ad;this.links=[]}return ac})();v=(function(){function ac(){}ac.prototype.from=null;ac.prototype.to=null;ac.prototype.removed=false;ac.prototype.isNode=false;ac.prototype.isLink=true;ac.prototype.data=null;ac.prototype.multiId=null;ac.prototype.radius=1;ac.prototype.length=1;ac.prototype.strength=1;ac.prototype.label=null;ac.prototype.labelStyle=null;ac.prototype.labelBackground=null;ac.prototype.dashed=false;ac.prototype.currentRadius=0;ac.prototype.direction=null;ac.prototype.fromDecoration=null;ac.prototype.toDecoration=null;ac.prototype.fromIcons=null;ac.prototype.toIcons=null;ac.prototype.highlight=null;ac.prototype.toPieValue=0;ac.prototype.toPieColor=null;ac.prototype.toPie0=null;ac.prototype.toPie1=null;ac.prototype.otherEnd=function(ad){if(ad===this.from){return this.to}if(ad===this.to){return this.from}return null};ac.prototype.commonNode=function(ad){if(this.from===ad.from||this.from===ad.to){return this.from}if(this.to===ad.from||this.to===ad.to){return this.to}return null};return ac})();R=(function(ad){n(ac,ad);ac.prototype.settings=null;ac.prototype.nodes=[];ac.prototype.links=[];ac.prototype.idToNode={};ac.prototype.idToLink={};ac.prototype.selection=[];ac.prototype.userNodeIds={};ac.prototype.positionedNodeIds={};ac.prototype.hoverNode=null;ac.prototype.hoverLink=null;ac.prototype.newNodes={};ac.prototype.newLinks={};ac.prototype.modifiedNodes={};ac.prototype.modifiedLinks={};ac.prototype.deletedNodes={};ac.prototype.deletedLinks={};ac.prototype.enteringNodes={};ac.prototype.enteringLinks={};ac.prototype.exitingNodes={};ac.prototype.exitingLinks={};ac.prototype.centerX=0;ac.prototype.centerY=0;ac.prototype.zoom=1;ac.prototype.layoutActive=true;function ac(){ac.__super__.constructor.call(this);this.nodes=[];this.links=[];this.userNodeIds={};this.positionedNodeIds={};this.selection=[];this.idToNode={};this.idToLink={};this.multilinks=null;this.clearModified()}ac.prototype.addNode=function(af){var ae;if(this.idToNode.hasOwnProperty(af)){ae=this.idToNode[af];ae.removed=false;if(!ae.added){ae.added=true}}else{if(this.deletedNodes.hasOwnProperty(af)){ae=this.deletedNodes[af];ae.removed=false;if(!ae.added){ae.added=true}this.idToNode[af]=ae;this.nodes.push(ae);delete this.deletedNodes[af]}else{ae=new Q(af);ae.added=true;this.idToNode[af]=ae;this.nodes.push(ae);this.newNodes[af]=ae}}this.modifiedNodes[af]=ae;return ae};ac.prototype.touchNode=function(ae){return this.modifiedNodes[ae.id]=ae};ac.prototype.removeNode=function(ae){var af;af=ae.id;if(!this.idToNode.hasOwnProperty(af)){return}T.removeFromArray(this.selection,ae);if(this.newNodes.hasOwnProperty(ae.id)){return this.deleteNode(ae)}else{if(!ae.removed){ae.removed=true}ae.added=false;return this.modifiedNodes[af]=ae}};ac.prototype.deleteNode=function(ae){T.removeFromArray(this.selection,ae);T.removeFromArray(this.nodes,ae);delete this.newNodes[ae.id];delete this.modifiedNodes[ae.id];delete this.idToNode[ae.id];return this.deletedNodes[ae.id]=ae};ac.prototype.addLink=function(af,ah,ag){var ae;if(!(this.idToNode.hasOwnProperty(ah)&&this.idToNode.hasOwnProperty(ag))){throw"Cannot add link - missing nodes"}if(this.idToLink.hasOwnProperty(af)){ae=this.idToLink[af];ae.removed=false;if(!ae.added){ae.added=true}}else{if(this.deletedLinks.hasOwnProperty(af)){ae=this.deletedLinks[af];delete this.deletedLinks[af];this.idToLink[af]=ae;this.links.push(ae);ae.removed=false;if(!ae.added){ae.added=true}}else{ae=new v();ae.added=true;ae.id=af;this.links.push(ae);this.idToLink[af]=ae;this.newLinks[af]=ae}}ae.from=null;ae.to=null;ae.multiId=ah<ag?ah+"#"+ag:ag+"#"+ah;this.modifiedLinks[af]=ae;return ae};ac.prototype.removeLink=function(ae){var af;af=ae.id;if(!this.idToLink.hasOwnProperty(af)){return}if(this.newLinks.hasOwnProperty(af)){return this.deleteLink(ae)}else{ae.added=false;if(!ae.removed){ae.removed=true}return this.modifiedLinks[af]=ae}};ac.prototype.deleteLink=function(ae){T.removeFromArray(this.links,ae);if(this.newLinks.hasOwnProperty(ae.id)){delete this.newLinks[ae.id]}else{this.deletedLinks[ae.id]=ae}delete this.modifiedLinks[ae.id];return delete this.idToLink[ae.id]};ac.prototype.touchLink=function(ae){return this.modifiedLinks[ae.id]=ae};ac.prototype.getModified=function(){return[this.newNodes,this.newLinks,this.modifiedNodes,this.modifiedLinks,this.deletedNodes,this.deletedLinks]};ac.prototype.hasTopologyChanges=function(){return T.hasProperties(this.newNodes)||T.hasProperties(this.newLinks)||T.hasProperties(this.deletedNodes)||T.hasProperties(this.deletedLinks)};ac.prototype.hasStyleChanges=function(){return this.hasTopologyChanges()||T.hasProperties(this.modifiedLinks)||T.hasProperties(this.modifiedNodes)};ac.prototype.clearModified=function(){this.newNodes={};this.newLinks={};this.modifiedNodes={};this.modifiedLinks={};this.deletedNodes={};return this.deletedLinks={}};ac.prototype.xyInChart=function(ae,af){return(ae>=this.x0)&&(ae<this.x0+this.width)&&(af>=this.y0)&&(af<this.y0+this.height)};ac.prototype.toDisplay=function(ae,af){return[(ae-this.centerX)*this.zoom+this.x0+this.width*0.5,(af-this.centerY)*this.zoom+this.y0+this.height*0.5]};ac.prototype.fromDisplay=function(ae,af){return[(ae-this.x0-this.width*0.5)/this.zoom+this.centerX,(af-this.y0-this.height*0.5)/this.zoom+this.centerY]};ac.prototype.toDisplayTransform=function(ae,af){return[this.zoom,this.x0+this.width*0.5-this.centerX*this.zoom,this.zoom,this.y0+this.height*0.5-this.centerY*this.zoom]};ac.prototype.setActiveObject=function(ae){if(this.hoverNode!=null){this.touchNode(this.hoverNode)}if(this.hoverLink!=null){this.touchLink(this.hoverLink)}this.hoverNode=null;this.hoverLink=null;if(ae instanceof Q){this.hoverNode=ae;return this.touchNode(this.hoverNode)}else{if(ae instanceof v){this.hoverLink=ae;return this.touchLink(this.hoverLink)}else{if(ae!==null){throw"scene.setActiveObject invalid active object type "+ae}}}};ac.prototype.getVisibleBounds=function(){var ag,af,ai,ah,aj,ae;aj=this.fromDisplay(this.x0,this.y0),ag=aj[0],ai=aj[1];ae=this.fromDisplay(this.x0+this.width,this.y0+this.height),af=ae[0],ah=ae[1];return[ag,ai,af,ah]};ac.prototype.getGraphBounds=function(){var ah,ae,ap,an,ag,af,ak,ao,am,ai,al,aj;if(this.nodes.length===0){return[0,0,0,0]}ag=Infinity;af=-Infinity;ao=Infinity;am=-Infinity;aj=this.nodes;for(ai=0,al=aj.length;ai<al;ai++){ah=aj[ai];if(ah.removed){continue}an=ah.x;ak=ah.y;ae=ah.currentRadius;if(ah.renderRadius){ae=ah.renderRadius}ap=ah.currentHwidth;if(ah.renderHwidth){ap=ah.renderHwidth}ap=ap+ae*0.2;ae=ae*1.2;ag=Math.min(ag,an-ap);af=Math.max(af,an+ap);ao=Math.min(ao,ak-ae);am=Math.max(am,ak+ae)}return[ag,ao,af,am]};ac.prototype.findNodeAt=function(ap,ao,aq){var aj,an,af,al,ag,ae,ah,au,ar,ak,at,am,ai;am=this.fromDisplay(ap,ao),au=am[0],ar=am[1];al=aq;aj=null;ai=this.nodes;for(ak=0,at=ai.length;ak<at;ak++){ag=ai[ak];if(ag.removed){continue}ae=ag.targetRadius;an=(au-ag.x)*(au-ag.x)+(ar-ag.y)*(ar-ag.y);ah=(ae+al)*(ae+al);if(an<ah){af=ae*ae;if(an<af){return ag}else{al=Math.sqrt(an)-ae}}}return aj};ac.prototype.findLinkOrNodeAt=function(aJ,aH,aA){var an,am,aj,au,aw,aE,az,ay,ax,aG,aF,av,aC,at,ar,aD,aB,aq,ao,al,ah,af,aI,aK,ap,ak,ai,ag,ae;ap=this.fromDisplay(aJ,aH),ar=ap[0],aq=ap[1];ay=aA;an=null;ak=this.nodes;for(ah=0,aI=ak.length;ah<aI;ah++){ax=ak[ah];if(ax.removed){continue}av=ax.targetRadius;at=ax.hwidth;aG=ax.x;aF=ax.y;if(av<at){aw=at-av;ai=a.closestPointToLine(aG-aw,aF,aG+aw,aF,ar,aq),aG=ai[0],aF=ai[1]}au=(ar-aG)*(ar-aG)+(aq-aF)*(aq-aF);aC=(av+ay)*(av+ay);if(au<aC){aE=av*av;if(au<aE){return ax}else{ay=Math.sqrt(au)-av;an=ax}}}ag=this.links;for(af=0,aK=ag.length;af<aK;af++){az=ag[af];if(az.removed){continue}av=az.targetRadius;aD=az.from.x;ao=az.from.y;aB=az.to.x;al=az.to.y;ae=a.closestPointToLine(aD,ao,aB,al,ar,aq),am=ae[0],aj=ae[1];au=(ar-am)*(ar-am)+(aq-aj)*(aq-aj);aC=(av+ay)*(av+ay);if(au<aC){ay=Math.sqrt(au)-av;an=az}}return an};ac.prototype.updateMultilinks=function(){var af,ah,ak,ag,aj,ae,ai;if(!this.hasTopologyChanges()){return}ag={};ai=this.links;for(aj=0,ae=ai.length;aj<ae;aj++){ah=ai[aj];ak=ah.multiId;if(!ag.hasOwnProperty(ak)){ag[ak]=ah}else{af=ag[ak];if(T.isArray(af)){af.push(ah)}else{ag[ak]=[ag[ak],ah]}}}return this.multilinks=ag};return ac})(E);var D;D=(function(){ac.prototype.animationPriority=1000;function ac(ad){this.chart=ad;this.scene=ad.scene;this.time=null;this.idleSince=null;this.nodeMap=null;this.random=new f(1);this.springs=new J(this.random)}ac.prototype.doAnimations=function(ad){var ah,an,af,ag,ae,al,ak,ai,ao,am,aj;this.settings=this.scene.settings.layout;al=this.settings.layoutFreezeTimeout;if(!this.time||this.time+al<ad.time){af=30}else{af=Math.min(1000,ad.time-this.time)}this.time=ad.time;an=this.animateChanges(ad.time,af);am=this.scene.hasTopologyChanges();ao=this.scene.hasStyleChanges();if(an||am||ad.changes.coordinates||ad.changes.layout||this.idleSince===null||ad.changes.bounds){this.idleSince=this.time}ai={};ak=false;if(am){this.random=new f(1);aj=this.placeNewNodes(),ai=aj[0],ak=aj[1]}ag=this.settings.layoutMode==="dynamic";if((ag||an)&&this.idleSince+al>this.time){ae=(this.time-this.idleSince)/al;ah=1-Math.pow(Math.max(0,(ae-0.5)*2),2);this.doLayout(ad.time,af*ah,am|ad.changes.layout,ao,ai,500,ak,ag);this.placePies();ad.animating=true}if(an){return ad.animating=true}};ac.prototype.animateChanges=function(am,aq){var ar,ag,al,af,av,an,ap,at,au,ak,ai,ah,ae,ad,ax,az,ay,aw,ao,aj;ar=false;al=this.settings.fadeTime;ag=Math.max(0,Math.pow(0.2,aq/al));af=0.01;ak=[];ap=[];ao=this.scene.nodes;for(ai=0,ax=ao.length;ai<ax;ai++){au=ao[ai];if(au.added===true){au.added=am}if(au.added+al<am){au.added=false}if(au.removed===true){au.removed=am}if(au.removed){ar=true;au.currentRadius=au.currentRadius*ag;au.currentHwidth=au.currentHwidth*ag;if(au.removed+al<am){ak.push(au)}}else{if(au.hwidth!==au.currentHwidth){ar=true;au.currentRadius=au.currentRadius*ag+au.targetRadius*(1-ag);au.currentHwidth=au.currentHwidth*ag+au.hwidth*(1-ag);if(Math.abs(au.currentRadius-au.targetRadius)<af*au.targetRadius){au.currentRadius=au.targetRadius;au.currentHwidth=au.hwidth}}}}aj=this.scene.links;for(ah=0,az=aj.length;ah<az;ah++){an=aj[ah];if(an.added===true){an.added=am}if(an.added+al<am){an.added=false}if(an.removed===true){an.removed=am}if(an.removed){ar=true;an.currentRadius=an.currentRadius*ag;if(an.removed+al<am){ap.push(an)}}else{if(an.targetRadius!==an.currentRadius){ar=true;an.currentRadius=an.currentRadius*ag+an.targetRadius*(1-ag);if(Math.abs(an.currentRadius-an.targetRadius)<af*an.targetRadius){an.currentRadius=an.targetRadius}}}}for(ae=0,ay=ap.length;ae<ay;ae++){av=ap[ae];this.scene.deleteLink(av)}for(ad=0,aw=ak.length;ad<aw;ad++){at=ak[ad];this.scene.deleteNode(at)}return ar};ac.prototype.resetLayout=function(){var ah,ae,ag,ad,af;this.random=new f(1);this.springs.random=this.random;ae={};af=this.scene.nodes;for(ag=0,ad=af.length;ag<ad;ag++){ah=af[ag];ae[ah.id]=ah;ah.x=0;ah.y=0;ah.userLock=false}this.doLayout(new Date().getTime(),1,true,true,ae,10000,true);return this.idleSince=null};ac.prototype.placeNewNodes=function(){var ao,am,ak,av,at,aw,aB,ap,an,az,aq,ay,au,ai,aA,aD,aC,ax,ah,af,ae,ad,aF,aH,aG,aE,ar,al,aj,ag;au={};an=false;ar=this.scene.nodes;for(ah=0,aF=ar.length;ah<aF;ah++){az=ar[ah];if(az.x===0&&az.y===0){au[az.id]=true}}al=this.scene.nodes;for(af=0,aH=al.length;af<aH;af++){az=al[af];ax=1;if(au.hasOwnProperty(az.id)){ay=0;am=0;ak=0;ax=1;aj=az.links;for(ae=0,aG=aj.length;ae<aG;ae++){ap=aj[ae];ai=ap.otherEnd(az);if(!au.hasOwnProperty(ai.id)){aq=ai;am+=ai.x;ak+=ai.y;ay+=1}}if(ay>1){aD=am/ay;aC=ak/ay;ax=0.5}else{if(ay===1){ao=0;av=0;at=0;ag=aq.links;for(ad=0,aE=ag.length;ad<aE;ad++){ap=ag[ad];aA=ap.otherEnd(aq);if(aA===az||au.hasOwnProperty(aA.id)){continue}av+=aA.x-aq.x;at+=aA.y-aq.y;ao+=1}if(ao>0){aB=Math.sqrt(av*av+at*at);if(aB>0){aw=1/(aB*ao);av*=aw;at*=aw;aD=aq.x-av*aq.currentRadius*1.2;aC=aq.y-at*aq.currentRadius*1.2;ax=0.2}else{aD=aq.x;aC=aq.y}}else{an=true;aD=aq.x;aC=aq.y}}else{an=true;aD=0;aC=0}}az.x=aD+(this.random.get()-0.5)*ax*(az.currentRadius+1);az.y=aC+(this.random.get()-0.5)*ax*(az.currentRadius+1)}}return[au,an]};ac.prototype.placePies=function(){var ad,ar,am,aq,ap,ao,al,at,aj,ai,ag,af,ae,au,ax,aw,av,an,ak,ah;ad=Math.PI*2;at=[];an=this.scene.nodes;ah=[];for(ai=0,au=an.length;ai<au;ai++){ap=an[ai];aj=0;ak=ap.links;for(ag=0,ax=ak.length;ag<ax;ag++){am=ak[ag];if(am.to===ap&&am.toPieValue>0){aj+=am.toPieValue;at.push(am);am._angle=Math.atan2(am.to.y-am.from.y,am.to.x-am.from.x)}}if(aj>0){at.sort(function(az,ay){return az._angle-ay._angle});aq=ad/aj;ar=0;al=0;for(af=0,aw=at.length;af<aw;af++){am=at[af];am.toPie0=ar;ar+=am.toPieValue*aq;am.toPie1=ar;ao=am._angle-(am.toPie0+am.toPie1)/2;if(ao<0){ao+=Math.PI*2}al+=ao}al/=at.length;al-=Math.PI;for(ae=0,av=at.length;ae<av;ae++){am=at[ae];am.toPie0+=al;am.toPie1+=al}ah.push(at=[])}else{ah.push(void 0)}}return ah};ac.prototype.doLayout=function(ap,av,ag,aF,at,ar,aH,aA){var ah,aw,al,an,au,aB,am,aD,ax,ao,az,aE,ay,ak,aj,aG,aC,ai,af,ae,ad,aJ,aL,aK,aI,aq;if(aH==null){aH=false}if(aA==null){aA=true}an=this.scene.settings.layout.fadeTime;aw=null;if(this.scene.settings.interaction.zooming.autoZoom){aw=(this.scene.width+1)/(this.scene.height+1)}aE=this.settings.nodeSpacing;al=1;ay=this.scene.nodes;ah=false;for(ai=0,aJ=ay.length;ai<aJ;ai++){az=ay[ai];az.locked=az.userLock||az.locks>0;ah||(ah=az.added||az.removed);if(az.added){az.visibility=1-0.8*(ap-az.added)/an}else{if(az.removed){az.visibility=0.2+0.8*(ap-az.removed)/an}else{az.visibility=1}}}ao={};ak=[];aq=this.scene.links;for(af=0,aL=aq.length;af<aL;af++){aB=aq[af];ax=aB.multiId;aG=aB.targetStrength;am=aB.targetLength;aC=1;if(aB.removed||aB.added){au=aB.from.links.length>1&&aB.to.links.length>1;if(au||aB.removed){aj=0.2}else{aj=aG}if(aB.removed){aC=1-(ap-aB.removed)/an}if(aB.added){aC=(ap-aB.added)/an;am=0.2+(am-0.2)*aC}aG=aG*aC+aj*(1-aC)}if(!ao.hasOwnProperty(ax)){aD={from:aB.from,to:aB.to,strength:aG,length:am,visibility:aC};ao[ax]=aD;ak.push(aD)}else{aD=ao[ax];aD.strength=Math.max(aG,aD.strength);aD.length=Math.max(am,aD.length);aD.visibility=Math.max(aC,aD.visibility)}}this.springs.updateParams(aE,al,aw);if(aH||T.hasProperties(at)){for(ae=0,aK=ay.length;ae<aK;ae++){az=ay[ae];az.locked||(az.locked=!at.hasOwnProperty(az.id))}this.springs.updateGraph(ay,ak,ag);if(aH||this.scene.settings.layout.globalLayoutOnChanges){this.springs.globalLayout(ay,ar,aH)}else{this.springs.timedLayout(ay,av*0.001)}}if(aA||ah){if(!aA){for(ad=0,aI=ay.length;ad<aI;ad++){az=ay[ad];az.locked||(az.locked=!az.removed&&!az.added)}}this.springs.updateGraph(ay,ak,ag);return this.springs.timedLayout(ay,av*0.001)}};return ac})();var L;L=(function(){ac.prototype.scene=null;ac.prototype.container=null;ac.prototype.background=null;ac.prototype.canvas=null;ac.prototype.outerBorder=null;ac.prototype.mouseTrackLayer=null;function ac(ad){this.scene=ad;this.container=T.createDom("div","DVSL-container");this.container.style.position="relative";this.container.style.width="100%";this.container.style.height="100%";this.background=T.createDom("div","DVSL-background",null,this.container);this.setContainerStyle(this.background);this.canvas=T.createDom("canvas","NetChart-canvas",null,this.container);this.setContainerStyle(this.canvas);this.outerBorder=T.createDom("div","DVSL-border",null,this.container);this.setContainerStyle(this.outerBorder);this.resizerBar=T.createDom("div","DVSL-resizer",null,this.container);this.mouseTrackLayer=T.createDom("div",null,null,this.container);this.setContainerStyle(this.mouseTrackLayer);this.updateSettings(this.scene.settings,"init");this.updateSize()}ac.prototype.updateSize=function(){var ad,ae;ae=this.scene.settings.width;ad=this.scene.settings.height;if(this.scene.chartWidth>this.scene.settings.container.clientWidth){ae=this.scene.chartWidth}if(this.scene.chartHeight>this.scene.settings.container.clientHeight){ad=this.scene.chartHeight}if(ae){this.container.style.width=""+ae+"px"}if(ad){this.container.style.height=""+ad+"px"}this.resizerBar.style.width=""+this.scene.width+"px";return this.resizerBar.style.left=""+this.scene.x0+"px"};ac.prototype.updateSettings=function(ad){if(T.hasProp(ad,"advanced/themeCSSClass")){if(this.curTheme!=null){T.removeClass(this.container,this.curTheme)}this.curTheme=this.scene.settings.advanced.themeCSSClass;return T.addClass(this.container,this.curTheme)}};ac.prototype.setContainerStyle=function(ad){ad.style.position="absolute";ad.style.left="0px";ad.style.right="0px";ad.style.top="0px";return ad.style.bottom="0px"};return ac})();var C;C=(function(){ac.prototype.animationPriority=1003;function ac(ad){this.chart=ad;this.scene=ad.scene;this.time=null}ac.prototype.sortRules=function(ag){var ae,af,ad;af=(function(){var ah;ah=[];for(ae in ag){ad=ag[ae];ah.push(ae)}return ah})();af.sort();return(function(){var aj,ai,ah;ah=[];for(aj=0,ai=af.length;aj<ai;aj++){ae=af[aj];ah.push(ag[ae])}return ah})()};ac.prototype.doAnimations=function(ad){var am,ar,aq,an,ap,ag,at,ak,aj,ao,ae,al,ai,ah,af;if(!(ad.changes.settings||T.hasProperties(this.scene.modifiedNodes)||T.hasProperties(this.scene.modifiedLinks))){return}this.nodeRules=this.sortRules(this.scene.settings.style.nodeRules);this.linkRules=this.sortRules(this.scene.settings.style.linkRules);this.nodeRadiusChanged=T.hasProperties(this.scene.newNodes)|T.hasProperties(this.scene.deletedNodes);this.linkRadiusChanged=T.hasProperties(this.scene.newLinks)|T.hasProperties(this.scene.deletedLinks);am=this.scene.settings.navigation.mode==="focusnodes"&&this.scene.settings.navigation.focusAutoFadeout;if(ad.changes.settings){this.nodeRadiusChanged=true;this.linkRadiusChanged=true;al=this.scene.nodes;for(ak=0,ao=al.length;ak<ao;ak++){ag=al[ak];this.updateNode(ag,am)}ai=this.scene.links;for(aj=0,ae=ai.length;aj<ae;aj++){an=ai[aj];this.updateLink(an,am)}}else{ah=this.scene.modifiedNodes;for(ar in ah){at=ah[ar];this.updateNode(at,am)}af=this.scene.modifiedLinks;for(aq in af){ap=af[aq];this.updateLink(ap,am)}}if(this.nodeRadiusChanged||(am&&ad.changes.navigation)){this.computeRadiuses(this.scene.nodes,this.scene.settings.style.nodeAutoScaling,this.scene.settings.style.nodeRadiusExtent,am)}this.computeNodeWidths(this.scene.nodes,ad.context);if(this.linkRadiusChanged||(am&&ad.changes.navigation)){this.computeRadiuses(this.scene.links,this.scene.settings.style.linkAutoScaling,this.scene.settings.style.linkRadiusExtent,am);this.computeStrengths(this.scene.links,this.scene.settings.style.linkStrengthAutoScaling,this.scene.settings.style.linkStrengthExtent);this.computeLengths(this.scene.links,this.scene.settings.style.linkLengthAutoScaling,this.scene.settings.style.linkLengthExtent);return this.scene.links.sort(function(av,au){if(av.targetRadius===au.targetRadius){return 0}if(av.targetRadius>au.targetRadius){return 1}else{return -1}})}};ac.prototype.updateNode=function(ae,aj){var af,ag,ad,ak,ah,al,ai;af=ae===this.scene.hoverNode;ad=ae.radius;T.extend(ae,this.scene.settings.style.node);if(!ae.radius){ae.radius=10}ae.label=ae.id;ae.labelStyle=this.scene.settings.style.nodeLabel;ae.labelBackground=this.scene.settings.style.nodeLabelBalloon;if(ae.userLock){T.extend(ae,this.scene.settings.style.nodeLocked)}if(ae.expanded){T.extend(ae,this.scene.settings.style.nodeExpanded)}if(ae.focused){T.extend(ae,this.scene.settings.style.nodeFocused)}if(ae.data){if(ae.data.error!=null){ae.label=ae.data.error;ae.fillColor="red"}if(ae.data.style){T.extend(ae,ae.data.style)}this.applyStyleRules(ae,this.nodeRules);if(!T.isNumber(ae.radius)){ae.radius=10}}if(ae.removed){ae.fillColor=this.scene.settings.style.removedColor}if(af){T.extend(ae,this.scene.settings.style.hoverStyle)}ai=ae.links;for(ah=0,al=ai.length;ah<al;ah++){ag=ai[ah];this.updateLink(ag,aj)}if(ad!==ae.radius){this.nodeRadiusChanged=true}if(aj&&ae.relevance<1){ak=this.scene.settings.style.removedColor;if(ae.fillColor){ae.fillColor=y.blendColors(ak,ae.fillColor,ae.relevance)}if(ae.lineColor){ae.lineColor=y.blendColors(ak,ae.lineColor,ae.relevance)}}return true};ac.prototype.updateLink=function(ae,ah){var ag,af,ad;af=ae.radius;T.extend(ae,this.scene.settings.style.link);ae.label=null;ae.labelStyle=this.scene.settings.style.linkLabel;ae.labelBackground=this.scene.settings.style.linkLabelBalloon;ae.radius=1;ag=ae===this.scene.hoverLink||ae.from===this.scene.hoverNode||ae.to===this.scene.hoverNode;if(ae.data.style){T.extend(ae,ae.data.style)}this.applyStyleRules(ae,this.linkRules);if(!T.isNumber(ae.radius)){ae.radius=1}if(ag){T.extend(ae,this.scene.settings.style.hoverStyle);if(ae.from===this.scene.hoverNode){ae.toPieColor=ae.fillColor}}if(ae.removed){ae.fillColor=this.scene.settings.style.removedColor}if(af!==ae.radius){this.linkRadiusChanged=true}if(ah&&ae.relevance<1){ad=this.scene.settings.style.removedColor;if(ae.fillColor){ae.fillColor=y.blendColors(ad,ae.fillColor,ae.relevance)}if(ae.lineColor){ae.lineColor=y.blendColors(ad,ae.lineColor,ae.relevance)}return ae.length=0.2+(ae.length-0.2)*ae.relevance}};ac.prototype.applyStyleRules=function(ah,ai){var af,ag,ae,ad;ad=[];for(ag=0,ae=ai.length;ag<ae;ag++){af=ai[ag];ad.push(af(ah))}return ad};ac.prototype.computeRadiuses=function(ae,an,aq,at){var ao,ar,ak,ap,al,au,am,aj,ah,ag,af,ay,aA,az,ax,aw,av,ad,aB,ai;al=aq[0],ak=aq[1];if(an==="linear"||an==="logarithmic"){ap=Infinity;ar=-Infinity;for(aj=0,ay=ae.length;aj<ay;aj++){am=ae[aj];if(!am.removed){ap=Math.min(ap,am.radius);ar=Math.max(ar,am.radius)}}if(ap>=ar){for(ah=0,aA=ae.length;ah<aA;ah++){am=ae[ah];if(!am.removed){am.targetRadius=al}}}else{if(an==="linear"){au=(ak-al)/(ar-ap);ao=ak-ar*au;for(ag=0,az=ae.length;ag<az;ag++){am=ae[ag];if(!am.removed){am.targetRadius=am.radius*au+ao}}}else{ap=Math.max(0.0001,ap);ar=Math.max(ap+0.0001,ar);au=(ak-al)/Math.log(ar/ap);ao=ak-au*Math.log(ar);for(af=0,ax=ae.length;af<ax;af++){am=ae[af];if(!am.removed){am.targetRadius=Math.log(Math.max(0.0001,am.radius))*au+ao}}}}}else{for(ad=0,aw=ae.length;ad<aw;ad++){am=ae[ad];if(!am.removed){am.targetRadius=Math.min(Math.max(al,am.radius),ak)}}}if(at){ai=[];for(aB=0,av=ae.length;aB<av;aB++){am=ae[aB];if(am.relevance<1){ai.push(am.targetRadius=am.targetRadius*am.relevance)}else{ai.push(void 0)}}return ai}};ac.prototype.computeNodeWidths=function(ae,an){var ah,ag,ad,ap,am,al,ak,ao,af,aj,ai;if(this.scene.settings.style.nodeDisplay==="image"){aj=[];for(al=0,ao=ae.length;al<ao;al++){ag=ae[al];aj.push(ag.hwidth=ag.targetRadius)}return aj}else{ai=[];for(ak=0,af=ae.length;ak<af;ak++){ag=ae[ak];ad=ag.targetRadius;ap=0;if(ag.image){ap+=ad}if(ag.label){if(ag.labelStyle.font){an.font=ag.labelStyle.font}else{an.font=null}ah=an.measureText("M").width;am=an.measureText(ag.label).width;am=am*1.6/2;ap+=(am/ah+0.6)*ad}ai.push(ag.hwidth=Math.max(ap,ad))}return ai}};ac.prototype.computeStrengths=function(ae,aq,au){var ar,av,am,at,ao,aw,ap,aj,ah,ag,af,az,aB,aA,ay,ax,ad,ai,an,al,ak;ao=au[0],am=au[1];if(aq==="linear"||aq==="logarithmic"){at=Infinity;av=-Infinity;for(aj=0,az=ae.length;aj<az;aj++){ap=ae[aj];if(!ap.removed){at=Math.min(at,ap.strength);av=Math.max(av,ap.strength)}}if(at>=av){ai=[];for(ah=0,aB=ae.length;ah<aB;ah++){ap=ae[ah];if(!ap.removed){ai.push(ap.targetStrength=ao)}else{ai.push(void 0)}}return ai}else{if(aq==="linear"){aw=(am-ao)/(av-at);ar=am-av*aw;an=[];for(ag=0,aA=ae.length;ag<aA;ag++){ap=ae[ag];if(!ap.removed){an.push(ap.targetStrength=ap.strength*aw+ar)}else{an.push(void 0)}}return an}else{at=Math.max(0.0001,at);av=Math.max(at+0.0001,av);aw=(am-ao)/Math.log(av/at);ar=am-aw*Math.log(av);al=[];for(af=0,ay=ae.length;af<ay;af++){ap=ae[af];if(!ap.removed){al.push(ap.targetStrength=Math.log(Math.max(0.0001,ap.strength))*aw+ar)}else{al.push(void 0)}}return al}}}else{ak=[];for(ad=0,ax=ae.length;ad<ax;ad++){ap=ae[ad];if(!ap.removed){ak.push(ap.targetStrength=Math.min(Math.max(ao,ap.strength),am))}else{ak.push(void 0)}}return ak}};ac.prototype.computeLengths=function(ae,aq,au){var ar,av,am,at,ao,aw,ap,aj,ah,ag,af,az,aB,aA,ay,ax,ad,ai,an,al,ak;ao=au[0],am=au[1];if(aq==="linear"||aq==="logarithmic"){at=Infinity;av=-Infinity;for(aj=0,az=ae.length;aj<az;aj++){ap=ae[aj];if(!ap.removed){at=Math.min(at,ap.length);av=Math.max(av,ap.length)}}if(at>=av){ai=[];for(ah=0,aB=ae.length;ah<aB;ah++){ap=ae[ah];if(!ap.removed){ai.push(ap.targetLength=ao)}else{ai.push(void 0)}}return ai}else{if(aq==="linear"){aw=(am-ao)/(av-at);ar=am-av*aw;an=[];for(ag=0,aA=ae.length;ag<aA;ag++){ap=ae[ag];if(!ap.removed){an.push(ap.targetLength=ap.length*aw+ar)}else{an.push(void 0)}}return an}else{at=Math.max(0.0001,at);av=Math.max(at+0.0001,av);aw=(am-ao)/Math.log(av/at);ar=am-aw*Math.log(av);al=[];for(af=0,ay=ae.length;af<ay;af++){ap=ae[af];if(!ap.removed){al.push(ap.targetLength=Math.log(Math.max(0.0001,ap.length))*aw+ar)}else{al.push(void 0)}}return al}}}else{ak=[];for(ad=0,ax=ae.length;ad<ax;ad++){ap=ae[ad];if(!ap.removed){ak.push(ap.targetLength=Math.min(Math.max(ao,ap.length),am))}else{ak.push(void 0)}}return ak}};return ac})();var Y,j=function(ac,ad){return function(){return ac.apply(ad,arguments)}};Y=(function(){function ac(af){var ad,ae,ah,ag;this.chart=af;this.freeze=j(this.freeze,this);this.resetLayout=j(this.resetLayout,this);this.zoomToFit=j(this.zoomToFit,this);this.zoomMove=j(this.zoomMove,this);this.zoomDown=j(this.zoomDown,this);this.scene=af.scene;this.events=af.events;this.scrolling=this.chart.scrolling;ad=T.createDom("div","DVSL-NC-zoom",null,this.chart.layers.container);ag=T.createDom("span",null,null,ad);this.handle=T.createDom("em",null,null,ag);ah=T.createDom("nav",null,null,ad);this.fit=T.createDom("a","DVSL-NC-zoom-fit","Fit to screen",ah);this.fit.title="Fit to screen";this.rearrange=T.createDom("a","DVSL-NC-zoom-rearrange","Rearrange elements",ah);this.rearrange.title="Rearrange elements";this.lock=T.createDom("a","DVSL-NC-zoom-lock-all","Locak all",ah);this.lock.title="Lock all";this.lock.onclick=this.freeze;this.rearrange.onclick=this.resetLayout;this.fit.onclick=this.zoomToFit;ae=new t(ad,this.scene.settings.advanced.pointer);ae.listen("drag",this.zoomMove);ae.listen("down",this.zoomDown)}ac.prototype.zoomDown=function(ad){if(ad.y<100){return this.zoomMove(ad)}};ac.prototype.zoomMove=function(ae){var ad,af;af=ae.y-10;af=Math.max(0,Math.min(80,af));this.handle.style.top=""+af+"px";ad=this.getZoomValue(af/80);this.scrolling.zoom(ad/this.scene.zoom);this.events.notifySceneChanges({position:true});return ae.consumed=true};ac.prototype.getSliderPosition=function(){var ad,ae,af,ag;ag=this.scene.settings.interaction.zooming.zoomExtent,ae=ag[0],ad=ag[1];ae=Math.log(ae);ad=Math.log(ad);af=Math.log(this.scene.zoom);return 1-(af-ae)/(ad-ae)};ac.prototype.getZoomValue=function(ah){var ad,ae,ag,af;af=this.scene.settings.interaction.zooming.zoomExtent,ae=af[0],ad=af[1];ae=Math.log(ae);ad=Math.log(ad);ag=(1-ah)*(ad-ae)+ae;return Math.exp(ag)};ac.prototype.zoomToFit=function(ad){if(this.scene.settings.interaction.zooming.autoZoom){this.scene.settings.interaction.zooming.autoZoom=false}else{this.scene.settings.interaction.zooming.autoZoom=true;this.events.notifySceneChanges({position:true})}return ad.preventDefault()};ac.prototype.resetLayout=function(ad){this.chart.layout.resetLayout();this.scene.settings.layout.layoutMode="dynamic";this.scene.settings.interaction.zooming.autoZoom=true;this.chart.scrolling.zoomToFit();this.events.notifySceneChanges({position:true,layout:true});return ad.preventDefault()};ac.prototype.freeze=function(ad){if(this.scene.settings.layout.layoutMode==="dynamic"){this.scene.settings.layout.layoutMode="static"}else{this.scene.settings.layout.layoutMode="dynamic"}this.events.notifySceneChanges({layout:true});return ad.preventDefault()};ac.prototype.doAnimations=function(ad){var ae;ae=this.getSliderPosition();this.handle.style.top=""+(80*ae)+"px";if(this.scene.settings.interaction.zooming.autoZoom){T.setClass(this.fit,"DVSL-NC-zoom-fit-active")}else{T.setClass(this.fit,"DVSL-NC-zoom-fit")}if(this.scene.settings.layout.layoutMode==="dynamic"){return T.setClass(this.lock,"DVSL-NC-zoom-lock-all")}else{return T.setClass(this.lock,"DVSL-NC-zoom-lock-all-active")}};return ac})();var s,Z,h,j=function(ac,ad){return function(){return ac.apply(ad,arguments)}};h=(function(){function ac(){}ac.prototype.time=0;ac.prototype.animating=false;ac.prototype.changes={};return ac})();s=(function(){function ac(){}ac.prototype.animationPriority=0;ac.prototype.remove=function(){return false};ac.prototype.doAnimations=function(ad){return false};ac.prototype.paintScene=function(ad){return false};ac.prototype.onSceneChange=function(ad){return false};ac.prototype.onClick=function(ad){return false};ac.prototype.onRClick=function(ad){return false};ac.prototype.onDoubleClick=function(ad){return false};ac.prototype.onPointerDown=function(ad){return false};ac.prototype.onPointerUp=function(ad){return false};ac.prototype.onPointerDrag=function(ad){return false};ac.prototype.onPointerMove=function(ad){return false};ac.prototype.onPointerOut=function(ad){return false};ac.prototype.onPointerCancel=function(ad){return false};ac.prototype.onWheel=function(ad){return false};ac.prototype.onKeyDown=function(ad){return false};ac.prototype.previewWheel=function(ad){return false};ac.prototype.previewPointerDown=function(ad){return false};ac.prototype.previewPointerUp=function(ad){return false};ac.prototype.previewPointerDrag=function(ad){return false};ac.prototype.previewPointerMove=function(ad){return false};ac.prototype.previewPointerOut=function(ad){return false};return ac})();Z=(function(){ac.prototype.container=null;ac.prototype.paintRequested=false;ac.prototype.mouseEvents=null;ac.prototype.verbose=false;function ac(ad,ae,af){this.container=ad;this.canvas=ae;this.chart=af;this._paintScene=j(this._paintScene,this);this.kd=j(this.kd,this);this.mw=j(this.mw,this);this.mdbl=j(this.mdbl,this);this.rcl=j(this.rcl,this);this.mcl=j(this.mcl,this);this.mcc=j(this.mcc,this);this.mlve=j(this.mlve,this);this.mmve=j(this.mmve,this);this.mdrg=j(this.mdrg,this);this.mup=j(this.mup,this);this.mdwn=j(this.mdwn,this);this.scene=this.chart.scene;this.settings=this.chart.settings;this.elements=[];this.elementsReverse=[];this.pointerToElement={};this.sceneChanges={};this.animationOrder=[];this.hooks={};this.mouseEvents=new t(this.container,this.settings.advanced.pointer,this.chart,this.whiteList);this.mouseEvents.listen(this.mouseEvents.EVENT_DOWN,this.mdwn);this.mouseEvents.listen(this.mouseEvents.EVENT_UP,this.mup);this.mouseEvents.listen(this.mouseEvents.EVENT_DRAG,this.mdrg);this.mouseEvents.listen(this.mouseEvents.EVENT_MOVE,this.mmve);this.mouseEvents.listen(this.mouseEvents.EVENT_LEAVE,this.mlve);this.mouseEvents.listen(this.mouseEvents.EVENT_CANCEL,this.mcc);this.mouseEvents.listen(this.mouseEvents.EVENT_CLICK,this.mcl);this.mouseEvents.listen(this.mouseEvents.EVENT_RCLICK,this.rcl);this.mouseEvents.listen(this.mouseEvents.EVENT_DBLCLICK,this.mdbl);this.mouseEvents.listen(this.mouseEvents.EVENT_WHEEL,this.mw);T.listen(this.container,"keydown",this.kd)}ac.prototype.addWhiteList=function(ad){return this.mouseEvents.addWhiteList(ad)};ac.prototype.remove=function(){this.mouseEvents.remove();return T.unlisten(this.container,"keydown",this.kd)};ac.prototype.setScaling=function(ad,ae){this.mouseEvents.scaleX=ad;return this.mouseEvents.scaleY=ae};ac.prototype.addElement=function(ad){ad.animationPriority=ad.animationPriority||0;this.elements.push(ad);this.elementsReverse.splice(0,0,ad);this.animationOrder=this.elements.slice(0);this.animationOrder.sort(function(af,ae){return ae.animationPriority-af.animationPriority});return ad};ac.prototype.removeElement=function(ad){T.removeFromArray(this.elements,ad);T.removeFromArray(this.animationOrder,ad);return T.removeFromArray(this.elementsReverse,ad)};ac.prototype.notifySceneChanges=function(ad){if(!T.hasProperties(ad)){return}T.extendDeep(this.sceneChanges,ad);return this._requestPaint()};ac.prototype.addHook=function(ae,ad,af){if(typeof this.hooks[ad]==="undefined"){this.hooks[ad]=[]}return this.hooks[ad].push({obj:ae,callback:af})};ac.prototype.hook=function(ak,ad,ah){var ag,aj,af,ai,ae;this.chart.log("firing hook",{hook:ak,arg:ad,caller:ah});if(this.hooks[ak]){ai=this.hooks[ak];ae=[];for(aj=0,af=ai.length;aj<af;aj++){ag=ai[aj];ae.push(ag.callback.call(ag.obj,ak,ad,ah))}return ae}};ac.prototype.mdwn=function(ae){var ad;ad=this._notify(ae,"PointerDown");this.pointerToElement[ae.identifier]=ad;this.notifySceneChanges(ae.changes);return this.container.focus()};ac.prototype.mup=function(ad){this._notify(ad,"PointerUp");this.pointerToElement[ad.identifier]=null;return this.notifySceneChanges(ad.changes)};ac.prototype.mdrg=function(ae){var ad;ad=this._notify(ae,"PointerDrag");this.pointerToElement[ae.identifier]=ad;return this.notifySceneChanges(ae.changes)};ac.prototype.mmve=function(ae){var ad;ad=this._notify(ae,"PointerMove");this.pointerToElement[ae.identifier]=ad;return this.notifySceneChanges(ae.changes)};ac.prototype.mlve=function(ad){this._notify(ad,"PointerOut");return this.notifySceneChanges(ad.changes)};ac.prototype.mcc=function(ad){this._notify(ad,"PointerCancel");return this.notifySceneChanges(ad.changes)};ac.prototype.mcl=function(ad){this._notify(ad,"Click");return this.notifySceneChanges(ad.changes)};ac.prototype.rcl=function(ad){this._notify(ad,"RightClick");return this.notifySceneChanges(ad.changes)};ac.prototype.mdbl=function(ad){this._notify(ad,"DoubleClick");return this.notifySceneChanges(ad.changes)};ac.prototype.mw=function(ad){this._notify(ad,"Wheel");return this.notifySceneChanges(ad.changes)};ac.prototype.kd=function(ad){if(!ad.keyCode){ad.keyCode=ad.which}this._notifyKeyEvent(ad,"KeyDown");this.notifySceneChanges(ad.changes);if(ad.consumed){return ad.preventDefault()}};ac.prototype._notify=function(ad,ae){var al,ag,am,aj,ai,an,af,ak,ah;ad.changes={};ad.consumed=false;ad.noDefault=false;ad.cursor=null;am="preview"+ae;ak=this.elementsReverse;for(aj=0,an=ak.length;aj<an;aj++){al=ak[aj];if(al[am]!=null){al[am].call(al,ad)}}am="on"+ae;al=this.pointerToElement[ad.identifier];if(al){if(al[am]!=null){al[am].call(al,ad);if(ad.consumed){if(ad.cursor){this.container.style.cursor=ad.cursor}if(this.verbose){console.log(""+ae+": "+ad.identifier+", c="+ad.consumed)}return al}}}ag=null;ah=this.elementsReverse;for(ai=0,af=ah.length;ai<af;ai++){al=ah[ai];if(al[am]!=null){al[am].call(al,ad);if(ad.consumed){if(ad.cursor){this.container.style.cursor=ad.cursor}if(this.verbose){console.log(""+ae+": "+ad.identifier+", c="+ad.consumed)}return al}else{if((ag==null)&&(ad.cursor!=null)){ag=ad.cursor}}}}this.container.style.cursor=ag;ad.consumed||(ad.consumed=ad.noDefault);if(this.verbose){console.log(""+ae+": "+ad.identifier+", c="+ad.consumed)}return null};ac.prototype._notifyKeyEvent=function(ag,ae){var af,aj,ai,ad,ah;ag.changes={};ag.consumed=false;ag.cursor=null;aj="on"+ae;ah=this.elementsReverse;for(ai=0,ad=ah.length;ai<ad;ai++){af=ah[ai];if(af[aj]!=null){af[aj].call(af,ag);if(ag.consumed){break}}}return null};ac.prototype._requestPaint=function(){if(!this.paintRequested){r(this._paintScene);return this.paintRequested=true}};ac.prototype._paintScene=function(){var an,ag,ae,al,ak,ai,ao,af,ad,am,aj,ah;if(this.chart.removed){return}this.paintRequested=false;ae=new h();ae.time=new Date().getTime();ae.changes=this.sceneChanges;ae["export"]=false;this.sceneChanges={};am=this.elementsReverse;for(al=0,ao=am.length;al<ao;al++){ag=am[al];if(ag.onSceneChange!=null){ag.onSceneChange(ae)}}ae.context=this.prepareContext(ae);aj=this.animationOrder;for(ak=0,af=aj.length;ak<af;ak++){an=aj[ak];if(an.doAnimations!=null){an.doAnimations(ae)}}ah=this.elements;for(ai=0,ad=ah.length;ai<ad;ai++){an=ah[ai];if(an.paintScene!=null){an.paintScene(ae)}}if(ae.animating){return this._requestPaint()}};ac.prototype.prepareContext=function(af){var ae,ad,ag,ah;if(af.changes.bounds){ag=this.chart.scene;this.scaleX=Math.min(ag.canvasScaleX,ag.settings.advanced.maxCanvasWidth/ag.chartWidth);this.scaleY=Math.min(ag.canvasScaleY,ag.settings.advanced.maxCanvasHeight/ag.chartHeight);ah=Math.round(ag.chartWidth*this.scaleX);ad=Math.round(ag.chartHeight*this.scaleY);this.canvas.width=ah;this.canvas.height=ad;this.canvas.style.width=""+ag.chartWidth+"px";this.canvas.style.height=""+ag.chartHeight+"px"}ae=this.canvas.getContext("2d");ae.setTransform(1,0,0,1,0,0);ae.clearRect(0,0,this.canvas.width,this.canvas.height);y.rectStyle(ae,this.settings.area.style);ae.fillRect(0,0,this.canvas.width,this.canvas.height);ae.setTransform(this.scaleX,0,0,this.scaleY,0,0);return ae};ac.prototype.exportGetDimensions=function(ai){var ah,ae,ag,ad,aj,ak,af;ah=this.scene.getChartBounds();ag=ah.right-ah.left;ae=ah.bottom-ah.top;af=parseFloat(ai.width);ad=parseFloat(ai.height);if(af>0&&ad>0){ak=Math.min(af/ag,ad/ae)}else{if(af>0){ak=af/ag;ad=ae*ak}else{if(ad>0){ak=ad/ae;af=ag*ak}else{ak=ai.scaling>0?parseFloat(ai.scaling):1;af=ag*ak*this.scene.canvasScaleX;ad=ae*ak*this.scene.canvasScaleY}}}if(ai.unit==="mm"){if(ai.dpi>0&&ai.width>0&&ai.height>0){aj=parseFloat(ai.dpi)/25.4;ak*=aj;af*=aj;ad*=aj}else{throw"Invalid export configuration. If unit = mm, dpi, width and height must be supplied"}}return[af,ad,ak]};ac.prototype.exportToImage=function(an,ar,aH){var at,am,aj,ah,ak,ap,ao,aC,aD,aB,av,au,az,aq,aG,aJ,aF,aE,ay,ax,aA,ag,aI,aw,al,ai,af,ae,ad;if(this.chart.title){aw=this.chart.title.computeSize(this.chart.layers.canvas.getContext("2d"),true),ay=aw[0],av=aw[1];al=this.chart.title.computeSize(this.chart.layers.canvas.getContext("2d")),ax=al[0],au=al[1]}else{ay=av=ax=au=0}if(this.chart.credits){ai=this.chart.credits.computeSize(this.chart.layers.canvas.getContext("2d"),true),ap=ai[0],aj=ai[1];af=this.chart.credits.computeSize(this.chart.layers.canvas.getContext("2d")),ao=af[0],ah=af[1]}else{ap=aj=ao=ah=0}aG={png:"image/png",jpeg:"image/jpeg"};aq=aG[an];ae=this.exportGetDimensions(ar),aA=ae[0],az=ae[1],aJ=ae[2];am=document.createElement("canvas");am.width=aA;if(av>au){aC=av}else{if(av<au){aC=-au}else{aC=0}}az+=aC*aJ*this.scene.canvasScaleY;if(aj>ah){az+=aj*aJ*this.scene.canvasScaleY}else{if(aj<ah){az-=ah*aJ*this.scene.canvasScaleY}}am.height=az;ak=am.getContext("2d");if(!aH){ak.fillStyle="#fff";ak.fillRect(0,0,am.width,am.height)}at=this.scene.getChartBounds();aF=aJ*this.scene.canvasScaleX;aE=aJ*this.scene.canvasScaleY;ak.setTransform(aF,0,0,aE,-at.left*aF,(-at.top+aC)*aE);aB=new h();aB["export"]=true;aB.time=new Date().getTime();aB.changes={};aB.context=ak;ad=this.elements;for(ag=0,aI=ad.length;ag<aI;ag++){aD=ad[ag];if(aD.paintScene!=null){aD.paintScene(aB)}}return am.toDataURL(aq)};return ac})();var x;x=(function(){function ac(ad){this.scene=ad;if(this.scene.settings.credits.enabledOnExport||this.scene.settings.credits.enabled){this.scene.settings.getAssetImage(this.scene.settings.credits.image)}}ac.prototype.paintScene=function(aj){var af,ah,ae,ai,ag,ak,ad;ae=aj["export"]?this.scene.settings.credits.enabledOnExport:this.scene.settings.credits.enabled;if(!ae){return}ag=this.scene.settings.getAssetImage(this.scene.settings.credits.image);if(ag&&(ag.width||aj["export"])){ak=3;ah=aj.context;ah.save();ah.setTransform(1,0,0,1,0,0);af=ah.canvas;ad=af.width;ai=af.height;ai=ai-ag.height-ak;ah.drawImage(ag,ad-ag.width-ak,ai);return ah.restore()}};ac.prototype.onClick=function(ad){};ac.prototype.computeSize=function(ag,af){var ae,ad;if(af==null){af=false}ae=this.scene.settings.credits;this.lines=[];if(!((ae.enabled&&!af)||(ae.enabledOnExport&&af))){return[0,0]}ad=this.scene.settings.getAssetImage(this.scene.settings.credits.image);return[ad.width/this.scene.canvasScaleX,ad.height/this.scene.canvasScaleY]};return ac})();var K;K=(function(){function ac(ad){this.chart=ad;this.scene=ad.scene;this.lines=[];this.lineSpacing=0}ac.prototype.computeSize=function(al,ad){var at,aj,ai,au,aq,an,ak,af,ar,ao,ap,ae,am,ag,ah;if(ad==null){ad=false}ao=this.scene.settings.title;this.lines=[];if(!(((ao.enabled&&!ad)||(ao.enabledOnExport&&ad))&&ao.text)){return[0,0]}af=2*ao.margin;ar=ao.text;al.save();y.textStyle(al,ao.style);ap=al.measureText(ar).width;aj=al.measureText("M").width;this.lineSpacing=aj*1.4;at=this.scene.chartWidth;if(ap+af>at){ae=0;am=ar.split(" ");au=am[0];ak=al.measureText(au).width;for(ai=ag=1,ah=am.length-1;ag<=ah;ai=ag+=1){aq=au+" "+am[ai];an=al.measureText(aq).width;if(an<=at){au=aq;ak=an}else{this.lines.push(au);ap=Math.max(ap,ak);au=am[ai];ak=al.measureText(au).width}}this.lines.push(au);ap=Math.max(ae,ak)}else{this.lines.push(ar)}al.restore();ap+=af;aj=af+(this.lines.length-1)*this.lineSpacing+aj;return[ap,aj]};ac.prototype.paintScene=function(at){var aj,av,au,ai,ah,an,ar,aw,ay,aq,ao,ap,am,al,ae,ax,ak,ag,af,ad;ay=this.scene.settings.title;aj=at["export"]?ay.enabledOnExport:ay.enabled;if(!(aj&&ay.text)){return}av=at.context;ah=0;aq=0;ak=this.computeSize(av),ao=ak[0],au=ak[1];if(at["export"]){ag=this.computeSize(av,true),ap=ag[0],ai=ag[1];if(ai>au){aq=ai*-1}}aw=this.scene.chartWidth;ar=ay.margin;y.textStyle(av,ay.style);al=aq+ar;av.textBaseline="top";if(ay.align==="left"){av.textAlign="start";am=ah+ar}else{if(ay.align==="right"){av.textAlign="end";am=aw-ar}else{av.textAlign="center";am=(ah+aw)/2}}af=this.lines;ad=[];for(ae=0,ax=af.length;ae<ax;ae++){an=af[ae];av.fillText(an,am,al);ad.push(al+=this.lineSpacing)}return ad};return ac})();var d,ab={}.hasOwnProperty;d=(function(){ac.prototype.animationPriority=0;ac.prototype.scene=null;ac.prototype.touches={};ac.prototype.text=null;ac.prototype.fps=0;ac.prototype.fpsAveragingPeriod=1000;ac.prototype.prevFrame=null;function ac(ad){this.scene=ad;this.scene.frameCount=0;this.touches={}}ac.prototype.paintScene=function(ae){var am,ag,an,al,ai,af,ad,ap,aj,ao,ak,ah;this.scene.frameCount+=1;if(this.prevFrame){ag=Math.max(ae.time-this.prevFrame,1)/1000;an=1/ag;ad=Math.min(1,ag*3);this.fps=this.fps*(1-ad)+an*ad}this.prevFrame=ae.time;al=ae.context;al.strokeStyle="#000";al.fillStyle="#000";al.beginPath();am=0;ak=this.touches;for(ai in ak){if(!ab.call(ak,ai)){continue}ap=ak[ai];am+=1;al.moveTo(ap.dx+10,ap.dy);al.arc(ap.dx,ap.dy,10,0,Math.PI*2);al.moveTo(ap.x+30,ap.y);al.arc(ap.x,ap.y,30,0,Math.PI*2);al.moveTo(ap.dx,ap.dy);ah=ap.trace;for(aj=0,ao=ah.length;aj<ao;aj++){af=ah[aj];al.lineTo(af.x,af.y);al.arc(af.x,af.y,3,0,Math.PI*2)}}al.stroke();al.textAlign="start";al.textBaseline="middle";return al.fillText("FPS: "+(Math.round(this.fps))+", touches: "+am,this.scene.x0+this.scene.width/3,20)};ac.prototype.previewPointerDown=function(af){var ad,ae,ag;ag=this.touches;for(ad in ag){if(!ab.call(ag,ad)){continue}ae=ag[ad];if(ae.up){delete this.touches[ad]}}this.touches[af.identifier]={dx:af.x,dy:af.y,up:false,trace:[]};return af.changes.pointers=true};ac.prototype.previewPointerDrag=function(ae){var ad;ad=this.touches[ae.identifier];ad.x=ae.x;ad.y=ae.y;return ad.trace.push({x:ad.x,y:ad.y})};ac.prototype.previewPointerUp=function(ad){this.touches[ad.identifier].up=true;return this.previewPointerDrag(ad)};ac.prototype.previewPointerCancel=function(ad){this.touches[ad.identifier].up=true;return this.previewPointerDrag(ad)};return ac})();var A;A=(function(){function ac(ad){this.chart=ad;this.container=ad.layers.container;this.scene=ad.scene;this.events=ad.events;this.popup=T.createDom("div","DVSL-info-center",null,this.container);T.createDom("em",null,null,this.popup);this.events.addWhiteList(this.popup);this.popup.style.position="absolute";this.popup.style.display="none";this.contents=null;this.visible=false;this.x0=null;this.x1=null;this.y=null;this.chart.events.addWhiteList(this.popup)}ac.prototype.hide=function(){if(!this.visible){return false}this.visible=false;this.popup.style.display="none";return true};ac.prototype.show=function(ae,ad,ag,af){this.visible=true;if(af){this.popup.style.display="block";this.popup.innerHTML=af;return this.updateXY(ae,ad,ag)}else{return this.popup.style.display="none"}};ac.prototype.updateContents=function(ad){if(!!this.visible){return}if(ad===null){return this.hide()}else{return this.show(this.x0,this.x1,this.y,ad)}};ac.prototype.updateXY=function(ae,ad,ai){var ag,al,ah,af,ak,aj;if(!this.visible){return}this.x0=ae;this.x1=ad;this.y=ai;af=12;ag=10;ak=this.popup.offsetWidth;ah=this.popup.offsetHeight;if(this.scene.x0<=ae-ak-ag){aj=ae-ak-ag;al="DVSL-info-left"}else{if(this.scene.x0+this.scene.width>=ad+ak+ag){aj=ad+ag;al="DVSL-info-right"}else{aj=(ae+ad-ak)/2;al="DVSL-info-center"}}ai=Math.min(Math.max(this.scene.y0+af,ai-ah/2),this.scene.y0+this.scene.height-ah);this.popupX=aj;this.popupY=ai;this.popup.style.left=aj+"px";this.popup.style.top=ai+"px";return T.setClass(this.popup,al)};return ac})();var H,ab={}.hasOwnProperty,n=function(af,ad){for(var ac in ad){if(ab.call(ad,ac)){af[ac]=ad[ac]}}function ae(){this.constructor=af}ae.prototype=ad.prototype;af.prototype=new ae();af.__super__=ad.prototype;return af};H=(function(ac){n(ad,ac);ad.FlatTheme={advanced:{themeCSSClass:"DVSL-flat",assets:["netchart.css"]}};ad.defaults={theme:ad.FlatTheme,data:{format:"JSON",preloaded:null,dataFunction:null,url:null,requestTimeout:40000,cacheSize:10000,random:null,randomGridLinkProbability:0.6,randomNodes:0,randomLinks:0,requestMaxUnits:2,numberOfParralelRequests:3,preloadNodeLinks:false},filters:{nodeFilter:null,linkFilter:null,nodeLinksProcessor:null,multilinkProcessor:null},style:{nodeLabelMinSize:40,nodeDetailMinZoom:0.2,linkLabelMinZoom:3,iconsMinZoom:0.7,iconSize:16,iconNodeDistance:0,iconNodeAngle:-Math.PI/4,nodeDisplay:"image",nodeRadiusExtent:[10,50],linkRadiusExtent:[0.2,10],linkStrengthExtent:[0.1,1],linkLengthExtent:[0.1,50],nodeAutoScaling:null,linkAutoScaling:null,linkStrengthAutoScaling:null,linkLengthAutoScaling:null,nodeRules:{},linkRules:{},selection:{fillColor:"lightblue",sizeConstant:5,sizeProportional:0.2},node:{fillColor:"#4f4",lineColor:null,lineWidth:null,radius:10,shadowColor:null},nodeLocked:{},nodeLabel:{fillColor:"black"},nodeExpanded:{},nodeFocused:{fillColor:"orange"},link:{fillColor:"#6D6",shadowColor:null,fromDecoration:null,toDecoration:null,fromIcons:null,toIcons:null,label:null,radius:1,length:1,strength:1,dashed:false,toPieValue:0,toPieColor:null},linkLabel:{fillColor:"black"},linkLabelBalloon:{fillColor:"#FFF",lineColor:"gray"},nodeLabelBalloon:{fillColor:"rgba(255,255,255,0.7)"},hiddenLinks:{fillColor:"#BBB",lineColor:"#BBB",lineWidth:1,size:3},hoverStyle:{shadowOffsetX:0,shadowOffsetY:0,shadowBlur:12,shadowColor:"blue"},removedColor:"#EEE"},layout:{nodeSpacing:16,multilinkSpacing:10,layoutMode:"dynamic",layoutFreezeTimeout:1500,fadeTime:600,globalLayoutOnChanges:true},events:{},info:{enabled:false,nodeContentsFunction:null,linkContentsFunction:null},interaction:{zooming:{doubleClickZoom:1.5,zoomExtent:[0.1,8],autoZoom:true,sensitivity:1,wheel:true,fingers:true,autoZoomDuration:500},selection:{enabled:true,nodesSelectable:true,linksSelectable:true,lockNodesOnMove:true,tolerance:10}},navigation:{mode:"showall",initialNodes:null,focusNodeExpansionRadius:2,focusHistoryRelevanceCooldown:0.6,focusAutoFadeout:true,numberOfFocusNodes:3,expandDelay:400,expandOnClick:true,autoZoomOnFocus:false,nodeAutoExpandFilter:null},nodeMenu:{enabled:true,buttons:["hide","expand","focus","lock"],showData:false,contentsFunction:null},linkMenu:{enabled:true,showData:false,contentsFunction:null},advanced:{perNodeLoadingIndicator:true,style:{loadingArcStyle:{r:35,lineColor:"red",lineWidth:5,location:"corner"}}},localization:{loadingLabel:"Loading...",closeButton:"Close",menu:{dynaminc:"Dynamic",fixed:"Fixed",focus:"Focus",unfocus:"Unfocus",collapse:"Collapse",expand:"Expand",hide:"Hide"}}};function ad(ae){ad.__super__.constructor.call(this,"netchart");this.apply(ad.defaults);this.apply(ae)}ad.prototype.apply=function(ag){var af,aj,ah,ai,ae;af=ad.__super__.apply.call(this,ag);if(ag.style){if(ag.style.nodeRules){ai=ag.style.nodeRules;for(aj in ai){ah=ai[aj];this.style.nodeRules[aj]=ah}}if(ag.style.linkRules){ae=ag.style.linkRules;for(aj in ae){ah=ae[aj];this.style.linkRules[aj]=ah}}}return af};return ad})(I);var O,j=function(ac,ad){return function(){return ac.apply(ad,arguments)}},ab={}.hasOwnProperty;O=(function(){ac.prototype.container=null;ac.prototype.settings=null;ac.prototype.scene=null;ac.prototype.layers=null;ac.prototype.removed=false;ac.prototype.EVENT_NAMES=null;ac.prototype.curState=null;ac.prototype.goingBack=false;ac.prototype.chartUpdateOrigin=null;ac.prototype.currentNavigationState=null;ac.prototype.previousSizeW=0;ac.prototype.previousSizeH=0;ac.prototype.onAssetsLoaded=function(){return T.error("Need to override onAssetsLoaded")};ac.prototype.onRemove=function(){return T.error("Need to override onRemove")};ac.prototype.onSizeChanged=function(ae,ad){return T.error("Need to override onSizeChanged")};ac.prototype.onSettingsChanged=function(ad){return T.error("Need to override onSettingsChanged")};function ac(af){this.loadAssets=j(this.loadAssets,this);this.defaultError=j(this.defaultError,this);this.chartUpdateNotify=j(this.chartUpdateNotify,this);this._windowResize=j(this._windowResize,this);var ae,ad,ah,ag;if(!this.EVENT_NAMES){this.EVENT_NAMES={};ag=af.events;for(ad in ag){ah=ag[ad];this.EVENT_NAMES[ad]=ad;if(ad.indexOf("on")===0){ae=ad[2].toLowerCase()+ad.slice(3);this.EVENT_NAMES[ae]=ad}}}if(!af.container){throw"Chart container not set"}if(!(af.container.nodeType>0)){throw"Chart container not a dom object"}}ac.prototype.initialize=function(ae){var ad,ah,ag,af;this.api=ae;this.eventListeners={};this.assetsLoaded=true;this.loadedAssets={};this.imgAssets={};if(this.settings.advanced.assets!=null){this.loadAssets(this.settings.advanced.assets)}ad=T.detectBrowser();af=T.canvasScaling(),ah=af[0],ag=af[1];if((this.settings.advanced.highDpi.hasOwnProperty(ad)&&this.settings.advanced.highDpi[ad])||this.settings.advanced.highDpi["default"]){this.scene.canvasScaleX=ah;this.scene.canvasScaleY=ag}else{this.scene.canvasScaleX=1;this.scene.canvasScaleY=1}this.container=this.settings.container;if(this.container._DVSL_ChartInstance!==void 0&&this.container._DVSL_ChartInstance!==null){this.container._DVSL_ChartInstance.remove()}this.container._DVSL_ChartInstance=this;this.container.appendChild(this.layers.container);this.events=new Z(this.layers.mouseTrackLayer,this.layers.canvas,this);if(this.settings.advanced.trackTouches){this.events.addElement(new d(this.scene))}T.listen(window,"resize",this._windowResize);return this.api._impl=this};ac.prototype.updateSettings=function(ad,af){var ag,ae;if(af==null){af=null}this.log("Update Settings, "+(JSON.stringify(ad)));ae=T.clone(this.settings.events);ag=this.settings.apply(ad);if(this.removed){return}if(ag.events){this.updateEvents(ae,this.settings.events)}if(ag.advanced&&ag.advanced.assets){this.loadAssets(this.settings.advanced.assets)}if(ag.width||ag.height||ag.maxWidth||ag.minWidth||ag.minHeight||ag.maxHeight){this.updateSize(true)}this.onSettingsChanged(ag);this.events.notifySceneChanges({settings:true});if(af){return this.notifySettingsChanged(ag,af)}};ac.prototype.remove=function(){this.removed=true;this.events.remove();this.container.removeChild(this.layers.container);this.onRemove();this.layers=null;this.scene=null;this.events=null;this.container._DVSL_ChartInstance=void 0;return T.unlisten(window,"resize",this._windowResize)};ac.prototype._windowResize=function(){return this.updateSize(false)};ac.prototype.updateSize=function(ag){var ad,ah,af,ae;if(ag==null){ag=false}if(this.removed){return}ah=this.settings.width;ad=this.settings.height;ae=0;af=0;if(this.layers.container.style.display!==""){ae=this.settings.minWidth;af=this.settings.minHeight}if(!ah){ah=parseInt(Math.max(ae,Math.min(this.settings.maxWidth,this.scene.settings.container.clientWidth)))}if(!ad){ad=parseInt(Math.max(af,Math.min(this.settings.maxHeight,this.scene.settings.container.clientHeight)))}if(ah!==this.previousSizeW||ad!==this.previousSizeH||ag){this.log("Update size, "+ad+", "+ah);this.previousSizeH=ad;this.previousSizeW=ah;this.scene.chartHeight=ad;this.scene.chartWidth=ah;return this.onSizeChanged(ah,ad)}};ac.prototype.on=function(ae,ad){if(!this.eventListeners[ae]){this.eventListeners[ae]=[]}return this.eventListeners[ae].push(ad)};ac.prototype.off=function(ae,ad){if(this.eventListeners[ae]!=null){return T.removeFromArray(this.eventListeners[ae],ad)}};ac.prototype.updateEvents=function(ai,ad){var af,ah,ag,ae;ag=this.EVENT_NAMES;ae=[];for(af in ag){ah=ag[af];if(ai[ah]!=null){this.off(af,ai[ah])}if(ad[ah]!=null){ae.push(this.on(af,ad[ah]))}else{ae.push(void 0)}}return ae};ac.prototype.notifyHoverChanged=function(ad){ad.origin="user";return this.dispatchEventParams("hoverChange",this.extendEventParams(ad),null)};ac.prototype.notifyDoubleClick=function(ad){ad.origin="user";return this.dispatchEvent("doubleClick",this.extendEventParams(ad),this.defaultDoubleClick)};ac.prototype.notifyRightClick=function(ad){ad.origin="user";return this.dispatchEvent("rightClick",this.extendEventParams(ad),this.defaultRightClick)};ac.prototype.notifyClick=function(ad){ad.origin="user";return this.dispatchEvent("click",this.extendEventParams(ad),this.defaultClick)};ac.prototype.notifyAnimationDone=function(){return this.dispatchEventParams("animationDone",this.extendEventParams({}),null)};ac.prototype.notifySelectionChanged=function(ad){return this.dispatchEventParams("selectionChange",this.extendEventParams({origin:ad}),null)};ac.prototype.notifySettingsChanged=function(ae,ad){return this.dispatchEventParams("settingsChange",this.extendEventParams({changes:ae,origin:ad}),null)};ac.prototype.notifyChartUpdate=function(ad){var af,ae;ae=this.scene.settings.events.chartUpdateDelay;af=new Date().getTime();if(ad){this.chartUpdateWasBack=this.goingBack;this.chartUpdateOrigin=ad;this.chartUpdateTime=af}ae=this.chartUpdateTime+ae-af;if(ae>0){return this.chartUpdateTimeout=setTimeout(this.chartUpdateNotify,ae)}else{return this.chartUpdateNotify()}};ac.prototype.cancelChartUpdateNotify=function(){this.chartUpdateOrigin=null;if(this.chartUpdateTimeout){clearTimeout(this.chartUpdateTimeout);return this.chartUpdateTimeout=null}};ac.prototype.chartUpdateNotify=function(){var ad,ae;if(!this.chartUpdateOrigin){return}ae=this.saveNavigation();if(ae&&(!this.curState||JSON.stringify(ae)!==JSON.stringify(this.curState))){if(!this.chartUpdateWasBack&&this.curState){this.scene.pushBack(this.curState)}this.curState=ae;ad=this.chartUpdateOrigin;this.chartUpdateOrigin=null;return this.doChartUpdateNotify(ad)}};ac.prototype.back=function(ae,ad){var af;if(ae==null){ae=true}if(ad==null){ad="api"}if(this.scene.backStack.length===0){return false}af=this.scene.backStack.pop();this.goingBack=true;this.restoreNavigation(af,ae,ad);return this.goingBack=false};ac.prototype.saveNavigation=function(){return T.error("Need to override saveNavigation")};ac.prototype.restoreNavigation=function(af,ae,ad){return T.error("Need to override restoreNavigation")};ac.prototype.doChartUpdateNotify=function(ad){return this.dispatchEventParams("chartUpdate",this.extendEventParams({origin:ad}),null)};ac.prototype.dispatchEventParams=function(ae,ai,ad){var ag,af,ah;if(!(ad||((this.eventListeners[ae]!=null)&&this.eventListeners[ae].length>0))){return{}}ag=T.createEvent(ae);ag.chart=this.api;for(af in ai){if(!ab.call(ai,af)){continue}ah=ai[af];if(ag[af]===void 0){ag[af]=ah}}return this.dispatchEvent(ae,ag,ad)};ac.prototype.dispatchEvent=function(ag,ah,ad){var af,aj,ae,ai;if(!(ad||((this.eventListeners[ag]!=null)&&this.eventListeners[ag].length>0))){return ah}if(this.eventListeners[ag]!=null){ai=this.eventListeners[ag];for(aj=0,ae=ai.length;aj<ae;aj++){af=ai[aj];this.log("Call user event handler, "+ag,ah);af.call(this.api,ah)}}if(!ah.defaultPrevented&&(ad!=null)){this.log("Call default event handler, "+ag);ad.call(this.api,ah)}return ah};ac.prototype.error=function(ae,ad){return this.dispatchEventParams("error",{message:ae,arg:ad},this.defaultError)};ac.prototype.log=function(ae,ad){if(this.settings.advanced.logging){return T.log(ae,ad)}};ac.prototype.defaultError=function(ad){if(this.settings.events.onError){this.settings.events.onError(ad)}return T.error(ad.message,ad.arg?ad.arg:null)};ac.prototype.loadAssets=function(){var ag,af,ae,ai,ad,ah,aj=this;af=null;ah=this.settings.advanced.assets;for(ai=0,ad=ah.length;ai<ad;ai++){ag=ah[ai];if(!this.loadedAssets.hasOwnProperty(ag)){af=ag;break}}if(af){if(this.assetsLoaded){this.log("Loading assets")}this.assetsLoaded=false;ae=function(ak){if(aj.removed){return}if(!aj.credits){aj.credits=aj.events.addElement(new x(aj.scene))}aj.loadedAssets[ak]=true;return aj.loadAssets()};return this.loadAsset(af,ae)}else{if(!this.assetsLoaded){this.log("Chart assets loaded");this.onAssetsLoaded()}return this.assetsLoaded=true}};ac.prototype.loadAsset=function(af,ai){var ag,ae,ad,ah=this;ad=af.src;ad=this.settings.getAssetUrl(af);ae=T.getExtension(af);if(ae==="css"){ag=document.createElement("link");ag.setAttribute("rel","stylesheet");ag.setAttribute("href",ad);ag.setAttribute("type","text/css");ag.addEventListener("load",function(){return ai(af)});ag.addEventListener("error",function(){ah.error("Assets: Failed to load asset",af);return ai(af)});document.getElementsByTagName("head")[0].appendChild(ag);return setTimeout(function(){var aj;if(!ah.loadedAssets.hasOwnProperty(af)&&!ah.imgAssets.hasOwnProperty(af)){ah.imgAssets[af]=true;aj=document.createElement("img");aj.onerror=function(){return ai(af)};return aj.src=ad}},200)}else{if(ae==="js"){ag=document.createElement("script");ag.setAttribute("src",ad);ag.setAttribute("type","text/javascript");ag.addEventListener("load",function(){return ai(af)});ag.addEventListener("error",function(){ah.error("Assets: Failed to load asset",af);return ai(af)});return document.getElementsByTagName("head")[0].appendChild(ag)}else{this.error("Assets: Do not know how to load",af);return ai(af)}}};return ac})();var W;W=(function(){ac.prototype.chart=null;ac.prototype.oh=0;ac.prototype.sy=0;ac.prototype.barVisible=false;ac.prototype.resizing=false;ac.prototype.enabled=false;function ac(ad){this.chart=ad;this.scene=this.chart.scene;this.layers=this.chart.layers}ac.prototype.onSceneChange=function(ad){if(T.hasProp(ad,"changes/settings")){return this.enabled=this.scene.settings.interaction.resizing.enabled}};ac.prototype.onPointerOut=function(ad){if(!this.enabled){return}return this.hideUI()};ac.prototype.onPointerMove=function(ae){var ad;if(!this.enabled){return}ad=this.scene.chartHeight-ae.y;if(ad<this.scene.settings.interaction.resizing.advanced.resizerHandleVisibilityTolerance){if(!this.barVisible){this.showUI()}if(ad<this.scene.settings.interaction.resizing.advanced.resizerHandleEnableTolerance){ae.consumed=true;return ae.cursor="ns-resize"}}else{if(this.barVisible){return this.hideUI()}}};ac.prototype.onPointerDown=function(ae){var ad;if(!this.enabled){return}this.sy=ae.y;ad=this.scene.chartHeight-ae.y;this.resizing=ad<this.scene.settings.interaction.resizing.advanced.resizerHandleEnableTolerance&&ae.y<=this.scene.chartHeight;if(this.resizing){this.oh=this.scene.chartHeight;this.showUI();ae.cursor="ns-resize";return ae.consumed=true}};ac.prototype.onDoubleClick=function(ag){var ad,af,ae;if(!this.enabled){return}this.sy=ag.y;ad=this.scene.chartHeight-ag.y;if(ad<this.scene.settings.interaction.resizing.advanced.resizerHandleEnableTolerance&&ag.y<=this.scene.chartHeight){ag.consumed=true;if(this.wasMaximized){af=this.originalHeight;this.wasMaximized=false}else{this.originalHeight=this.oh;this.wasMaximized=true;ae=T.getScroll();af=this.oh+ae[1]+window.innerHeight-ag.pageY-ad-10}this.scene.settings.height=Math.min(this.scene.settings.maxHeight,Math.max(this.scene.settings.minHeight,af));return this.chart.updateSize()}};ac.prototype.onPointerDrag=function(ad){if(!this.enabled){return}if(this.resizing){ad.consumed=true;this.wasMaximized=false;this.scene.settings.height=Math.min(this.scene.settings.maxHeight,Math.max(this.scene.settings.minHeight,this.oh+(ad.y-this.sy)));return this.chart.updateSize()}};ac.prototype.showUI=function(){if(this.barVisible){return}this.barVisible=true;return T.fadeIn(this.layers.resizerBar)};ac.prototype.hideUI=function(){if(!this.barVisible){return}this.barVisible=false;this.resizing=false;return T.fadeOut(this.layers.resizerBar)};return ac})();var P;P=(function(){ac.prototype.animationPriority=0;ac.prototype.scene=null;ac.prototype.loadingTime=null;function ac(ad){this.chart=ad;this.scene=ad.scene}ac.prototype.doAnimations=function(ad){if(this.scene.loading){return ad.animating=true}};ac.prototype.paintScene=function(ae){var ao,am,aj,aq,ar,ah,ag,ad,ai,ap,af,an,al,ak;ai=this.scene;ag=this.scene.getMessage();ah=this.scene.loading;if(!ah){this.loadingTime=null}if(!((ag!=null)||ah)){return}if(this.loadingTime==null){this.loadingTime=ae.time}am=this.scene.settings.advanced.style.loadingArcStyle;aj=ae.context;if(am.location==="corner"){an=ai.x0+ai.width;al=ai.y0}else{an=ai.x0+ai.width/2;al=ai.y0+ai.height/2}if(ag!=null){y.textStyle(aj,this.scene.settings.advanced.style.messageTextStyle);aj.textBaseline="middle";aj.textAlign="center";ar=aj.measureText("M").width*1.5;af=aj.measureText(ag).width;if(am.location==="corner"){an-=af;al+=ar*1.5}if(this.scene.loading){al-=ar;ak=al+am.r+ar}else{ak=al}aj.fillText(ag,an,ak)}if(this.scene.loading){ad=am.r;ap=am.lineWidth;if(!ag&&am.location==="corner"){an-=(ad+ap)*1.2;al+=(ad+ap)*1.2}aj.save();aj.lineCap="round";aj.lineWidth=ap;ao=(ae.time-this.loadingTime)/700*Math.PI;aq=aj.createLinearGradient(an+ad*Math.cos(ao+Math.PI),al+ad*Math.sin(ao+Math.PI),an+ad*Math.cos(ao),al+ad*Math.sin(ao));aq.addColorStop(0,am.lineColor);aq.addColorStop(1,"transparent");aj.strokeStyle=aq;aj.beginPath();aj.arc(an,al,ad,ao,ao+Math.PI);aj.stroke();return aj.restore()}};return ac})();var u;u=(function(){ac.prototype.scene=null;ac.prototype.events=null;ac.prototype.animationPriority=999;function ac(ad){this.chart=ad;this.scene=ad.scene;this.events=ad.events;this.imageCache={};this.multilinks={}}ac.prototype.onSceneChange=function(ae){var ad;return ad=ae.changes};ac.prototype.doAnimations=function(ad){};ac.prototype.getImage=function(ad){var ae;ae=this.imageCache[ad];if(!ae){ae=new Image();ae.src=this.scene.settings.getAssetUrl(ad);this.imageCache[ad]=ae}if(ae.width>0){return ae}else{return null}};ac.prototype.getNodeImage=function(ah){var ae,af,ag,ad;if(!ah.image){return null}af=ah.image;ag=null;if(ah.tintImage&&ah.fillColor){ag=af;af+="##"+ah.fillColor}if(this.imageCache[af]==null){if(ag){ad=this.getImage(ag);if(ad!=null){this.imageCache[af]=y.applyColorToImage(ad,ah.fillColor,false)}}else{this.getImage(af)}}ae=this.imageCache[af];if((ae!=null)&&ae.width){return ae}else{return null}};ac.prototype.paintScene=function(af){var ae,ad,ag;ag=this.makeHoveredLast(this.scene.nodes,this.scene.hoverNode);ad=this.makeHoveredLast(this.scene.links,this.scene.hoverLink);this.scene.updateMultilinks();this.scene.clearModified();this.computeNodeRenderRadii();ae=af.context;this.paintSelection(ae);this.paintLinks(ae);af.animating|=this.paintNodes(ae,af.time);this.restoreHovered(this.scene.nodes,ag);return this.restoreHovered(this.scene.links,ad)};ac.prototype.getGeometry=function(){var ah,an,ap,ai,aj,af,ad,ao,am,al,ag,ae,aq,ak;ak=this.scene.toDisplayTransform(),an=ak[0],ah=ak[1],ai=ak[2],ap=ak[3];aj=this.scene.x0;ad=this.scene.x0+this.scene.width;am=this.scene.y0;ag=this.scene.y0+this.scene.height;af=(aj-ah)/an;ao=(ad-ah)/an;al=(am-ap)/ai;ae=(ag-ap)/ai;aq=this.scene.zoom;return[an,ah,ai,ap,aq,aj,ad,am,ag,af,al,ao,ae]};ac.prototype.makeHoveredLast=function(aj,ag){var af,ad,ah,ak,ai,ae;ad=aj.length;if(ad<2||!ag||ag===aj[ad-1]){return ad-1}for(af=ai=0,ae=aj.length;ai<ae;af=++ai){ak=aj[af];if(ak===ag){ah=aj[ad-1];aj[ad-1]=ag;aj[af]=ah;return af}}return ad-1};ac.prototype.restoreHovered=function(af,ag){var ad,ae;ad=af.length;if(ag!==ad-1){ae=af[ag];af[ag]=af[ad-1];return af[ad-1]=ae}};ac.prototype.computeNodeRenderRadii=function(){var ai,ah,af,ag,ak,ae,aj,ad;ag=this.scene.zoom;aj=this.scene.nodes;ad=[];for(ak=0,ae=aj.length;ak<ae;ak++){ai=aj[ak];ah=ai.currentRadius*ag;af=ai.currentHwidth*ag;if(ai.lineWidth){ah+=ai.lineWidth/2;af+=ai.lineWidth/2}ai.renderRadius=ah;ad.push(ai.renderHwidth=af)}return ad};ac.prototype.paintLinks=function(bh){var ba,a5,aS,aR,aQ,ak,aj,ai,be,aq,bg,av,au,aJ,am,aH,ap,aP,aO,aB,aZ,a7,ax,a1,ar,aX,aN,bk,bi,ah,bb,a4,aC,ay,aU,aV,aT,aK,aw,af,bj,aY,aW,ae,aG,aM,aL,at,ao,aF,bf,a9,ad,aE,aA,al,ag,bl,a3,a0,an,a8,bd,bc,aI,a2,aD,az,a6;a2=this.getGeometry(),aw=a2[0],aK=a2[1],bj=a2[2],af=a2[3],a8=a2[4],at=a2[5],bf=a2[6],al=a2[7],a3=a2[8],ao=a2[9],ag=a2[10],a9=a2[11],a0=a2[12];bh.textAlign="center";bh.textBaseline="middle";a7=this.scene.multilinks;aH=this.scene.settings.style.linkLabelMinZoom;ax=this.scene.settings.style.nodeDetailMinZoom;ap=this.scene.settings.layout.multilinkSpacing*a8;aX=a8>this.scene.settings.style.iconsMinZoom;aq=this.scene.settings.style.iconSize/2;bb=2;bi=5;ah=0.1;aD=this.scene.links;a6=[];for(bd=0,aI=aD.length;bd<aI;bd++){am=aD[bd];aG=am.from.x;ad=am.from.y;aF=am.to.x;bl=am.to.y;if(Math.max(aG,aF)<ao||Math.min(aG,aF)>a9||Math.max(ad,bl)<ag||Math.min(ad,bl)>a0){continue}aG=aG*aw+aK;ad=ad*bj+af;aF=aF*aw+aK;bl=bl*bj+af;a4=Math.max(0.25,am.currentRadius*a8*0.5);aC=am.from.renderRadius;ay=am.to.renderRadius;aY=am.from.renderHwidth;aW=am.to.renderHwidth;aj=aF-aG;ai=bl-ad;aJ=Math.sqrt(aj*aj+ai*ai);ba=am===this.scene.hoverLink||am.from===this.scene.hoverNode||am.to===this.scene.hoverNode;ar=ba||a8>ax;if(am.toPieValue>0&&ar){aN=ay+bb;bk=aN+bi+ah*ay;this.paintLinkPie(bh,aF,bl,aN,bk,am.toPie0,am.toPie1,am.toPieColor);ay=bk}if(aJ<aC+ay){continue}bg=1/aJ;aR=aj*bg;aQ=ai*bg;if(aC>=aY){aV=aC}else{if(aQ===0){aV=aY}else{an=T.sign(aQ);aV=aC/aQ*an;if(Math.abs(aR*aV)>aY-aC){aV=a.rayIntersectsCircleOuter(-(aY-aC),0,Math.abs(aR),aQ,aC)}}}if(ay===aW){aT=ay}else{if(aQ===0){aT=aW}else{an=T.sign(aQ);aT=ay/aQ*an;if(Math.abs(aR*aT)>aW-ay){aT=a.rayIntersectsCircleOuter(-(aW-ay),0,Math.abs(aR),aQ,ay)}}}if(aJ<=aV+aT){continue}if(ar){ak=Math.min(aJ/3,Math.max(2,a4*2));if(am.fromDecoration){aV+=ak}if(am.toDecoration){aT+=ak}}aG+=aR*aV;ad+=aQ*aV;aF-=aR*aT;bl-=aQ*aT;aj=aF-aG;ai=bl-ad;aJ=aJ-aC-ay;bg=1/aJ;aZ=am.multiId;aB=a7[aZ];if(T.isArray(aB)){a5=aB.length;ae=Math.min(ap,aC,ay);a1=ae*(aB.indexOf(am)-(a5-1)/2)/(a5-1);if(am.from.id>am.to.id){aG+=aQ*a1;aF+=aQ*a1;ad-=aR*a1;bl-=aR*a1}else{aG-=aQ*a1;aF-=aQ*a1;ad+=aR*a1;bl+=aR*a1}}bh.beginPath();if(ar){if(am.fromDecoration){this.paintLinkDecoration(bh,aG,ad,aR,aQ,ak,am.fromDecoration,am.fillColor)}if(am.toDecoration){this.paintLinkDecoration(bh,aF,bl,-aR,-aQ,ak,am.toDecoration,am.fillColor)}}if(am.dashed){aM=aG+aQ*a4;aE=ad-aR*a4;aL=aG-aQ*a4;aA=ad+aR*a4;aS=Math.max(5,a4*3);for(be=bc=0,az=aJ/aS;bc<=az;be=bc+=2){av=be*aS;au=Math.min((be+1)*aS,aJ);bh.moveTo(aM+av*aR,aE+av*aQ);bh.lineTo(aL+av*aR,aA+av*aQ);bh.lineTo(aL+au*aR,aA+au*aQ);bh.lineTo(aM+au*aR,aE+au*aQ);bh.closePath()}}else{bh.moveTo(aG+aQ*a4,ad-aR*a4);bh.lineTo(aG-aQ*a4,ad+aR*a4);bh.lineTo(aF-aQ*a4,bl+aR*a4);bh.lineTo(aF+aQ*a4,bl-aR*a4);bh.closePath()}y.fill(bh,am);if(aX){bh.lineWidth=1;bh.strokeStyle=am.fillColor;if(am.fromIcons&&am.fromIcons.length){this.paintLinkIcons(bh,aG,ad,aR,aQ,aJ,aq,am.fromIcons)}if(am.toIcons&&am.toIcons.length){this.paintLinkIcons(bh,aF,bl,-aR,-aQ,aJ,aq,am.toIcons)}}if((a8>aH||ba)&&(am.label!=null)&&!am.removed){aU=""+am.label;if(aU.length>0){aP=aG+aj*0.5;aO=ad+ai*0.5;a6.push(this.paintLabel(bh,aP,aO,am))}else{a6.push(void 0)}}else{a6.push(void 0)}}return a6};ac.prototype.paintNodes=function(a0,aT){var ay,a2,ax,az,av,a3,at,aI,aE,aj,aC,ah,aA,aF,ao,aO,aH,aR,aD,aQ,aG,aS,aw,an,ae,a1,aM,ad,aK,am,ai,aZ,aV,aB,aJ,ag,af,aP,aL,aU,aY,aX,aW,au,al,ak,aN,ar,aq,ap;ay=Math.PI*2;ax=false;aN=this.getGeometry(),an=aN[0],aw=aN[1],a1=aN[2],ae=aN[3],aU=aN[4],am=aN[5],aZ=aN[6],ag=aN[7],aP=aN[8],ai=aN[9],af=aN[10],aV=aN[11],aL=aN[12];ao=this.scene.settings.style.nodeDetailMinZoom;aO=this.scene.settings.style.nodeLabelMinSize/2;aI=this.scene.settings.style.iconNodeAngle;aH=aU>this.scene.settings.style.iconsMinZoom;aE=this.scene.settings.style.iconNodeDistance;a3=this.scene.settings.style.hiddenLinks;aj=this.scene.settings.style.iconSize/2;az=this.scene.settings.style.nodeDisplay==="text";a0.textAlign="center";a0.textBaseline="middle";y.textStyle(a0,this.scene.settings.style.nodeLabel);aA=a0.measureText("M").width;ar=this.scene.nodes;for(aY=0,au=ar.length;aY<au;aY++){aF=ar[aY];if(!aF.data){continue}aK=aF.x;aJ=aF.y;aD=aF.renderRadius;aR=aF.currentRadius;aM=aF.currentHwidth;if(aK+aD<ai||aK-aD>aV||aJ+aD<af||aJ-aD>aL){continue}aK=aK*an+aw;aJ=aJ*a1+ae;aR=aR*aU;aM=aM*aU;if(aF.highlight){this.paintHilight(a0,aK,aJ,aD,aM,aU,aF.highlight)}if(!aF.removed&&aU>=ao){at=aF.dataLinks.length-aF.links.length;if(at>0){this.paintHiddenLinks(a0,aF,aK,aJ,aR,at,a3,a3.size*aU)}}a0.beginPath();if(aR!==aM){aB=aK+aM-aR;a0.moveTo(aB,aJ-aR);a0.arc(aB,aJ,aR,-Math.PI/2,Math.PI/2,false);aB=aK-aM+aR;a0.lineTo(aB,aJ+aR);a0.arc(aB,aJ,aR,Math.PI*0.5,Math.PI*1.5,false);a0.closePath()}else{a0.moveTo(aK+aR,aJ);a0.arc(aK,aJ,aR,0,ay)}y.paint(a0,aF);if(aU>=ao||aF.active){ah=aK-aM;aC=this.getNodeImage(aF);if(aC!=null){if(aF.imageSlicing){aQ=aF.imageSlicing;a0.drawImage(aC,aQ[0],aQ[1],aQ[2],aQ[3],ah,aJ-aR,aR*2,aR*2)}else{a0.drawImage(aC,0,0,aC.width,aC.height,ah,aJ-aR,aR*2,aR*2)}ah+=aR*2}if(!aF.removed){if(aH&&aF.icons&&aF.icons.length){this.paintNodeIcons(a0,aK-aM+aR,aJ,aR+aE,aI,aj,aF.icons)}}if((aF.label!=null)&&az&&aR>2){a0.save();aG=1.6*aR/aA;y.textStyle(a0,aF.labelStyle);a0.transform(aG,0,0,aG,(ah+aK+aM)/2,aJ);a0.fillText(aF.label,0,0);a0.restore()}}}if(!az){aq=this.scene.nodes;for(aX=0,al=aq.length;aX<al;aX++){aF=aq[aX];if(!((aF.label!=null)&&!aF.removed&&aF.renderRadius>aO)){continue}aK=aF.x*an+aw;aJ=aF.y*a1+ae;if(aF.labelLocation==="inside"){aJ+=aF.currentRadius*aU/2}else{if(aF.labelLocation==="center"){1}else{aD=aF.renderRadius;aJ+=aD+aA}}this.paintLabel(a0,aK,aJ,aF)}}if(this.scene.settings.advanced.perNodeLoadingIndicator){aS=this.scene.settings.advanced.style.loadingArcStyle;ad=aS.lineWidth;a0.save();a0.lineCap="round";a0.lineWidth=ad;a2=aT/1400;a2=(a2-Math.floor(a2))*(Math.PI*2);ap=this.scene.nodes;for(aW=0,ak=ap.length;aW<ak;aW++){aF=ap[aW];if(aF.loading){ax=true;aK=aF.x*an+aw;aJ=aF.y*a1+ae;aR=aF.currentRadius*aU;if(aK-aR<am||aK+aR>aZ||aJ-aR<ag||aJ+aR>aP){continue}av=a0.createLinearGradient(aK+aR*Math.cos(a2+Math.PI),aJ+aR*Math.sin(a2+Math.PI),aK+aR*Math.cos(a2),aJ+aR*Math.sin(a2));av.addColorStop(0,aS.lineColor);av.addColorStop(1,"transparent");a0.strokeStyle=av;a0.beginPath();a0.arc(aK,aJ,aR,a2,a2+Math.PI);a0.stroke()}}a0.restore()}return ax};ac.prototype.paintSelection=function(aO){var au,aC,aw,av,ai,ah,aB,aA,ax,ae,ar,aJ,az,at,am,af,aP,aF,aE,ap,al,ak,ao,aN,aK,ay,aD,ad,aj,ag,aQ,aI,aG,aL,aM,aq,aH,an;if(!(this.scene.selection.length>0)){return}aH=this.getGeometry(),am=aH[0],at=aH[1],aP=aH[2],af=aH[3],aL=aH[4],al=aH[5],aN=aH[6],aj=aH[7],aI=aH[8],ak=aH[9],ag=aH[10],aK=aH[11],aG=aH[12];au=Math.PI*2;az=this.scene.settings.style.selection;ar=az.sizeProportional;aC=az.sizeConstant;aO.beginPath();an=this.scene.selection;for(aM=0,aq=an.length;aM<aq;aM++){ae=an[aM];aJ=(ae.currentRadius*(1+ar)+aC)*aL;if(ae.isNode){aF=(ae.currentHwidth-ae.currentRadius)*aL+aJ;aE=ae.x*am+at;aD=ae.y*aP+af;ay=aE+aF-aJ;aO.moveTo(ay,aD-aJ);aO.arc(ay,aD,aJ,-Math.PI/2,Math.PI/2,false);ay=aE-aF+aJ;aO.lineTo(ay,aD+aJ);aO.arc(ay,aD,aJ,Math.PI*0.5,Math.PI*1.5,false);aO.closePath()}else{if(ae.isLink){aA=ae.from;ax=ae.to;ap=aA.x*am+at;ad=aA.y*aP+af;ao=ax.x*am+at;aQ=ax.y*aP+af;ai=ap-ao;ah=ad-aQ;aB=aJ/Math.sqrt(ai*ai+ah*ah);aw=ai*aB;av=ah*aB;aO.moveTo(ap+av,ad-aw);aO.lineTo(ap-av,ad+aw);aO.lineTo(ao-av,aQ+aw);aO.lineTo(ao+av,aQ-aw);aO.closePath()}}}return y.paint(aO,az)};ac.prototype.paintLabel=function(ag,ak,aj,ae){var af,ah,ai,am,ad,al;ah=ae.currentLabel;al=ae.label;ai=ae.labelStyle;af=ae.labelBackground;y.textStyle(ag,ai);if(!ah||ah[0]!==ai.font){ad=ag.measureText(al).width;am=ag.measureText("M").width;ae.currentLabel=[ai.font,ad,am]}else{ad=ah[1];am=ah[2]}if(af!=null){ag.beginPath();y.strokeBalloon2(ag,ak,aj,ad,am);y.paint(ag,af);y.textStyle(ag,ai)}return ag.fillText(al,ak,aj)};ac.prototype.paintLinkDecoration=function(aj,ad,ak,ag,ae,ai,ah,af){aj.fillStyle=af;if(ah==="circle"){aj.moveTo(ad+ai,ak);return aj.arc(ad,ak,ai,0,Math.PI*2)}else{if(ah==="arrow"){aj.moveTo(ad-ag*ai,ak-ae*ai);aj.lineTo(ad+ag*ai-ae*ai,ak+ae*ai+ag*ai);return aj.lineTo(ad+ag*ai+ae*ai,ak+ae*ai-ag*ai)}}};ac.prototype.paintLinkPie=function(ai,al,ak,aj,ah,af,ae,ag){var ad,am;ad=(aj+ah)/2;am=ah-aj;ai.beginPath();ai.arc(al,ak,ad,af,ae);return y.paint(ai,{lineColor:ag,lineWidth:am})};ac.prototype.paintHilight=function(ag,ai,ah,ae,ak,al,af){var aj,ad;aj=Math.PI*2;ae=ae*(1+af.sizeProportional)+af.sizeConstant*al;ak=ak*(1+af.sizeProportional)+af.sizeConstant*al;ag.beginPath();ad=ai+ak-ae;ag.moveTo(ad,ah-ae);ag.arc(ad,ah,ae,-Math.PI/2,Math.PI/2,false);ad=ai-ak+ae;ag.lineTo(ad,ah+ae);ag.arc(ad,ah,ae,Math.PI*0.5,Math.PI*1.5,false);ag.closePath();ag.arc(ai,ah,ae,0,aj);return y.paint(ag,af)};ac.prototype.paintLinkIcons=function(ah,al,aj,ap,ao,ag,af,an){var am,ai,ae,ad,ak;am=Math.PI*2;ae=Math.max(af,Math.min(ag/2-(an.length*2+1)*af,af*3));al+=ap*ae;aj+=ao*ae;ap*=af*2;ao*=af*2;for(ad=0,ak=an.length;ad<ak;ad++){ai=an[ad];this.paintIcon(ah,al,aj,af,ai);ah.beginPath();ah.arc(al,aj,af,0,am);ah.stroke();al+=ap;aj+=ao}};ac.prototype.paintNodeIcons=function(aq,al,aj,ai,ah,ad,au){var ar,ap,an,ak,ao,ag,am,at,af,av,ae;ar=2*ad/ai;ao=ai*Math.cos(ah);am=ai*Math.sin(ah);an=Math.cos(-ar);ak=Math.sin(-ar);ap=0;ae=[];for(af=0,av=au.length;af<av;af++){at=au[af];this.paintIcon(aq,al+ao,aj+am,ad,at);ag=ao*an-am*ak;am=ao*ak+am*an;ao=ag;ap+=ar;if(ap>3){break}else{ae.push(void 0)}}return ae};ac.prototype.paintIcon=function(ag,ae,aj,ad,af){var ai,ah;ai=this.getImage(af.image);if(ai){ah=af.imageSlicing;if(ah){ag.drawImage(ai,ah[0],ah[1],ah[2],ah[3],ae-ad,aj-ad,ah[2],ah[3])}else{ag.drawImage(ai,ae-ad,aj-ad)}af.x=ae;af.y=aj}};ac.prototype.paintHiddenLinks=function(aC,ax,ar,aq,au,am,aB,av){var ae,aE,al,aA,ah,an,at,ak,aF,az,ad,ao,aj,ag,ay,aw,ai,af,aD,ap;ae=Math.PI*2;aF=(au+av)/au;at=av*0.73/au;ak=(au-av*0.1)/au;if(ax.links.length>0){aj=0;aw=0;ap=ax.links;for(ai=0,aD=ap.length;ai<aD;ai++){an=ap[ai];aj+=an.otherEnd(ax).x;aw+=an.otherEnd(ax).y}aj=ax.x-aj/ax.links.length;aw=ax.y-aw/ax.links.length;ah=au/Math.sqrt(aj*aj+aw*aw);az=aj*ah;ag=aw*ah}else{az=au;ag=0}aE=ae/am/3;ao=Math.cos(-aE*(am-1)/2);ay=Math.sin(-aE*(am-1)/2);ad=az*ao-ag*ay;ag=az*ay+ag*ao;az=ad;ao=Math.cos(aE);ay=Math.sin(aE);aC.beginPath();for(aA=af=1;af<=am;aA=af+=1){aC.moveTo(ar+az,aq+ag);aC.lineTo(ar+az*aF,aq+ag*aF);ad=az*ao-ag*ay;ag=az*ay+ag*ao;az=ad}al=aC.createRadialGradient(ar,aq,Math.max(0,au-av),ar,aq,au*aF);al.addColorStop(0,aB.lineColor);al.addColorStop(1,"transparent");aC.strokeStyle=al;aC.lineWidth=aB.lineWidth;return aC.stroke()};return ac})();var i;i=(function(){ac.prototype.animationPriority=10;ac.prototype.node=null;ac.prototype.link=null;ac.prototype.contents=null;ac.prototype.x=0;ac.prototype.y=0;function ac(ae){var ad;this.chart=ae;this.container=ae.layers.container;this.scene=ae.scene;this.events=ae.events;this.buttons=[];this.popup=T.createDom("div","DVSL-NC-bar-info",null,this.container);ad=T.createDom("a","DVSL-NC-close","X",this.popup);this.popupValue=T.createDom("div",null,null,this.popup);this.detailsDiv=T.createDom("div","DVSL-NC-bar-details",null,this.popup);this.popupActions=T.createDom("nav",null,null,this.popup);this.buildDetailsPanel(this.detailsDiv);this.buildCloseButton(ad);this.popup.style.position="absolute";this.popup.style.display="none"}ac.prototype.doAnimations=function(ad){if(this.node==null){return}if(((this.node!=null)&&this.node.removed)||((this.link!=null)&&this.link.removed)){return this.hideMenu()}else{if((this.node!=null)&&this.scene.modifiedNodes.hasOwnProperty(this.node.id)){return this.updateMenu()}}};ac.prototype.previewPointerDown=function(ad){return this.hideMenu()};ac.prototype.previewWheel=function(ad){return this.hideMenu()};ac.prototype.toggleNodeMenu=function(ad){if(this.node===ad){return this.hideMenu()}else{return this.showNodeMenu(ad)}};ac.prototype.toggleLinkMenu=function(ad,af,ae){if(this.link===ae){return this.hideMenu()}else{return this.showLinkMenu(ad,af,ae)}};ac.prototype.showNodeMenu=function(ad){if(!this.scene.settings.nodeMenu.enabled){return}if(this.node===ad){return this.updateMenu()}else{this.hideMenu();return this.showPopup(ad,null)}};ac.prototype.showLinkMenu=function(ad,af,ae){if(!this.scene.settings.linkMenu.enabled){return}this.x=ad;this.y=af;if(this.link===ae){return this.updateMenu()}else{this.hideMenu();return this.showPopup(null,ae)}};ac.prototype.showPopup=function(ae,ad){this.node=ae;this.link=ad;if(this.node){this.node.locks+=1}this.buildButtons();this.contents=null;this.updateMenu();this.popup.style.display="block";this.updateXY()};ac.prototype.hideMenu=function(){if(!this.node&&!this.link){return false}if(this.node){this.node.locks-=1}this.node=null;this.link=null;this.popup.style.display="none";return false};ac.prototype.updateMenu=function(){var aj,ag,af,ae,ah,ad,ai;if(this.node!=null){ad=this.scene.settings.nodeMenu;ah=this.node}else{ad=this.scene.settings.linkMenu;ah=this.link}if(ad.contentsFunction){ae=this.node;af=this.link;aj=function(ak){if(this.node===ae&&this.link===af){this.contents=ak;return this.popupValue.innerHTML=ak}};ai=ad.contentsFunction.call(this.chart.api,ah.data,ah,aj);if(T.isString(ai)){ag=ai}else{if(this.contents===null){ag="<small>"+this.scene.settings.localization.loadingLabel+"</small>"}else{ag=this.contents}}}else{ag=ah.label}if(ag!==this.contents){this.contents=ag;this.popupValue.innerHTML=ag}this.updateButtons();if(ad.showData){this.details.innerHTML=JSON.stringify(ah.data,null,"  ");return this.detailsDiv.style.display="block"}else{return this.detailsDiv.style.display="none"}};ac.prototype.updateXY=function(){var ak,ah,al,ae,ad,aj,an,am,ao,ag,af,ai;ah=12;if(this.node!=null){ai=this.scene.toDisplay(this.node.x,this.node.y),al=ai[0],aj=ai[1];an=aj-this.node.renderRadius-ah;am=aj+this.node.renderRadius+ah;ae=al-this.node.renderRadius-ah;ad=al+this.node.renderRadius+ah}else{an=am=aj=this.y;ae=this.x-ah;ad=this.x+ah}ag=this.scene.x0;af=this.scene.x0+this.scene.width;ao=this.popup.offsetWidth;ak=this.popup.offsetHeight;aj=Math.max(Math.min(aj,this.scene.y0+this.scene.height-ak),this.scene.y0);if(ad+ao<=af){al=ad}else{if(ae-ao>=ag){al=ae-ao}else{al=Math.max(ae-ao/2,ag);aj=am}}this.popup.style.left=al+"px";return this.popup.style.top=aj+"px"};ac.prototype.buildButtons=function(){var ai,af,aj,ah,ae,ag,ad;this.popupActions.innerHTML="";this.buttons=[];if(this.node!=null){ag=this.scene.settings.nodeMenu.buttons;ad=[];for(ah=0,ae=ag.length;ah<ae;ah++){af=ag[ah];if(af==="expand"){aj=T.createDom("a","DVSL-NC-button-expand",null,this.popupActions);ai=this.updateExpandButton}else{if(af==="focus"){aj=T.createDom("a","DVSL-NC-button-focus",null,this.popupActions);ai=this.updateFocusButton}else{if(af==="lock"){aj=T.createDom("a","DVSL-NC-button-lock",null,this.popupActions);ai=this.updateLockButton}else{if(af==="hide"){aj=T.createDom("a","DVSL-NC-button-hide",null,this.popupActions);ai=this.updateHideButton}}}}aj.href="#";ad.push(this.buttons.push({e:aj,a:ai}))}return ad}};ac.prototype.updateButtons=function(){var ad,ag,ae,af;af=this.buttons;for(ag=0,ae=af.length;ag<ae;ag++){ad=af[ag];ad.a.call(this,ad.e)}};ac.prototype.updateExpandButton=function(af){var ad,ae=this;if(!this.node.expanded||this.node.dataLinks.length>this.node.links.length){ad=this.scene.settings.localization.menu.expand;af.className="DVSL-NC-button-expand";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.expandNode(ae.node.id,1);return ag.preventDefault()}}else{ad=this.scene.settings.localization.menu.collapse;af.className="DVSL-NC-button-collapse";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.collapseNode(ae.node.id);return ag.preventDefault()}}};ac.prototype.updateFocusButton=function(af){var ad,ae=this;if(this.node.focused){ad=this.scene.settings.localization.menu.unfocus;af.className="DVSL-NC-button-unfocus";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.removeFocusNode(ae.node.id);return ag.preventDefault()}}else{ad=this.scene.settings.localization.menu.focus;af.className="DVSL-NC-button-focus";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.addFocusNode(ae.node.id);return ag.preventDefault()}}};ac.prototype.updateLockButton=function(af){var ad,ae=this;if(this.node.userLock){ad=this.scene.settings.localization.menu.fixed;af.className="DVSL-NC-button-lock";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.unlockNode(ae.node.id);return ag.preventDefault()}}else{ad=this.scene.settings.localization.menu.dynaminc;af.className="DVSL-NC-button-unlock";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.lockNode(ae.node.id);return ag.preventDefault()}}};ac.prototype.updateHideButton=function(af){var ad,ae=this;ad=this.scene.settings.localization.menu.hide;af.className="DVSL-NC-button-hide";af.title=ad;af.innerHTML=ad;return af.onclick=function(ag){ae.chart.hideNode(ae.node.id);return ag.preventDefault()}};ac.prototype.buildCloseButton=function(ad){var ae=this;ad.title=this.scene.settings.localization.closeButton;ad.href="#";return ad.onclick=function(af){ae.hideMenu();return af.preventDefault()}};ac.prototype.buildDetailsPanel=function(af){var ad,ae;ad=T.createDom("small",null,"Technical data",af);this.details=ae=T.createDom("pre",null,"",af);ae.style.display="none";return ad.onclick=function(){if(ae.style.display==="none"){return ae.style.display="block"}else{return ae.style.display="none"}}};return ac})();var c;c=(function(){function ac(ad){this.chart=ad;this.scene=ad.scene;this.options=this.scene.settings;this.item=null;this.x=null;this.y=null;this.popup=new A(ad)}ac.prototype.previewPointerMove=function(ad){return this.onMove(ad.x,ad.y)};ac.prototype.doAnimations=function(ad){if(this.x!==null&&this.y!==null){return this.onMove(this.x,this.y)}};ac.prototype.previewPointerDown=function(ad){this.x=this.y=null;return this.setCurrentObject(0,0,null)};ac.prototype.previewPointerDrag=function(ad){this.x=this.y=null;return this.setCurrentObject(0,0,null)};ac.prototype.onPointerOut=function(ad){this.x=this.y=null;return this.setCurrentObject(0,0,null)};ac.prototype.onMove=function(ad,af){var ae;this.x=ad;this.y=af;if(!this.options.info.enabled){return}ae=this.scene.hoverNode?this.scene.hoverNode:this.scene.hoverLink;return this.setCurrentObject(ad,af,ae)};ac.prototype.setCurrentObject=function(ad,ag,af){var ae;if(!af){this.item=null;return this.popup.hide()}else{if(af!==this.item){ae=this.buildContents(af);this.popup.show(ad,ad,ag,ae)}else{this.popup.updateXY(ad,ad,ag)}return this.item=af}};ac.prototype.buildContents=function(ae){var ag,ad,af=this;ad=null;if(ae instanceof Q){ad=this.options.info.nodeContentsFunction}else{if(ae instanceof v){ad=this.options.info.linkContentsFunction}}if(ad){ag=function(ah){if(ae===af.item){return af.popup.updateContents(ah)}};return ad.call(this.scene.api,ae.data,ae,ag)}else{return ae.label}};return ac})();var b,j=function(ac,ad){return function(){return ac.apply(ad,arguments)}},ab={}.hasOwnProperty,n=function(af,ad){for(var ac in ad){if(ab.call(ad,ac)){af[ac]=ad[ac]}}function ae(){this.constructor=af}ae.prototype=ad.prototype;af.prototype=new ae();af.__super__=ad.prototype;return af};b=(function(ac){n(ad,ac);"use strict";ad.prototype.api=null;ad.prototype.renderer=null;ad.prototype.scrolling=null;ad.prototype.selection=null;function ad(af,ae){this.defaultDoubleClick=j(this.defaultDoubleClick,this);this.defaultRightClick=j(this.defaultRightClick,this);this.defaultClick=j(this.defaultClick,this);this.onSizeChanged=j(this.onSizeChanged,this);this.settings=new H(af);ad.__super__.constructor.call(this,this.settings);this.scene=new R();this.scene.settings=this.settings;this.graph=new e(this);this.navigator=new B(this);this.scrolling=new M(this);this.layout=new D(this);this.layers=new L(this,this.scene);this.scrolling.resetZoom=true;this.initialize(ae);this.renderer=new u(this);this.info=new c(this);this.menu=new i(this);this.events.addElement(this.graph);this.events.addElement(this.navigator);this.events.addElement(this.layout);this.events.addElement(this.scrolling);this.events.addElement(new g(this));this.events.addElement(new C(this));this.events.addElement(this.renderer);this.events.addElement(new Y(this));this.events.addElement(new W(this));this.events.addElement(new P(this));this.events.addElement(this.menu);this.events.addElement(this.info);this.scene.data=new l(this);this.scene.loading=false;this.navigator.showInitialNodes();this.updateSize();this.events.notifySceneChanges({settings:true,data:true,bounds:true});this.updateEvents({},this.settings.events)}ad.prototype.onAssetsLoaded=function(){return this.updateSize()};ad.prototype.onRemove=function(){this.layers=null;this.renderer=null;this.scene.data.remove();this.scene.data=null;return this.scene=null};ad.prototype.onSettingsChanged=function(ag){var af,ae;this.layers.updateSettings(ag);af={};ae=ag.navigation&&(ag.navigation.mode||ag.navigation.initialNodes);if((ag.data!=null)&&(ag.data.dataFunction||ag.data.format||(ag.data.units!=null)||ag.data.preloaded||ag.data.url)){if(this.scene.data){this.scene.data.remove()}this.scene.data=new l(this);af.data=true;ae=true}if(ae){this.navigator.showInitialNodes();this.scrolling.resetZoom=true}if(ag.filters){this.navigator.updateGraph();this.graph.updateFilter()}return this.events.notifySceneChanges(af)};ad.prototype.save=function(){var af,ae;ae=this.graph.save();af=this.navigator.save();return JSON.stringify({xy:ae,nav:af})};ad.prototype.restore=function(af,ae){var ai,ag,ah;if(!af){return}ag=JSON.parse(af);ah=ag.xy;ai=ag.nav;if(!ah||!ai){this.error("Cannt restore state: missing data in state");return}this.navigator.restore(ai);this.graph.restore(ah);return this.scrolling.resetZoom=true};ad.prototype.onSizeChanged=function(af,ae){this.scene.y0=0;this.scene.x0=0;this.scene.height=ae;this.scene.width=af;this.layers.updateSize();if(this.events!=null){return this.events.notifySceneChanges({bounds:true})}};ad.prototype.reloadData=function(){this.scene.data=new l(this);return this.events.notifySceneChanges({data:true})};ad.prototype.lockNode=function(ag,ae,af){if(T.isObject(ag)){ag=ag.id}return this.graph.lockNode(ag,ae,af)};ad.prototype.unlockNode=function(ae){if(T.isObject(ae)){ae=ae.id}return this.graph.unlockNode(ae)};ad.prototype.addFocusNode=function(af,ae){if(T.isObject(af)){af=af.id}if(this.settings.navigation.autoZoomOnFocus){this.scene.settings.interaction.zooming.autoZoom=true}return this.navigator.addFocusNode(af,ae)};ad.prototype.clearFocus=function(){return this.navigator.clear()};ad.prototype.removeFocusNode=function(ae){if(T.isObject(ae)){ae=ae.id}return this.navigator.unexpandNode(ae)};ad.prototype.expandNode=function(af,ae){if(ae==null){ae=1}if(T.isObject(af)){af=af.id}return this.navigator.expandNode(af,ae+1)};ad.prototype.collapseNode=function(ae){if(T.isObject(ae)){ae=ae.id}return this.navigator.collapseNode(ae)};ad.prototype.uncollapseNode=function(ae){if(T.isObject(ae)){ae=ae.id}return this.navigator.uncollapseNode(ae)};ad.prototype.hideNode=function(ae){if(T.isObject(ae)){ae=ae.id}return this.navigator.hideNode(ae)};ad.prototype.setSelection=function(ah,aj){var ae,ak,ag,ai,af;ag=[];for(ai=0,af=ah.length;ai<af;ai++){ak=ah[ai];if(ak instanceof Q||ak instanceof v){ag.push(ak)}else{this.error("SetSelection: Non chart object in selection: "+ak)}}ae=aj|this.scene.selection.length!==ag.length;if(ag.length===1&&!ae){ae=this.scene.selection[0]!==ag[0]}if(ae){this.scene.selection=ag;this.events.notifySceneChanges({selection:true});return this.notifySelectionChanged("api")}};ad.prototype.zoomIn=function(af,ae){return this.error("ZoomIn: not implmeneted")};ad.prototype.closePopup=function(){return this.menu.hideMenu()};ad.prototype.extendEventParams=function(ae){ae.nodes=this.scene.nodes;ae.links=this.scene.links;ae.hoverLink=this.scene.hoverLink;ae.hoverNode=this.scene.hoverNode;ae.selection=this.scene.selection;return ae};ad.prototype.defaultClick=function(af){var ae;if(af.clickNode!=null){ae=af.clickNode;if(!ae.expanded){if(this.scene.settings.navigation.expandOnClick){this.expandNode(ae.id);return af.preventDefault()}}}};ad.prototype.defaultRightClick=function(ae){if(ae.clickNode!=null){this.scene.data.getNodeLinks(ae.clickNode.id);this.menu.toggleNodeMenu(ae.clickNode);ae.preventDefault()}if(ae.clickLink!=null){this.menu.toggleLinkMenu(ae.x,ae.y,ae.clickLink);return ae.preventDefault()}};ad.prototype.defaultDoubleClick=function(af){var ae;ae=af.clickNode;if(ae){this.addFocusNode(ae.id);return af.preventDefault()}};return ad})(O);var V,ab={}.hasOwnProperty,n=function(af,ad){for(var ac in ad){if(ab.call(ad,ac)){af[ac]=ad[ac]}}function ae(){this.constructor=af}ae.prototype=ad.prototype;af.prototype=new ae();af.__super__=ad.prototype;return af};V=(function(ac){n(ad,ac);"use strict";ad._impl=null;ad._scene=null;ad.settings=null;function ad(ae){this.themes=ad.themes;this._impl=new b(ae,this);this.settings=this._impl.settings;this._scene=this._impl.scene;return this}ad.prototype.updateFilters=function(){this._impl.updateSettings({filters:{}},"api");return this};ad.prototype.showNode=function(ae){return this._impl.expandNode(ae,1)};ad.prototype.hideNode=function(ae){return this._impl.hideNode(ae)};ad.prototype.expandNode=function(ae){return this._impl.expandNode(ae)};ad.prototype.addFocusNode=function(af,ae){return this._impl.addFocusNode(af,ae)};ad.prototype.removeFocusNode=function(ae){return this._impl.removeFocusNode(ae)};ad.prototype.clearFocus=function(){return this._impl.clearFocus()};ad.prototype.collapseNode=function(ae){return this._impl.collapseNode(ae)};ad.prototype.lockNode=function(ag,ae,af){return this._impl.lockNode(ag,ae,af)};ad.prototype.unlockNode=function(ae){return this._impl.unlockNode(ae)};ad.prototype.selection=function(ae){if(ae!=null){this._impl.setSelection(ae)}return this._scene.selection};ad.prototype.back=function(){return this._impl.back()};ad.prototype.zoomIn=function(af,ae){if(ae==null){ae=true}return this._impl.zoomIn(af,ae)};ad.prototype.closePopup=function(){return this._impl.closePopup()};return ad})(X);this.NetChart=V}).call(this);